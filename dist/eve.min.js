!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):"object"==typeof exports?exports.eve=t():e.eve=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){t.Agent=n(1),t.ServiceManager=n(2),t.TransportManager=n(3),t.module={BabbleModule:n(5),PatternModule:n(6),RequestModule:n(7),RPCModule:n(8)},t.transport={Transport:n(9),AMQPTransport:n(11),DistribusTransport:n(13),HTTPTransport:n(15),LocalTransport:n(17),PubNubTransport:n(19),WebSocketTransport:n(21),connection:{Connection:n(10),AMQPConnection:n(12),DistribusConnection:n(14),HTTPConnection:n(16),LocalConnection:n(18),PubNubConnection:n(20),WebSocketConnection:n(22)}},t.hypertimer=n(23),t.util=n(4),t.Agent.registerModule(t.module.BabbleModule),t.Agent.registerModule(t.module.PatternModule),t.Agent.registerModule(t.module.RequestModule),t.Agent.registerModule(t.module.RPCModule),t.TransportManager.registerType(t.transport.AMQPTransport),t.TransportManager.registerType(t.transport.DistribusTransport),t.TransportManager.registerType(t.transport.HTTPTransport),t.TransportManager.registerType(t.transport.LocalTransport),t.TransportManager.registerType(t.transport.PubNubTransport),t.TransportManager.registerType(t.transport.WebSocketTransport),t.system=new t.ServiceManager,t.system.transports.add(new t.transport.LocalTransport),t.Agent.getTransportById=function(e){return t.system.transports.get(e)}},function(e,t,n){"use strict";function r(e){this.id=e?e.toString():s(),this.connections=[],this.defaultConnection=null,this.ready=o.resolve([])}function i(e){var t=r.modules[e];if(!t)throw new Error('Unknown module "'+e+'". Choose from: '+Object.keys(r.modules).map(JSON.stringify).join(", "));return t}var o=n(24),s=n(26),a=n(4);r.modules={},r.registerModule=function(e){var t=e.prototype.type;if("function"!=typeof e)throw new Error("Constructor function expected");if(!t)throw new Error('Field "prototype.type" missing in transport constructor');if(t in r.modules&&r.modules[t]!==e)throw new Error('Module of type "'+t+'" already exists');r.modules[t]=e},r.getTransportById=function(e){throw new Error('Transport with id "'+e+'" not found')},r.prototype.extend=function(e,t){if(Array.isArray(e)){var n=[].concat(e);n.sort(function(e,t){return"pattern"==e?-1:"pattern"==t?1:0});for(var r=0;r<n.length;r++)this.extend(n[r],t)}else{var o=i(e),s=new o(this,t),a=s.mixin(),c=this;Object.keys(a).forEach(function(e){if(void 0!==c[e]&&"_receive"!==e)throw new Error('Conflict: agent already has a property "'+prop+'"')}),Object.keys(a).forEach(function(e){c[e]=a[e]})}return this},r.prototype.loadModule=function(e,t){var n=void 0!==t?Object.create(t):{};n.extend=!1;var r=i(e),o=new r(this,t),s=o.mixin();return this._receive=s._receive,o},r.prototype.send=function(e,t){var n=e.indexOf("://");if(-1!==n){var r=a.parseUrl(e);return"http"==r.protocol||"ws"==r.protocol||"https"==r.protocol?this._sendByProtocol(r.protocol,e,t):this._sendByNetworkId(r.domain,r.path,t)}var i=e.indexOf("@");if(-1!=i){var s=e.substring(0,i),c=e.substring(i+1);return this._sendByTransportId(c,s,t)}var u=this.defaultConnection;return u?u.send(e,t):o.reject(new Error("No transport found"))},r.prototype._sendByNetworkId=function(e,t,n){for(var r=0;r<this.connections.length;r++){var i=this.connections[r];if(i.transport.networkId==e)return i.send(t,n)}return o.reject(new Error('No transport found with networkId "'+e+'"'))},r.prototype._sendByProtocol=function(e,t,n){for(var r=0;r<this.connections.length;r++){var i=this.connections[r];if(i.transport.type==e)return i.send(t,n)}return o.reject(new Error('No transport found for protocol "'+e+'"'))},r.prototype._sendByTransportId=function(e,t,n){for(var r=0;r<this.connections.length;r++){var i=this.connections[r];if(i.transport.id==e)return i.send(t,n)}return o.reject(new Error('No transport found with id "'+e+'"'))},r.prototype.receive=function(){},r.prototype._receive=function(e,t){return this.receive(e,t)},r.prototype.connect=function(e,t){if(Array.isArray(e)){var n=this;return e.map(function(e){return n._connect(e,t)})}return"string"==typeof e?this._connect(r.getTransportById(e),t):this._connect(e,t)},r.prototype._connect=function(e,t){var n=this,r=function(e,t){return n._receive(e,t)},i=e.connect(t||this.id,r);if(this.connections.push(i),this.defaultConnection){if(e["default"]){if(this.defaultConnection["default"])throw new Error("Cannot connect to a second default transport");this.defaultConnection=i}}else this.defaultConnection=i;return this._updateReady(),i},r.prototype.disconnect=function(e){var t,n;if(e){if(Array.isArray(e))for(t=0;t<this.connections.length;)n=this.connections[t],-1!==e.indexOf(n.transport)?this._disconnect(n):t++;else if("string"==typeof e)this.disconnect(r.getTransportById(e));else for(t=0;t<this.connections.length;t++)if(n=this.connections[t],n.transport===e){this._disconnect(n);break}}else for(;n=this.connections[0];)this._disconnect(n)},r.prototype._disconnect=function(e){var t=this.connections.indexOf(e);-1!==t&&(e.close(),this.connections.splice(t,1),this.defaultConnection===e&&(this.defaultConnection=this.connections[this.connections.length-1]||null)),this._updateReady()},r.prototype._updateReady=function(){this.ready=o.all(this.connections.map(function(e){return e.ready}))},e.exports=r},function(e,t,n){"use strict";function r(e){this.transports=new s,this.timer=o(),this.random=Math.random,this.init(e)}var i=n(25),o=n(23),s=n(3),a={transports:!0,timer:!0,random:!0};r.prototype.init=function(e){if(this.transports.clear(),e){if(e.transports&&this.transports.load(e.transports),e.timer&&this.timer.config(e.timer),e.random)if(e.random.deterministic){var t=e.random.seed||"random seed";this.random=i(t,e.random)}else this.random=Math.random;for(var n in e)e.hasOwnProperty(n)&&!a[n]&&console.log('WARNING: Unknown configuration option "'+n+'"')}},r.prototype.clear=function(){this.transports.clear()},e.exports=r},function(e){"use strict";function t(e){this.transports=[],e&&this.load(e)}t.types={},t.registerType=function(e){var n=e.prototype.type;if("function"!=typeof e)throw new Error("Constructor function expected");if(!n)throw new Error('Field "prototype.type" missing in transport constructor');if(n in t.types&&t.types[n]!==e)throw new Error('Transport type "'+n+'" already exists');t.types[n]=e},t.prototype.add=function(e){return this.transports.push(e),e},t.prototype.load=function(e){if(Array.isArray(e))return e.map(this.load.bind(this));var n=e.type;if(!n)throw new Error('Property "type" missing');var r=t.types[n];if(!r)throw new Error('Unknown type of transport "'+n+'". Choose from: '+Object.keys(t.types).join(","));var i=new r(e);return this.transports.push(i),i},t.prototype.unload=function(e){var t;if("string"==typeof e)t=this.get(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)this.unload(e[n]);else t=e;if(t){t.close();var r=this.transports.indexOf(t);-1!==r&&this.transports.splice(r,1)}},t.prototype.get=function(e){for(var t=0;t<this.transports.length;t++){var n=this.transports[t];if(n.id===e)return n}throw new Error('Transport with id "'+e+'" not found')},t.prototype.getAll=function(){return this.transports.concat([])},t.prototype.getByType=function(e){if(e){if(!(e in t.types))throw new Error('Unknown type of transport "'+e+'". Choose from: '+Object.keys(t.types).join(","));return this.transports.filter(function(t){return t.type===e})}return[].concat(this.transports)},t.prototype.clear=function(){this.transports.forEach(function(e){e.close()}),this.transports=[]},e.exports=t},function(e,t){"use strict";t.isPromise=function(e){return e&&"function"==typeof e.then&&"function"==typeof e["catch"]},t.parseUrl=function(e){var t=/^([A-z]+):\/\/([^\/]+)(\/(.*)$|$)/.exec(e);return t?{protocol:t[1],domain:t[2],path:t[4]}:null},t.normalizeURL=function(e){return"/"==e[e.length-1]?e.substring(0,e.length-1):e}},function(e,t,n){"use strict";function r(e){var t=i.babbler(e.id);t.connect({connect:function(){},disconnect:function(){},send:function(t,n){e.send(t,n)}}),this.babbler=t;var n=e._receive;this._receive=function(r,i){return t._receive(i),n.call(e,r,i)}}var i=n(27);r.prototype.type="babble",r.prototype.mixin=function(){var e=this.babbler;return{_receive:this._receive,ask:e.ask.bind(e),tell:e.tell.bind(e),listen:e.listen.bind(e),listenOnce:e.listenOnce.bind(e)}},e.exports=r},function(e){"use strict";function t(e,t){this.agent=e,this.stopPropagation=t&&t.stopPropagation||!1,this.receiveOriginal=e._receive,this.listeners=[]}t.prototype.type="pattern",t.prototype.receive=function(e,t){for(var n,r=[],i=0,o=this.listeners.length;o>i;i++){var s=this.listeners[i],a=s.pattern,c=a instanceof Function&&a(t)||a instanceof RegExp&&a.test(t)||a==t;if(c&&(n=s.callback.call(this.agent,e,t),r.push(n),this.stopPropagation))return r[0]}return n=this.receiveOriginal.call(this.agent,e,t),r.push(n),r[0]},t.prototype.listen=function(e,t){this.listeners.push({pattern:e,callback:t})},t.prototype.unlisten=function(e,t){for(var n=0,r=this.listeners.length;r>n;n++){var i=this.listeners[n];if(i.pattern===e&&i.callback===t){this.listeners.splice(n,1);break}}},t.prototype.mixin=function(){return{_receive:this.receive.bind(this),listen:this.listen.bind(this),unlisten:this.unlisten.bind(this)}},e.exports=t},function(e,t,n){"use strict";function r(e,t){this.agent=e,this.receiveOriginal=e._receive,this.timeout=t&&t.timeout||a,this.queue=[]}var i=n(26),o=n(24),s=n(4),a=6e4;r.prototype.type="request",r.prototype.receive=function(e,t){var n=this.agent;if("object"==typeof t){var r=t,i=this.queue[r.id];if(i)return clearTimeout(i.timeout),delete this.queue[r.id],r.error?i.reject(new Error(r.error)):i.resolve(r.message),!0;if("request"==t.type)try{var o=this.receiveOriginal.call(n,e,t.message);s.isPromise(o)?o.then(function(r){n.send(e,{type:"request",id:t.id,message:r})}).catch(function(r){n.send(e,{type:"request",id:t.id,error:r.message||r.toString()})}):n.send(e,{type:"request",id:t.id,message:o})}catch(a){n.send(e,{type:"request",id:t.id,error:a.message||a.toString()})}}else this.receiveOriginal&&this.receiveOriginal.call(n,e,t)},r.prototype.request=function(e,t){var n=this;return new o(function(r,o){var s=i(),a={type:"request",id:s,message:t};n.queue[s]={resolve:r,reject:o,timeout:setTimeout(function(){delete n.queue[s],o(new Error("Timeout"))},n.timeout)},n.agent.send(e,a).catch(function(e){o(e)})})},r.prototype.mixin=function(){return{_receive:this.receive.bind(this),request:this.request.bind(this)}},e.exports=r},function(e,t,n){"use strict";function r(e,t){this.agent=e,this.receiveOriginal=e._receive,this.queue={},this.promiseTimeout=1500,t instanceof Array?this.functionsFromArray(t):t instanceof Object?this.availableFunctions=t:console.log("cannot use RPC with the supplied functions",t)}var i=n(26),o=n(24),s=n(4);r.prototype.type="rpc",r.prototype.functionsFromArray=function(e){this.availableFunctions={};for(var t=0;t<e.length;t++){var n=e[t];this.availableFunctions[n]=this.agent[n]}},r.prototype.request=function(e,t){var n=this;return new o(function(r,o){"object"!=typeof t&&o(new TypeError("Message must be an object")),"2.0"!==t.jsonrpc&&(t.jsonrpc="2.0"),void 0===t.id&&(t.id=i()),void 0===t.method&&o(new Error('Property "method" expected')),void 0===t.params&&(t.params={}),n.queue[t.id]={resolve:r,reject:o,timeout:setTimeout(function(){delete n.queue[t.id],o(new Error("Timeout"))},n.promiseTimeout)};var a=n.agent.send(e,t);1==s.isPromise(a)&&a.catch(function(e){o(e)})})},r.prototype.receive=function(e,t){"object"==typeof t&&"2.0"==t.jsonrpc?this._receive(e,t):this.receiveOriginal.call(this.agent,e,t)},r.prototype._receive=function(e,t){var n={jsonrpc:"2.0",id:t.id};if(void 0!==t.method){var r=this.availableFunctions[t.method];if(void 0!==r){var i=r.call(this.agent,t.params,e)||null;if(s.isPromise(i)){var o=this;i.then(function(t){n.result=t,o.agent.send(e,n)}).catch(function(t){n.error=t.message||t.toString(),o.agent.send(e,n)})}else n.result=i,this.agent.send(e,n)}else{var a=new Error("Cannot find function: "+t.method);n.error=a.message||a.toString(),this.agent.send(e,n)}}else if(void 0!==t.result||void 0!==t.error){var c=this.queue[t.id];void 0!==c&&(void 0!=t.error?c.reject(new Error(t.error)):c.resolve(t.result))}else{var a=new Error("No method or result defined. Message:"+JSON.stringify(t));n.error=a.message||a.toString(),this.agent.send(e,n)}},r.prototype.mixin=function(){return{_receive:this.receive.bind(this),request:this.request.bind(this)}},e.exports=r},function(e){"use strict";function t(e){this.id=e&&e.id||null,this["default"]=e&&e["default"]||!1}t.prototype.type=null,t.prototype.connect=function(){throw new Error('Cannot invoke abstract function "connect"')},t.prototype.close=function(){throw new Error('Cannot invoke abstract function "close"')},e.exports=t},function(e,t,n){"use strict";function r(){throw new Error("Cannot create an abstract Connection")}var i=n(24);r.prototype.ready=i.reject(new Error("Cannot get abstract property ready")),r.prototype.send=function(){throw new Error("Cannot call abstract function send")},r.prototype.close=function(){throw new Error('Cannot call abstract function "close"')},e.exports=r},function(e,t,n){"use strict";function r(e){this.id=e.id||null,this.networkId=e.url||e.host||null,this["default"]=e["default"]||!1,this.config=e,this.connection=null,this.exchange=null,this.subscriptions=[]}var i=n(24),o=n(9),s=n(12);r.prototype=new o,r.prototype.type="amqp",r.prototype.connect=function(e,t){return new s(this,e,t)},r.prototype._getConnection=function(e){var t=this;if(this.connection)e(this.connection);else if(this._onConnected)this._onConnected.push(e);else{this._onConnected=[e];var r=n(31),i=r.createConnection(this.config);i.on("ready",function(){var e=i.exchange("",{confirm:!0},function(){var n=t._onConnected;delete t._onConnected,t.connection=i,t.exchange=e,n.forEach(function(e){e(t.connection)})})})}},r.prototype._connect=function(e,t){var n=this;return new i(function(r){function i(i){var o=i.queue(e,{},function(){o.subscribe(function(e){var n=e.body;t(n.from,n.message)}).addCallback(function(t){n.subscriptions.push({id:e,consumerTag:t.consumerTag}),r(n)})})}n._getConnection(i)})},r.prototype._close=function(e){for(var t=0;t<this.subscriptions.length;){var n=this.subscriptions[t];n.id==e?this.subscriptions.splice(t,1):t++}0==this.subscriptions.length&&(this.exchange.destroy(),this.connection.disconnect(),this.connection=null,this.exchange=null)},r.prototype.close=function(){this.connection.destroy(),this.connection=null},e.exports=r},function(e,t,n){"use strict";function r(e,t,n){this.transport=e,this.id=t,this.ready=this.transport._connect(t,n)}{var i=n(24);n(10)}r.prototype.send=function(e,t){var n=this;return new i(function(r){var i={body:{from:n.id,to:e,message:t}},o={};n.transport.exchange.publish(e,i,o,function(){}),r()})},r.prototype.close=function(){this.transport._close(this.id)},e.exports=r},function(e,t,n){"use strict";function r(e){this.id=e&&e.id||null,this["default"]=e&&e["default"]||!1,this.host=e&&e.host||new i.Host(e),this.networkId=this.host.networkId}var i=n(28),o=n(9),s=n(14);r.prototype=new o,r.prototype.type="distribus",r.prototype.connect=function(e,t){return new s(this,e,t)},r.prototype.close=function(){this.host.close(),this.host=null},e.exports=r},function(e,t,n){"use strict";function r(e,t,n){this.transport=e,this.id=t;var r=this.transport.host.create(t);r.on("message",n),this.ready=i.resolve(this)}{var i=n(24);n(10)}r.prototype.send=function(e,t){return this.transport.host.send(this.id,e,t)},r.prototype.close=function(){this.transport.host.remove(this.id)},e.exports=r},function(e,t,n){"use strict";function r(e){this.id=e&&e.id||null,this.networkId=null,this.agents={},this.outstandingRequests={},this.outstandingMessages={},this.url=e&&e.url||"http://127.0.0.1:3000/agents/:id",this.remoteUrl=e&&e.remoteUrl,this.localShortcut=e&&e.localShortcut===!1?!1:!0,this.httpTimeout=e&&e.httpTimeout||2e3,this.httpResponseTimeout=e&&e.httpResponseTimeout||200,this.regexHosts=/[http]{4}s?:\/\/([a-z\-\.A-Z0-9]*):?([0-9]*)(\/[a-z\/:A-Z0-9._\-% \\\(\)\*\+\.\^\$]*)/,this.urlHostData=this.regexHosts.exec(this.url),this.regexPath=this.getRegEx(this.urlHostData[3]),this.port=e&&e.port||this.urlHostData[2]||3e3,this.path=this.urlHostData[3].replace(":id","")}var i=n(29),o=n(24),s=n(9),a=n(16),c=n(26);r.prototype=new s,r.prototype.type="http",r.prototype.getRegEx=function(e){return new RegExp(e.replace(/[\\\(\)\*\+\.\^\$]/g,function(e){return"\\"+e}).replace(":id","([:a-zA-Z_0-9]*)"))},r.prototype.connect=function(e,t){return void 0===this.server&&this.initiateServer(),this.outstandingRequests[e]={},this.outstandingMessages[e]={},new a(this,e,t)},r.prototype.send=function(e,t,n){var r=this;return new o(function(o,s){var a=r.regexHosts.exec(t),u=r.regexPath.exec(e),l=u[1],h=c();if(1==r.localShortcut){var f=r.regexPath.exec(t),p=f[1],d=a[3].replace(p,"");if(("127.0.0.1"==a[1]&&a[2]==r.urlHostData[2]&&d==r.path||r.urlHostData[1]==a[1]&&a[2]==r.urlHostData[2]&&d==r.path)&&void 0!==r.agents[p])return r.agents[p](l,n),void o()}if("object"==typeof n){var v=r.outstandingRequests[l];if(void 0!==v[n.id]){var m=v[n.id];return m.response.end(JSON.stringify(n)),clearTimeout(m.timeout),delete v[n.id],void o()}n=JSON.stringify(n)}var g={host:a[1],port:a[2],path:a[3],method:"POST",headers:{"x-eve-senderurl":e,"Content-type":"text/plain"}},y=i.request(g,function(e){e.setEncoding("utf8"),clearTimeout(r.outstandingMessages[l][h].timeout),e.on("data",function(e){var n;try{n=JSON.parse(e)}catch(i){n=e}return"object"==typeof n&&void 0!==n.__httpError__?void s(new Error(n.__httpError__)):(r.agents[l](t,n),void o())})});r.outstandingMessages[l][h]={timeout:setTimeout(function(){y.abort(),s(new Error("Cannot connect to "+t))},r.httpTimeout),reject:s},y.on("error",function(e){s(e)}),y.write(n),y.end()})},r.prototype.processRequest=function(e,t){var n=e.url,r={};r["Access-Control-Allow-Origin"]="*",r["Access-Control-Allow-Credentials"]=!0,r["Content-Type"]="text/plain";var i=this.regexPath.exec(n);if(null!==i){var o=i[1],s="unknown";void 0!==e.headers["x-eve-senderurl"]&&(s=e.headers["x-eve-senderurl"]);var a="";e.on("data",function(t){a+=t,a.length>1e6&&e.connection.destroy()});var c=this;e.on("end",function(){var e,n=!1;try{e=JSON.parse(a)}catch(i){e=a}n=e.jsonrpc&&"2.0"==e.jsonrpc||n,n=e.type&&"request"==e.type||n,t.writeHead(200,r);var u=c.agents[o];if(void 0===u){var l=new Error('Agent: "'+o+'" does not exist.');t.end(JSON.stringify({__httpError__:l.message||l.toString()}))}else 1==n?(c.outstandingRequests[o][e.id]={response:t,timeout:setTimeout(function(){t.end("timeout"),delete c.outstandingRequests[o][e.id]},c.httpResponseTimeout)},u(s,e)):(t.end(""),void 0!==u&&u(s,e))})}},r.prototype.initiateServer=function(){if(void 0===this.server){var e=this;this.server=i.createServer(function(t,n){if("OPTIONS"==t.method){var r={};r["Access-Control-Allow-Origin"]="*",r["Access-Control-Allow-Methods"]="POST, OPTIONS",r["Access-Control-Allow-Credentials"]=!0,r["Access-Control-Max-Age"]="86400",r["Access-Control-Allow-Headers"]="X-Requested-With, Access-Control-Allow-Origin, X-HTTP-Method-Override, Content-Type, Authorization, Accept",n.writeHead(200,r),n.end()}else"POST"==t.method&&e.processRequest(t,n)}),this.server.on("error",function(t){throw new Error("EADDRINUSE"==t.code?"ERROR: Could not start HTTP server. Port "+e.port+" is occupied.":t)}),this.server.listen(this.port,function(){console.log("Server listening at ",e.url)})}else this.server.close(),this.server=void 0,this.initiateServer()},r.prototype.close=function(){for(var e in this.outstandingRequests)if(this.outstandingRequests.hasOwnProperty(e)){var t=this.outstandingRequests[e];for(var n in t)if(t.hasOwnProperty(n)){var r=t[n],i=new Error("Server shutting down.");r.response.end(JSON.stringify({__httpError__:i.message||i.toString()}))}}this.server&&this.server.close(),this.server=null},e.exports=r},function(e,t,n){"use strict";function r(e,t,n){if(this.transport=e,this.id=t,this.id in this.transport.agents)throw new Error("Agent with id "+t+" already exists");this.transport.agents[this.id]=n,this.ready=i.resolve(this)}{var i=n(24);n(10)}r.prototype.send=function(e,t){var n,r=this.transport.url.replace(":id",this.id),i=-1!==e.indexOf("://");return i?n=e:void 0!==this.transport.remoteUrl?n=this.transport.remoteUrl.replace(":id",e):console.log("ERROR: no remote URL specified. Cannot send over HTTP.",e),this.transport.send(r,n,t)},r.prototype.close=function(){delete this.transport.agents[this.id]},e.exports=r},function(e,t,n){"use strict";function r(e){this.id=e&&e.id||null,this.networkId=this.id||null,this["default"]=e&&e["default"]||!1,this.agents={}}var i=n(9),o=n(18);r.prototype=new i,r.prototype.type="local",r.prototype.connect=function(e,t){return new o(this,e,t)},r.prototype.close=function(){this.agents={}},e.exports=r},function(e,t,n){"use strict";function r(e,t,n){if(this.transport=e,this.id=t,this.id in this.transport.agents)throw new Error("Agent with id "+t+" already exists");this.transport.agents[this.id]=n,this.ready=i.resolve(this)}{var i=n(24);n(10)}r.prototype.send=function(e,t){var n=this.transport.agents[e];if(!n)throw new Error("Agent with id "+e+" not found");return n(this.id,t),i.resolve()},r.prototype.close=function(){delete this.transport.agents[this.id]},e.exports=r},function(e,t,n){"use strict";function r(e){this.id=e.id||null,this.networkId=e.publish_key||null,this["default"]=e["default"]||!1,this.pubnub=i().init(e)}function i(){if("undefined"!=typeof window){if("undefined"==typeof window.PUBNUB)throw new Error("Please load pubnub first in the browser");return window.PUBNUB}return n(32)}var o=n(9),s=n(20);r.prototype=new o,r.prototype.type="pubnub",r.prototype.connect=function(e,t){return new s(this,e,t)},r.prototype.close=function(){this.pubnub=null},e.exports=r},function(e,t,n){"use strict";function r(e,t,n){this.id=t,this.transport=e;var r=this;this.ready=new i(function(i){e.pubnub.subscribe({channel:t,message:function(e){n(e.from,e.message)},connect:function(){i(r)}})})}{var i=n(24);n(10)}r.prototype.send=function(e,t){var n=this;return new i(function(r,i){n.transport.pubnub.publish({channel:e,message:{from:n.id,to:e,message:t},callback:r,error:i})})},r.prototype.close=function(){this.transport.pubnub.unsubscribe({channel:this.id})},e.exports=r},function(e,t,n){"use strict";function r(e){if(this.id=e&&e.id||null,this.networkId=this.id||null,this["default"]=e&&e["default"]||!1,this.localShortcut=e&&e.localShortcut===!1?!1:!0,this.reconnectDelay=e&&e.reconnectDelay||1e4,this.url=e&&e.url||null,this.server=null,null!=this.url){var t=i.parse(this.url);if("ws:"!=t.protocol)throw new Error('Invalid protocol, "ws:" expected');if(-1==this.url.indexOf(":id"))throw new Error('":id" placeholder missing in url');this.address=t.protocol+"//"+t.host,this.ready=this._initServer(this.url)}else this.address=null,this.ready=s.resolve(this);this.agents={}}var i=n(30),o=n(26),s=n(24),a=n(34).Server,c=n(4),u=n(9),l=n(22);r.prototype=new u,r.prototype.type="ws",r.prototype.getUrl=function(e){return this.url?this.url.replace(":id",e):null},r.prototype._initServer=function(e){var t=i.parse(e),n=t.port||80,r=this;return new s(function(e,t){r.server=new a({port:n},function(){e(r)}),r.server.on("connection",r._onConnection.bind(r)),r.server.on("error",function(e){t(e)})})},r.prototype._onConnection=function(e){var t=e.upgradeReq.url,n=i.parse(t,!0),r=n.pathname,s=c.normalizeURL(this.address+r),a=n.query,u=a.id||o(),l=this.agents[s];l?l._onConnection(u,e):e.close()},r.prototype.connect=function(e,t){var n=-1!==e.indexOf("://"),r=n?e:this.getUrl(e)||e;if(r&&(r=c.normalizeURL(r)),this.agents[r])throw new Error("Agent with id "+this.id+" already exists");var i=new l(this,r,t);return this.agents[i.url]=i,i},r.prototype.close=function(){for(var e in this.agents)this.agents.hasOwnProperty(e)&&this.agents[e].close();this.agents={},this.server&&this.server.close()},e.exports=r},function(e,t,n){"use strict";function r(e,t,n){this.transport=e,this.url=t?a.normalizeURL(t):i(),this.receive=n,this.sockets={},this.closed=!1,this.reconnectTimers={},this.ready=o.resolve(this)}{var i=n(26),o=n(24),s="undefined"!=typeof window&&"undefined"!=typeof window.WebSocket?window.WebSocket:n(34),a=n(4);n(10)}r.prototype.send=function(e,t){if(this.transport.localShortcut){var n=this.transport.agents[e];if(n)try{return n.receive(this.url,t),o.resolve()}catch(r){return o.reject(r)}}var i=this.sockets[e];if(i)try{if(i.readyState==i.CONNECTING)return new o(function(e){i.onopen.callback.push(function(){i.send(JSON.stringify(t)),e()})});if(i.readyState==i.OPEN)return i.send(JSON.stringify(t)),o.resolve();i=null}catch(r){return o.reject(r)}if(!i){var s=this;return new o(function(n,r){s._connect(e,function(e){e.send(JSON.stringify(t)),n()},function(){r(new Error('Failed to connect to agent "'+e+'"'))})})}},r.prototype.connect=function(e){var t=this;return new o(function(n,r){t._connect(e,function(){n(t)},r)})},r.prototype._connect=function(e,t,n,r){var i=this,o=new s(e+"?id="+this.url);return i.sockets[e]=o,o.onopen=function(){r=!0,o.onopen.callbacks.forEach(function(e){e(o)}),o.onopen.callbacks=[]},o.onopen.callbacks=t?[t]:[],o.onmessage=function(t){i.receive(e,JSON.parse(t.data))},o.onclose=function(){delete i.sockets[e],r&&i._reconnect(e)},o.onerror=function(t){delete i.sockets[e],n&&n(t)},o},r.prototype._reconnect=function(e){var t=this,n=!0;0==t.closed&&null==t.reconnectTimers[e]&&(t.reconnectTimers[e]=setTimeout(function(){delete t.reconnectTimers[e],t._connect(e,null,null,n)},t.transport.reconnectDelay))},r.prototype._onConnection=function(e,t){var n=this;return t.onmessage=function(t){n.receive(e,JSON.parse(t.data))},t.onclose=function(){delete n.sockets[e]},t.onerror=function(){delete n.sockets[e]},this.sockets[e]&&this.sockets[e].close(),this.sockets[e]=t,t},r.prototype.list=function(){return Object.keys(this.sockets)},r.prototype.close=function(){this.closed=!0;for(var e in this.sockets)this.sockets.hasOwnProperty(e)&&this.sockets[e].close();this.sockets={},delete this.transport.agents[this.url]},e.exports=r},function(e,t,n){e.exports=n(33)},function(e,t,n){"use strict";e.exports=n(35),n(36),n(37),n(38)},function(e,t){(function(t){"use strict";function n(e){var t,n=e.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);a>i;)s[i]=i++;for(i=0;a>i;i++)s[i]=s[o=v&o+e[i%n]+(t=s[i])],s[o]=t;(r.g=function(e){for(var t,n=0,i=r.i,o=r.j,s=r.S;e--;)t=s[i=v&i+1],n=n*a+s[v&(s[i]=s[o=v&o+t])+(s[o]=t)];return r.i=i,r.j=o,n})(a)}function r(e,t){var n,i=[],o=(typeof e)[0];if(t&&"o"==o)for(n in e)try{i.push(r(e[n],t-1))}catch(s){}return i.length?i:"s"==o?e:e+"\x00"}function i(e,t){for(var n,r=e+"",i=0;i<r.length;)t[v&i]=v&(n^=19*t[v&i])+r.charCodeAt(i++);return s(t)}function o(e){try{return h.crypto.getRandomValues(e=new Uint8Array(a)),s(e)}catch(t){return[+new Date,h,h.navigator&&h.navigator.plugins,h.screen,s(l)]}}function s(e){return String.fromCharCode.apply(0,e)}var a=256,c=6,u=52,l=[],h="undefined"==typeof t?window:t,f=Math.pow(a,c),p=Math.pow(2,u),d=2*p,v=a-1,m=Math.random;e.exports=function(t,u){if(u&&u.global===!0)return u.global=!1,Math.random=e.exports(t,u),u.global=!0,Math.random;var h=u&&u.entropy||!1,v=[],m=(i(r(h?[t,s(l)]:0 in arguments?t:o(),3),v),new n(v));return i(s(m.S),l),function(){for(var e=m.g(c),t=f,n=0;p>e;)e=(e+n)*a,t*=a,n=m.g(1);for(;e>=d;)e/=2,t/=2,n>>>=1;return(e+n)/t}},e.exports.resetGlobal=function(){Math.random=m},i(Math.random(),l)}).call(t,function(){return this}())},function(e,t){t=e.exports=function(){for(var e,n="",r=0;32>r;r++)e=16*t.random()|0,r>4&&21>r&&!(r%4)&&(n+="-"),n+=(12===r?4:16===r?3&e|8:e).toString(16);return n};var n=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/;t.isUUID=function(e){return n.test(e)},t.random=function(){return Math.random()}},function(e,t,n){"use strict";e.exports=n(39)},function(e,t,n){t.Host=n(40),t.Promise=n(41)},function(e,t,n){var r=e.exports,i=(n(45).EventEmitter,n(42)),o=n(30);r.request=function(e,t){"string"==typeof e&&(e=o.parse(e)),e||(e={}),e.host||e.port||(e.port=parseInt(window.location.port,10)),!e.host&&e.hostname&&(e.host=e.hostname),e.protocol||(e.protocol=e.scheme?e.scheme+":":window.location.protocol),e.host||(e.host=window.location.hostname||window.location.host),/:/.test(e.host)&&(e.port||(e.port=e.host.split(":")[1]),e.host=e.host.split(":")[0]),e.port||(e.port="https:"==e.protocol?443:80);var n=new i(new s,e);return t&&n.on("response",t),n},r.get=function(e,t){e.method="GET";var n=r.request(e,t);return n.end(),n},r.Agent=function(){},r.Agent.defaultMaxSockets=4;var s=function(){if("undefined"==typeof window)throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){for(var e=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],t=0;t<e.length;t++)try{var n=new window.ActiveXObject(e[t]);return function(){if(n){var r=n;return n=null,r}return new window.ActiveXObject(e[t])}}catch(r){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}();r.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},function(e,t,n){function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t,n){if(e&&u(e)&&e instanceof r)return e;var i=new r;return i.parse(e,t,n),i}function o(e){return c(e)&&(e=i(e)),e instanceof r?e.format():r.prototype.format.call(e)}function s(e,t){return i(e,!1,!0).resolve(t)}function a(e,t){return e?i(e,!1,!0).resolveObject(t):t}function c(e){return"string"==typeof e}function u(e){return"object"==typeof e&&null!==e}function l(e){return null===e}function h(e){return null==e}var f=n(55);t.parse=i,t.resolve=s,t.resolveObject=a,t.format=o,t.Url=r;var p=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,v=["<",">",'"',"`"," ","\r","\n","	"],m=["{","}","|","\\","^","`"].concat(v),g=["'"].concat(m),y=["%","/","?",";","#"].concat(g),_=["/","?","#"],b=255,w=/^[a-z0-9A-Z_-]{0,63}$/,k=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},E={javascript:!0,"javascript:":!0},T={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},S=n(46);r.prototype.parse=function(e,t,n){if(!c(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e;r=r.trim();var i=p.exec(r);if(i){i=i[0];
var o=i.toLowerCase();this.protocol=o,r=r.substr(i.length)}if(n||i||r.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===r.substr(0,2);!s||i&&E[i]||(r=r.substr(2),this.slashes=!0)}if(!E[i]&&(s||i&&!T[i])){for(var a=-1,u=0;u<_.length;u++){var l=r.indexOf(_[u]);-1!==l&&(-1===a||a>l)&&(a=l)}var h,d;d=-1===a?r.lastIndexOf("@"):r.lastIndexOf("@",a),-1!==d&&(h=r.slice(0,d),r=r.slice(d+1),this.auth=decodeURIComponent(h)),a=-1;for(var u=0;u<y.length;u++){var l=r.indexOf(y[u]);-1!==l&&(-1===a||a>l)&&(a=l)}-1===a&&(a=r.length),this.host=r.slice(0,a),r=r.slice(a),this.parseHost(),this.hostname=this.hostname||"";var v="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!v)for(var m=this.hostname.split(/\./),u=0,C=m.length;C>u;u++){var A=m[u];if(A&&!A.match(w)){for(var j="",O=0,P=A.length;P>O;O++)j+=A.charCodeAt(O)>127?"x":A[O];if(!j.match(w)){var M=m.slice(0,u),R=m.slice(u+1),I=A.match(k);I&&(M.push(I[1]),R.unshift(I[2])),R.length&&(r="/"+R.join(".")+r),this.hostname=M.join(".");break}}}if(this.hostname=this.hostname.length>b?"":this.hostname.toLowerCase(),!v){for(var F=this.hostname.split("."),L=[],u=0;u<F.length;++u){var B=F[u];L.push(B.match(/[^A-Za-z0-9_-]/)?"xn--"+f.encode(B):B)}this.hostname=L.join(".")}var N=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+N,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==r[0]&&(r="/"+r))}if(!x[o])for(var u=0,C=g.length;C>u;u++){var q=g[u],D=encodeURIComponent(q);D===q&&(D=escape(q)),r=r.split(q).join(D)}var H=r.indexOf("#");-1!==H&&(this.hash=r.substr(H),r=r.slice(0,H));var z=r.indexOf("?");if(-1!==z?(this.search=r.substr(z),this.query=r.substr(z+1),t&&(this.query=S.parse(this.query)),r=r.slice(0,z)):t&&(this.search="",this.query={}),r&&(this.pathname=r),T[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var N=this.pathname||"",B=this.search||"";this.path=N+B}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&u(this.query)&&Object.keys(this.query).length&&(o=S.stringify(this.query));var s=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||T[t])&&i!==!1?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),t+i+n+s+r},r.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(c(e)){var t=new r;t.parse(e,!1,!0),e=t}var n=new r;if(Object.keys(this).forEach(function(e){n[e]=this[e]},this),n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){"protocol"!==t&&(n[t]=e[t])}),T[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;if(e.protocol&&e.protocol!==n.protocol){if(!T[e.protocol])return Object.keys(e).forEach(function(t){n[t]=e[t]}),n.href=n.format(),n;if(n.protocol=e.protocol,e.host||E[e.protocol])n.pathname=e.pathname;else{for(var i=(e.pathname||"").split("/");i.length&&!(e.host=i.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==i[0]&&i.unshift(""),i.length<2&&i.unshift(""),n.pathname=i.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var o=n.pathname||"",s=n.search||"";n.path=o+s}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var a=n.pathname&&"/"===n.pathname.charAt(0),u=e.host||e.pathname&&"/"===e.pathname.charAt(0),f=u||a||n.host&&e.pathname,p=f,d=n.pathname&&n.pathname.split("/")||[],i=e.pathname&&e.pathname.split("/")||[],v=n.protocol&&!T[n.protocol];if(v&&(n.hostname="",n.port=null,n.host&&(""===d[0]?d[0]=n.host:d.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===i[0]?i[0]=e.host:i.unshift(e.host)),e.host=null),f=f&&(""===i[0]||""===d[0])),u)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,d=i;else if(i.length)d||(d=[]),d.pop(),d=d.concat(i),n.search=e.search,n.query=e.query;else if(!h(e.search)){if(v){n.hostname=n.host=d.shift();var m=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;m&&(n.auth=m.shift(),n.host=n.hostname=m.shift())}return n.search=e.search,n.query=e.query,l(n.pathname)&&l(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!d.length)return n.pathname=null,n.path=n.search?"/"+n.search:null,n.href=n.format(),n;for(var g=d.slice(-1)[0],y=(n.host||e.host)&&("."===g||".."===g)||""===g,_=0,b=d.length;b>=0;b--)g=d[b],"."==g?d.splice(b,1):".."===g?(d.splice(b,1),_++):_&&(d.splice(b,1),_--);if(!f&&!p)for(;_--;_)d.unshift("..");!f||""===d[0]||d[0]&&"/"===d[0].charAt(0)||d.unshift(""),y&&"/"!==d.join("/").substr(-1)&&d.push("");var w=""===d[0]||d[0]&&"/"===d[0].charAt(0);if(v){n.hostname=n.host=w?"":d.length?d.shift():"";var m=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;m&&(n.auth=m.shift(),n.host=n.hostname=m.shift())}return f=f||n.host&&d.length,f&&!w&&d.unshift(""),d.length?n.pathname=d.join("/"):(n.pathname=null,n.path=null),l(n.pathname)&&l(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=d.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){"use strict";var r=n(44);e.exports={Connection:r,createConnection:function(e,t,n){var i=new r(e,t,n);return i.connect(),i}}},function(e,t,r){(function(t){function i(){return"x"+ ++C+ +new Date}function o(){return+new Date}function s(e,t){var n=e.join(L),r=[];return t?(p(t,function(e,t){var n="object"==typeof t?JSON.stringify(t):t;"undefined"!=typeof t&&null!=t&&v(n).length>0&&r.push(e+"="+v(n))}),n+="?"+r.join(B)):n}function a(e,t){var n,r=0,i=function(){r+t>o()?(clearTimeout(n),n=setTimeout(i,t)):(r=o(),e())};return i}function c(e,t){var n=[];return p(e||[],function(e){t(e)&&n.push(e)}),n}function u(e,t){return e.replace(D,function(e,n){return t[n]||e})}function l(e,t){return setTimeout(e,t)}function h(e){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)});return e&&e(t),t}function f(e){return!!e&&Array.isArray&&Array.isArray(e)}function p(e,t){if(e&&t)if(f(e))for(var n=0,r=e.length;r>n;)t.call(e[n],e[n],n++);else for(var n in e)e.hasOwnProperty&&e.hasOwnProperty(n)&&t.call(e[n],n,e[n])}function d(e,t){var n=[];return p(e||[],function(e,r){n.push(t(e,r))}),n}function v(e){return encodeURIComponent(e)}function m(e,t){var n=[];return p(e,function(e,r){t?e.search("-pnpres")<0&&r.subscribed&&n.push(e):r.subscribed&&n.push(e)}),n.sort()}function g(e,t){var n=[];return p(e,function(e,r){t?channel.search("-pnpres")<0&&r.subscribed&&n.push(e):r.subscribed&&n.push(e)}),n.sort()}function y(){l(function(){A||(A=1,p(j,function(e){e()}))},F)}function _(e){return msg=e||{apns:{}},msg.getPubnubMessage=function(){var e={};if(Object.keys(msg.apns).length){e.pn_apns={aps:{alert:msg.apns.alert,badge:msg.apns.badge}};for(var t in msg.apns)e.pn_apns[t]=msg.apns[t];var n=["badge","alert"];for(var t in n)delete e.pn_apns[n[t]]}msg.gcm&&(e.pn_gcm={data:msg.gcm});for(var t in msg)e[t]=msg[t];var r=["apns","gcm","publish","channel","callback","error"];for(var t in r)delete e[r[t]];return e},msg.publish=function(){var e=msg.getPubnubMessage();msg.pubnub&&msg.channel&&msg.pubnub.publish({message:e,channel:msg.channel,callback:msg.callback,error:msg.error})},msg}function b(e){function t(e){return e||(e={}),p(At,function(t,n){t in e||(e[t]=n)}),e}function r(e){var t=[];return p(e,function(e){t.push(e)}),t}function s(e){return r(e).sort()}function _(e){var t="",n=s(e);for(var r in n){var i=n[r];t+=i+"="+v(e[i]),r!=n.length-1&&(t+="&")}return t}function b(e,t,n){var r=!1;if("number"==typeof e)r=e>N||0==e?!1:!0;else{if("boolean"==typeof e)return e?U:0;r=!0}return r?(n&&n("Presence Heartbeat value invalid. Valid range ( x > "+N+" or x = 0). Current Value : "+(t||N)),t||N):e}function w(e,t){return Ft.encrypt(e,t||Rt)||e}function x(e,t){return Ft.decrypt(e,t||Rt)||Ft.decrypt(e,Rt)||e}function E(){return clearTimeout(wt),!xt||xt>=500||1>xt||!m(yt,!0).length?void(Et=!1):(Et=!0,void Lt.presence_heartbeat({callback:function(){wt=l(E,xt*F)},error:function(e){jt&&jt("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(e)),wt=l(E,xt*F)}}))}function T(){!Et&&E()}function S(e){if(Tt){if(!ut.length)return}else{if(e&&(ut.sending=0),ut.sending||!ut.length)return;ut.sending=1}Ct(ut.shift())}function C(e){var t=0;return p(m(yt),function(n){var r=yt[n];r&&(t++,(e||function(){})(r))}),t}function M(e,t,n){if("object"==typeof e){if(e.error&&e.message&&e.payload)return void n({message:e.message,payload:e.payload});if(e.payload)return void t(e.payload)}t(e)}function L(e,t){t("object"==typeof e&&e.error&&e.message&&e.payload?{message:e.message,payload:e.payload}:e)}function B(e,n,r,i){var n=e.callback||n,o=e.error||jt,s=Pt(),a=[st,"v1","channel-registration","sub-key",et];a.push.apply(a,r),Ct({callback:s,data:t(i),success:function(e){M(e,n,o)},fail:function(e){L(e,o)},url:a})}function D(){Ot()||K(1,{error:"Offline. Please check your network settings. "}),V&&clearTimeout(V),V=l(D,F)}function z(){Lt.time(function(e){W(function(){},e),e||K(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),G&&clearTimeout(G),G=l(z,Q)})}function K(e,t){dt&&dt(e,t),dt=null,clearTimeout(V),clearTimeout(G)}function J(e){var t=o()-ht;return t-e/1e4}function W(e,t){function n(t){if(t){var n=t/1e4,i=(o()-r)/2;ht=o()-(n+i),e&&e(ht)}}var r=o();t&&n(t)||Lt.time(n)}var V,G,Y=+e.windowing||P,$=(+e.timeout||R)*F,Q=(+e.keepalive||I)*F,X=e.noleave||0,Z=e.publish_key||"demo",et=e.subscribe_key||"demo",tt=e.auth_key||"",nt=e.secret_key||"",rt=e.hmac_SHA256,it=e.ssl?"s":"",ot="http"+it+"://"+(e.origin||"pubsub.pubnub.com"),st=H(ot),at=H(ot),ct=function(){},ut=[],lt=!0,ht=0,ft=0,pt=0,dt=0,vt=e.restore||0,mt=0,gt=!1,yt={},_t={},bt={},wt=null,kt=b(e.heartbeat||e.pnexpires||0,e.error),xt=e.heartbeat_interval||kt-3,Et=!1,Tt=e.no_wait_for_pending,St=e["compatible_3.5"]||!1,Ct=e.xdr,At=e.params||{},jt=e.error||function(){},Ot=e._is_online||function(){return 1},Pt=e.jsonp_cb||function(){return 0},Mt=e.db||{get:function(){},set:function(){}},Rt=e.cipher_key,It=e.uuid||Mt&&Mt.get(et+"uuid")||"",Ft=e.crypto_obj||{encrypt:function(e){return e},decrypt:function(e){return e}},Lt={LEAVE:function(e,n,r,i){var o={uuid:It,auth:tt},s=H(ot),r=r||function(){},a=i||function(){},c=Pt();if(e.indexOf(O)>0)return!0;if(St){if(!it)return!1;if("0"==c)return!1}return X?!1:("0"!=c&&(o.callback=c),Ct({blocking:n||it,timeout:2e3,callback:c,data:t(o),success:function(e){M(e,r,a)},fail:function(e){L(e,a)},url:[s,"v2","presence","sub_key",et,"channel",v(e),"leave"]}),!0)},set_resumed:function(e){gt=e},get_cipher_key:function(){return Rt},set_cipher_key:function(e){Rt=e},raw_encrypt:function(e,t){return w(e,t)},raw_decrypt:function(e,t){return x(e,t)},get_heartbeat:function(){return kt},set_heartbeat:function(e){kt=b(e,xt,jt),xt=kt-3>=1?kt-3:1,ct(),E()},get_heartbeat_interval:function(){return xt},set_heartbeat_interval:function(e){xt=e,E()},get_version:function(){return q},getGcmMessageObject:function(e){return{data:e}},getApnsMessageObject:function(e){var t={aps:{badge:1,alert:""}};for(k in e)k[t]=e[k];return t},newPnMessage:function(){var e={};gcm&&(e.pn_gcm=gcm),apns&&(e.pn_apns=apns);for(k in n)e[k]=n[k];return e},_add_param:function(e,t){At[e]=t},channel_group:function(e,t){var n,r,i=e.channel_group,o=e.channels||e.channel,s=e.cloak,a=[],c={},u=e.mode||"add";if(i){var l=i.split(":");l.length>1?(n="*"===l[0]?null:l[0],r=l[1]):r=l[0]}n&&a.push("namespace")&&a.push(v(n)),a.push("channel-group"),r&&"*"!==r&&a.push(r),o?(f(o)&&(o=o.join(",")),c[u]=o,c.cloak=lt?"true":"false"):"remove"===u&&a.push("remove"),"undefined"!=typeof s&&(c.cloak=s?"true":"false"),B(e,t,a,c)},channel_group_list_groups:function(e,t){var n;n=e.namespace||e.ns||e.channel_group||null,n&&(e.channel_group=n+":*"),Lt.channel_group(e,t)},channel_group_list_channels:function(e,t){return e.channel_group?void Lt.channel_group(e,t):jt("Missing Channel Group")},channel_group_remove_channel:function(e,t){return e.channel_group?e.channel||e.channels?(e.mode="remove",void Lt.channel_group(e,t)):jt("Missing Channel"):jt("Missing Channel Group")},channel_group_remove_group:function(e,t){return e.channel_group?e.channel?jt("Use channel_group_remove_channel if you want to remove a channel from a group."):(e.mode="remove",void Lt.channel_group(e,t)):jt("Missing Channel Group")},channel_group_add_channel:function(e,t){return e.channel_group?e.channel||e.channels?void Lt.channel_group(e,t):jt("Missing Channel"):jt("Missing Channel Group")},channel_group_cloak:function(e,t){return"undefined"==typeof e.cloak?void t(lt):(lt=e.cloak,void Lt.channel_group(e,t))},channel_group_list_namespaces:function(e,t){var n=["namespace"];B(e,t,n)},channel_group_remove_namespace:function(e,t){var n=["namespace",e.namespace,"remove"];B(e,t,n)},history:function(e,n){var n=e.callback||n,r=e.count||e.limit||100,i=e.reverse||"false",o=e.error||function(){},s=e.auth_key||tt,a=e.cipher_key,c=e.channel,u=e.channel_group,l=e.start,h=e.end,f=e.include_token,p={},d=Pt();return c||u?n?et?(p.stringtoken="true",p.count=r,p.reverse=i,p.auth=s,u&&(p["channel-group"]=u,c||(c=",")),d&&(p.callback=d),l&&(p.start=l),h&&(p.end=h),f&&(p.include_token="true"),void Ct({callback:d,data:t(p),success:function(e){if("object"==typeof e&&e.error)return void o({message:e.message,payload:e.payload});for(var t=e[0],r=[],i=0;i<t.length;i++){var s=x(t[i],a);try{r.push(JSON.parse(s))}catch(c){r.push(s)}}n([r,e[1],e[2]])},fail:function(e){L(e,o)},url:[st,"v2","history","sub-key",et,"channel",v(c)]})):jt("Missing Subscribe Key"):jt("Missing Callback"):jt("Missing Channel")},replay:function(e,n){var r,n=n||e.callback||function(){},i=e.auth_key||tt,o=e.source,s=e.destination,a=e.stop,c=e.start,u=e.end,l=e.reverse,h=e.limit,f=Pt(),p={};return o?s?Z?et?("0"!=f&&(p.callback=f),a&&(p.stop="all"),l&&(p.reverse="true"),c&&(p.start=c),u&&(p.end=u),h&&(p.count=h),p.auth=i,r=[st,"v1","replay",Z,et,o,s],void Ct({callback:f,success:function(e){M(e,n,err)},fail:function(){n([0,"Disconnected"])},url:r,data:t(p)})):jt("Missing Subscribe Key"):jt("Missing Publish Key"):jt("Missing Destination Channel"):jt("Missing Source Channel")},auth:function(e){tt=e,ct()},time:function(e){var n=Pt();Ct({callback:n,data:t({uuid:It,auth:tt}),timeout:5*F,url:[st,"time",n],success:function(t){e(t[0])},fail:function(){e(0)}})},publish:function(e,n){var r=e.message;if(!r)return jt("Missing Message");var i,n=n||e.callback||r.callback||function(){},o=e.channel||r.channel,s=e.auth_key||tt,a=e.cipher_key,c=e.error||r.error||function(){},u=e.post||!1,l="store_in_history"in e?e.store_in_history:!0,h=Pt(),f="push";return e.prepend&&(f="unshift"),o?Z?et?(r.getPubnubMessage&&(r=r.getPubnubMessage()),r=JSON.stringify(w(r,a)),i=[st,"publish",Z,et,0,v(o),h,v(r)],At={uuid:It,auth:s},l||(At.store="0"),ut[f]({callback:h,timeout:5*F,url:i,data:t(At),fail:function(e){L(e,c),S(1)},success:function(e){M(e,n,c),S(1)},mode:u?"POST":"GET"}),void S()):jt("Missing Subscribe Key"):jt("Missing Publish Key"):jt("Missing Channel")},unsubscribe:function(e,t){var n=e.channel,r=e.channel_group,t=t||e.callback||function(){},i=e.error||function(){};mt=0,n&&(n=d((n.join?n.join(","):""+n).split(","),function(e){return yt[e]?e+","+e+O:void 0}).join(","),p(n.split(","),function(e){var n=!0;e&&(A&&(n=Lt.LEAVE(e,0,t,i)),n||t({action:"leave"}),yt[e]=0,e in bt&&delete bt[e])})),r&&(r=d((r.join?r.join(","):""+r).split(","),function(e){return _t[e]?e+","+e+O:void 0}).join(","),p(r.split(","),function(){var e=!0;r&&(A&&(e=Lt.LEAVE(r,0,t,i)),e||t({action:"leave"}),_t[r]=0,r in bt&&delete bt[r])})),ct()},subscribe:function(e,n){function r(e){e?l(ct,F):(st=H(ot,1),at=H(ot,1),l(function(){Lt.time(r)},F)),C(function(t){return e&&t.disconnected?(t.disconnected=0,t.reconnect(t.name)):void(e||t.disconnected||(t.disconnected=1,t.disconnect(t.name)))})}function i(){var e=Pt(),n=m(yt).join(","),o=g(_t).join(",");if(n||o){n||(n=","),K();var s=t({uuid:It,auth:c});o&&(s["channel-group"]=o);var a=JSON.stringify(bt);a.length>2&&(s.state=JSON.stringify(bt)),kt&&(s.heartbeat=kt),T(),dt=Ct({timeout:S,callback:e,fail:function(e){L(e,y),Lt.time(r)},data:t(s),url:[at,"subscribe",et,v(n),e,mt],success:function(e){if(!e||"object"==typeof e&&"error"in e&&e.error)return y(e.error),l(ct,F);if(_(e[1]),mt=!mt&&vt&&Mt.get(et)||e[1],C(function(e){e.connected||(e.connected=1,e.connect(e.name))}),gt&&!vt)return mt=0,gt=!1,Mt.set(et,0),void l(i,P);k&&(mt=1e4,k=0),Mt.set(et,e[1]);var t=function(){var t="";t=e.length>3?e[3]:e.length>2?e[2]:d(m(yt),function(t){return d(Array(e[0].length).join(",").split(","),function(){return t})}).join(",");var n=t.split(",");return function(){var e=n.shift()||pt;return[(yt[e]||{}).callback||ft,e.split(O)[0]]}}(),n=J(+e[1]);p(e[0],function(r){var i=t(),o=x(r,yt[i[1]]?yt[i[1]].cipher_key:null);i[0](o,e,i[2]||i[1],n)}),l(i,P)}})}}var s=e.channel,a=e.channel_group,n=n||e.callback,n=n||e.message,c=e.auth_key||tt,u=e.connect||function(){},h=e.reconnect||function(){},f=e.disconnect||function(){},y=e.error||function(){},_=e.idle||function(){},b=e.presence||0,w=e.noheresync||0,k=e.backfill||0,E=e.timetoken||0,S=e.timeout||$,P=e.windowing||Y,M=e.state,R=e.heartbeat||e.pnexpires,I=e.restore||vt;return vt=I,mt=E,s||a?n?et?((R||0===R)&&Lt.set_heartbeat(R),s&&p((s.join?s.join(","):""+s).split(","),function(t){var r=yt[t]||{};yt[pt=t]={name:t,connected:r.connected,disconnected:r.disconnected,subscribed:1,callback:ft=n,cipher_key:e.cipher_key,connect:u,disconnect:f,reconnect:h},M&&(bt[t]=t in M?M[t]:M),b&&(Lt.subscribe({channel:t+O,callback:b,restore:I}),r.subscribed||w||Lt.here_now({channel:t,callback:function(e){p("uuids"in e?e.uuids:[],function(n){b({action:"join",uuid:n,timestamp:Math.floor(o()/1e3),occupancy:e.occupancy||1},e,t)})}}))}),a&&p((a.join?a.join(","):""+a).split(","),function(t){var r=_t[t]||{};_t[t]={name:t,connected:r.connected,disconnected:r.disconnected,subscribed:1,callback:ft=n,cipher_key:e.cipher_key,connect:u,disconnect:f,reconnect:h},b&&(Lt.subscribe({channel_group:t+O,callback:b,restore:I}),r.subscribed||w||Lt.here_now({channel_group:t,callback:function(e){p("uuids"in e?e.uuids:[],function(n){b({action:"join",uuid:n,timestamp:Math.floor(o()/1e3),occupancy:e.occupancy||1},e,t)})}}))}),ct=function(){K(),l(i,P)},A?void ct():j.push(ct)):jt("Missing Subscribe Key"):jt("Missing Callback"):jt("Missing Channel")},here_now:function(e,n){var n=e.callback||n,r=e.error||function(){},i=e.auth_key||tt,o=e.channel,s=e.channel_group,a=Pt(),c="uuids"in e?e.uuids:!0,u=e.state,l={uuid:It,auth:i};if(c||(l.disable_uuids=1),u&&(l.state=1),!n)return jt("Missing Callback");if(!et)return jt("Missing Subscribe Key");var h=[st,"v2","presence","sub_key",et];o&&h.push("channel")&&h.push(v(o)),"0"!=a&&(l.callback=a),s&&(l["channel-group"]=s,!o&&h.push("channel")&&h.push(",")),Ct({callback:a,data:t(l),success:function(e){M(e,n,r)},fail:function(e){L(e,r)},url:h})},where_now:function(e,n){var n=e.callback||n,r=e.error||function(){},i=e.auth_key||tt,o=Pt(),s=e.uuid||It,a={auth:i};return n?et?("0"!=o&&(a.callback=o),void Ct({callback:o,data:t(a),success:function(e){M(e,n,r)},fail:function(e){L(e,r)},url:[st,"v2","presence","sub_key",et,"uuid",v(s)]})):jt("Missing Subscribe Key"):jt("Missing Callback")},state:function(e,n){var r,n=e.callback||n||function(){},i=e.error||function(){},o=e.auth_key||tt,s=Pt(),a=e.state,c=e.uuid||It,u=e.channel,l=e.channel_group,h=t({auth:o});return et?c?u||l?("0"!=s&&(h.callback=s),"undefined"!=typeof u&&yt[u]&&yt[u].subscribed&&a&&(bt[u]=a),"undefined"!=typeof l&&_t[l]&&_t[l].subscribed&&(a&&(bt[l]=a),h["channel-group"]=l,u||(u=",")),h.state=JSON.stringify(a),r=a?[st,"v2","presence","sub-key",et,"channel",u,"uuid",c,"data"]:[st,"v2","presence","sub-key",et,"channel",u,"uuid",v(c)],void Ct({callback:s,data:t(h),success:function(e){M(e,n,i)},fail:function(e){L(e,i)},url:r})):jt("Missing Channel"):jt("Missing UUID"):jt("Missing Subscribe Key")},grant:function(e,n){var n=e.callback||n,r=e.error||function(){},i=e.channel,o=e.channel_group,s=Pt(),a=e.ttl,c=e.read?"1":"0",u=e.write?"1":"0",l=e.manage?"1":"0",h=e.auth_key;if(!n)return jt("Missing Callback");if(!et)return jt("Missing Subscribe Key");if(!Z)return jt("Missing Publish Key");if(!nt)return jt("Missing Secret Key");var f=Math.floor((new Date).getTime()/1e3),p=et+"\n"+Z+"\ngrant\n",d={w:u,r:c,timestamp:f};e.manage&&(d.m=l),"undefined"!=typeof i&&null!=i&&i.length>0&&(d.channel=i),"undefined"!=typeof o&&null!=o&&o.length>0&&(d["channel-group"]=o),"0"!=s&&(d.callback=s),(a||0===a)&&(d.ttl=a),h&&(d.auth=h),d=t(d),h||delete d.auth,p+=_(d);var v=rt(p,nt);v=v.replace(/\+/g,"-"),v=v.replace(/\//g,"_"),d.signature=v,Ct({callback:s,data:d,success:function(e){M(e,n,r)},fail:function(e){L(e,r)},url:[st,"v1","auth","grant","sub-key",et]})},audit:function(e,n){var n=e.callback||n,r=e.error||function(){},i=e.channel,o=e.channel_group,s=e.auth_key,a=Pt();if(!n)return jt("Missing Callback");if(!et)return jt("Missing Subscribe Key");if(!Z)return jt("Missing Publish Key");if(!nt)return jt("Missing Secret Key");var c=Math.floor((new Date).getTime()/1e3),u=et+"\n"+Z+"\naudit\n",l={timestamp:c};"0"!=a&&(l.callback=a),"undefined"!=typeof i&&null!=i&&i.length>0&&(l.channel=i),"undefined"!=typeof o&&null!=o&&o.length>0&&(l["channel-group"]=o),s&&(l.auth=s),l=t(l),s||delete l.auth,u+=_(l);var h=rt(u,nt);h=h.replace(/\+/g,"-"),h=h.replace(/\//g,"_"),l.signature=h,Ct({callback:a,data:l,success:function(e){M(e,n,r)},fail:function(e){L(e,r)},url:[st,"v1","auth","audit","sub-key",et]})},revoke:function(e,t){e.read=!1,e.write=!1,Lt.grant(e,t)},set_uuid:function(e){It=e,ct()},get_uuid:function(){return It},presence_heartbeat:function(e){var n=e.callback||function(){},r=e.error||function(){},i=Pt(),o={uuid:It,auth:tt},s=JSON.stringify(bt);s.length>2&&(o.state=JSON.stringify(bt)),kt>0&&320>kt&&(o.heartbeat=kt),"0"!=i&&(o.callback=i);var a=v(m(yt,!0).join(",")),c=g(_t,!0).join(",");a||(a=","),c&&(o["channel-group"]=c),Ct({callback:i,data:t(o),timeout:5*F,url:[st,"v2","presence","sub-key",et,"channel",a,"heartbeat"],success:function(e){M(e,n,r)},fail:function(e){L(e,r)}})},stop_timers:function(){clearTimeout(V),clearTimeout(G)},xdr:Ct,ready:y,db:Mt,uuid:h,map:d,each:p,"each-channel":C,grep:c,offline:function(){K(1,{message:"Offline. Please check your network settings."})},supplant:u,now:o,unique:i,updater:a};return It||(It=Lt.uuid()),Mt.set(et+"uuid",It),V=l(D,F),G=l(z,Q),wt=l(T,(xt-3)*F),W(),Lt}function w(e,n){return V.createHmac("sha256",new t(n,"utf8")).update(e).digest("base64")}function x(e){console.error(e)}function E(e){var t,n,i=e.success||function(){},o=e.fail||function(){},a=e.origin||"pubsub.pubnub.com",c=e.ssl,u=0,h=0,f=e.mode||"GET",p=e.data||{},d=e.timeout||M,v="",m=function(){if(!h){h=1,clearTimeout(y);try{n=JSON.parse(v)}catch(e){return g(1)}i(n)}},g=function(e,n){u||(u=1,clearTimeout(y),t&&(t.on("error",function(){}),t.on("data",function(){}),t.on("end",function(){}),t.abort&&t.abort(),t=null),e&&o(n))},y=l(function(){g(1)},d);p.pnsdk=W;var _={},b="";"POST"==f&&(b=decodeURIComponent(e.url.pop()));var w=s(e.url,p);c||(c="https"==w.split("://")[0]?!0:!1),w="/"+w.split("/").slice(3).join("/");var a=e.url[0].split("//")[1];_.hostname=G?G.hostname:e.url[0].split("//")[1],_.port=G?G.port:c?443:80,_.path=G?"http://"+a+w:w,_.headers=G?{Host:a}:null,_.method=f,_.keepAlive=!!J,_.body=b,r(29).globalAgent.maxSockets=1/0;try{t=(c?K:z).request(_,function(e){e.setEncoding("utf8"),e.on("error",function(){g(1,v||{error:"Network Connection Error"})}),e.on("abort",function(){g(1,v||{error:"Network Connection Error"})}),e.on("data",function(e){e&&(v+=e)}),e.on("end",function(){var t=e.statusCode;switch(t){case 401:case 402:case 403:try{e=JSON.parse(v),g(1,e)}catch(n){return g(1,v)}return}m()})}),t.timeout=d,t.on("error",function(){g(1,{error:"Network Connection Error"})}),"POST"==f&&t.write(b),t.end()}catch(k){return g(0),E(e)}return g}function T(){function e(e){return V.createHash("sha256").update(e).digest("hex").slice(0,32)}var t="0123456789012345";return{encrypt:function(n,r){if(!r)return n;var i=JSON.stringify(n),o=V.createCipheriv("aes-256-cbc",e(r),t),s=o.update(i,"utf8","base64")+o.final("base64");return s||n},decrypt:function(n,r){if(!r)return n;var i=V.createDecipheriv("aes-256-cbc",e(r),t);try{var o=i.update(n,"base64","utf8")+i.final("utf8")}catch(s){return null}return JSON.parse(o)}}}function S(){return"EventEmitter"in z.Agent.super_}var C=1,A=!1,j=[],O="-pnpres",P=10,M=1e4,R=310,I=60,F=1e3,L="/",B="&",N=5,U=30,q="3.7.0",D=/{([\w\-]+)}/g,H=function(){var e=20,t=Math.floor(Math.random()*e);return function(n,r){return n.indexOf("pubsub.")>0&&n.replace("pubsub","ps"+(r?h().split("-")[0]:++t<e?t:t=1))||n}}(),C=1,z=r(29),K=r(47),J=new(S()?z.Agent:r(56))({keepAlive:!0,keepAliveMsecs:3e5,maxSockets:5}),M=1e4,F=1e3,W="PubNub-JS-Nodejs/3.7.0",V=r(48),G=null,Y=function(){var e={};return{get:function(t){return e[t]},set:function(t,n){e[t]=n}}}(),$=function(e){G=e.proxy,e.xdr=E,e.db=Y,e.error=e.error||x,e.hmac_SHA256=w,e.crypto_obj=T(),e.params={pnsdk:W},e.keepAlive===!1&&(J=void 0),SELF=function(e){return $(e)};var t=b(e);for(var n in t)t.hasOwnProperty(n)&&(SELF[n]=t[n]);return SELF.init=SELF,SELF.secure=SELF,SELF.ready(),SELF};$.init=$,$.unique=i,$.secure=$,e.exports=$,e.exports.PNmessage=_}).call(t,r(49).Buffer)},function(e,t,n){function r(e){function t(e){if(p.length>0){for(var t=p.length-1;t>=0&&p[t].time>e.time;)t--;p.splice(t+1,0,e)}else p.push(e)}function n(e,n){function r(){e.type===o.INTERVAL&&d[e.id]&&(e.occurrence++,e.time=e.firstTime+e.occurrence*e.interval,t(e)),delete d[e.id],"function"==typeof n&&n()}d[e.id]=e;try{0==e.callback.length?(e.callback(),r()):e.callback(r)}catch(i){r()}}function r(e){for(var t=0;t<p.length&&(p[t].time<=e||!isFinite(p[t].time));)t++;var n=p.splice(0,t);return 0==u&&i.shuffle(n),n}function a(){function e(){function e(){var r=t.shift();r?n(r,e):a()}c===s&&(f=i>f&&isFinite(i)?i:f);var t=r(i);c===s?e():(t.forEach(n),a())}if(!(c===s&&Object.keys(d).length>0)){var t=p[0];if(v&&(clearTimeout(v),v=null),l&&t){var i=t.time,o=i-g.now(),u=c===s?0:o/c;v=setTimeout(e,Math.round(u))}}}var c=1,u=!0,l=!1,h=null,f=null,p=[],d={},v=null,m=0,g={};return g.config=function(e){if(e){if("rate"in e){var t=e.rate===s?s:Number(e.rate);if(t!==s&&(isNaN(t)||0>=t))throw new TypeError('rate must be a positive number or the string "discrete"');f=g.now(),h=i.systemNow(),c=t}"deterministic"in e&&(u=e.deterministic?!0:!1)}return a(),{rate:c,deterministic:u}},g.setTime=function(e){if(e instanceof Date)f=e.valueOf();else{var t=Number(e);if(isNaN(t))throw new TypeError("time must be a Date or number");f=t}a()},g.now=function(){if(c===s)return f;if(l){var e=i.systemNow()-h,t=e*c;return f+t}return f},g["continue"]=function(){h=i.systemNow(),l=!0,a()},g.pause=function(){f=g.now(),h=null,l=!1,a()},g.getTime=function(){return new Date(g.now())},g.valueOf=g.getTime,g.toString=function(){return g.getTime().toString()},g.setTimeout=function(e,n){var r=m++,i=g.now()+n;if(isNaN(i))throw new TypeError("delay must be a number");return t({id:r,type:o.TIMEOUT,time:i,callback:e}),a(),r},g.setTrigger=function(e,n){var r=m++,i=Number(n);if(isNaN(i))throw new TypeError("time must be a Date or number");return t({id:r,type:o.TRIGGER,time:i,callback:e}),a(),r},g.setInterval=function(e,n,r){var i=m++,s=Number(n);if(isNaN(s))throw new TypeError("interval must be a number");(0>s||!isFinite(s))&&(s=0);var c;if(void 0!=r){if(c=Number(r),isNaN(c))throw new TypeError("firstTime must be a Date or number")}else c=g.now()+s;return t({id:i,type:o.INTERVAL,interval:s,time:c,firstTime:c,occurrence:0,callback:e}),a(),i},g.clearTimeout=function(e){if(d[e])return void delete d[e];for(var t=0;t<p.length;t++)if(p[t].id===e){p.splice(t,1),a();break}},g.clearTrigger=g.clearTimeout,g.clearInterval=g.clearTimeout,g.list=function(){return p.map(function(e){return e.id})},g.clear=function(){d={},p=[],a()},Object.defineProperty(g,"running",{get:function(){return l}}),g.config(e),g.setTime(i.systemNow()),g.continue(),g}var i=n(43),o={TIMEOUT:0,INTERVAL:1,TRIGGER:2},s="discrete";e.exports=r},function(e){function t(e,t){var n;return n=t?new r(e,t):new r(e)}var n=function(){return this}(),r=n.WebSocket||n.MozWebSocket;e.exports=r?t:null,r&&(t.prototype=r.prototype)},function(e,t,n){"use strict";function r(e){function t(e){return null===c?void l.push(e):void s(function(){var t=c?e.onFulfilled:e.onRejected;if(null===t)return void(c?e.resolve:e.reject)(u);var n;try{n=t(u)}catch(r){return void e.reject(r)}e.resolve(n)})}function n(e){try{if(e===h)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void o(t.bind(e),n,r)}c=!0,u=e,a()}catch(i){r(i)}}function r(e){c=!1,u=e,a()}function a(){for(var e=0,n=l.length;n>e;e++)t(l[e]);l=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");var c=null,u=null,l=[],h=this;this.then=function(e,n){return new h.constructor(function(r,o){t(new i(e,n,r,o))})},o(e,n,r)}function i(e,t,n,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r}function o(e,t,n){var r=!1;try{e(function(e){r||(r=!0,t(e))},function(e){r||(r=!0,n(e))})}catch(i){if(r)return;r=!0,n(i)}}var s=n(83);e.exports=r},function(e,t,n){"use strict";var r=n(35),i=n(83);e.exports=r,r.prototype.done=function(){var e=arguments.length?this.then.apply(this,arguments):this;e.then(null,function(e){i(function(){throw e})})}},function(e,t,n){"use strict";function r(e){this.then=function(t){return"function"!=typeof t?this:new i(function(n,r){o(function(){try{n(t(e))}catch(i){r(i)}})})}}var i=n(35),o=n(83);e.exports=i,r.prototype=i.prototype;var s=new r(!0),a=new r(!1),c=new r(null),u=new r(void 0),l=new r(0),h=new r("");i.resolve=function(e){if(e instanceof i)return e;if(null===e)return c;if(void 0===e)return u;if(e===!0)return s;if(e===!1)return a;if(0===e)return l;if(""===e)return h;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new i(t.bind(e))}catch(n){return new i(function(e,t){t(n)})}return new r(e)},i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,n){function r(o,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(e){r(o,e)},n)}t[o]=s,0===--i&&e(t)}catch(c){n(c)}}if(0===t.length)return e([]);for(var i=t.length,o=0;o<t.length;o++)r(o,t[o])})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){e.forEach(function(e){i.resolve(e).then(t,n)})})},i.prototype["catch"]=function(e){return this.then(null,e)}},function(e,t,n){"use strict";var r=n(35),i=n(83);e.exports=r,r.denodeify=function(e,t){return t=t||1/0,function(){var n=this,i=Array.prototype.slice.call(arguments);return new r(function(r,o){for(;i.length&&i.length>t;)i.pop();i.push(function(e,t){e?o(e):r(t)}),e.apply(n,i)})}},r.nodeify=function(e){return function(){var t=Array.prototype.slice.call(arguments),n="function"==typeof t[t.length-1]?t.pop():null,o=this;
try{return e.apply(this,arguments).nodeify(n,o)}catch(s){if(null===n||"undefined"==typeof n)return new r(function(e,t){t(s)});i(function(){n.call(o,s)})}}},r.prototype.nodeify=function(e,t){return"function"!=typeof e?this:void this.then(function(n){i(function(){e.call(t,null,n)})},function(n){i(function(){e.call(t,n)})})}},function(e,t,n){"use strict";var r=n(50),i=n(64),o=n(65),s=n(66),a=n(67),c=n(68);t.babbler=function(e){return new r(e)},t.tell=function(e){return new i(e)},t.ask=function(e,n){return t.tell(e).listen(n)},t.decide=function(e,t){return new a(e,t)},t.listen=function(e){var t=new o;return e?t.then(e):t},t.then=function(e){return new s(e)},t.iif=function(e,t,n){return new c(e,t,n)},t.Babbler=r,t.block={Block:n(69),Then:n(66),Decision:n(67),IIf:n(68),Listen:n(65),Tell:n(64)},t.messagebus=n(51),t.babblify=function(e,n){var r;if(n&&void 0!==n.id)r=n.id;else{if(void 0===e.id)throw new Error('Id missing. Ensure that either actor has a property "id", or provide an id as a property in second argument params');r=e.id}["ask","tell","listen"].forEach(function(t){if(void 0!==e[t])throw new Error('Conflict: actor already has a property "'+t+'"')});var i=n&&n.send||"send";if("function"!=typeof e[i])throw new Error('Missing function. Function "'+i+'(to, message)" expected on actor or on params');var o=t.babbler(r),s=n&&n.receive||"receive",a=e.hasOwnProperty(s)?e[s]:null;return e[s]=a?function(t,n){o._receive(n),a.call(e,t,n)}:function(e,t){o._receive(t)},o.send=function(t,n){setTimeout(function(){e[i](t,n)},0)},e.__babbler__={babbler:o,receive:a,receiveName:s},e.ask=o.ask.bind(o),e.tell=o.tell.bind(o),e.listen=o.listen.bind(o),e.listenOnce=o.listenOnce.bind(o),e},t.unbabblify=function(e){var t=e.__babbler__;return t&&(delete e.__babbler__,delete e.ask,delete e.tell,delete e.listen,delete e.listenOnce,delete e[t.receiveName],t.receive&&(e[t.receiveName]=t.receive)),e}},function(e,t,n){function r(e){var t=this;this.peers={},this.addresses={},this.channels={},this.options={reconnectTimeout:3e5,reconnectDelay:1e3,reconnectDecay:2},this.server=null,this.address=null,this.port=null,this.connections={},this.timers={},this.send=function(e,n,r){var i=t.peers[n];return i?(i.emit("message",e,r),u.resolve(null)):t.find(n).then(function(i){var a=t.connections[i];if(a){var c={method:"send",params:{from:e,to:n,message:r}};return a.request(c).catch(function(e){if(0===e.toString().indexOf("Error: Peer not found"))throw delete t.addresses[n],o(n)})}throw s(n,i)})},this.config(e)}function i(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function o(e){return new Error("Peer not found (id: "+e+")")}function s(e,t){return new Error("Peer unreachable (id: "+e+", url: "+t+")")}var a=n(91),c=n(91).Server,u=(n(80),n(41)),l=n(52),h=n(53);r.prototype.config=function(e){if(e&&(i(this.options,e),e.networkId)){if(null===this.networkId)throw new Error("Cannot replace networkId once set");this.networkId=e.networkId}return i({},this.options)},r.prototype.create=function(e){if(e in this.peers)throw new Error("Id already exists (id: "+e+")");var t=new h(e,this.send);return this.peers[e]=t,t},r.prototype.remove=function(e){e instanceof h?delete this.peers[e.id]:e&&delete this.peers[e]},r.prototype.get=function(e){return this.peers[e]||null},r.prototype.find=function(e){var t=this;if(e in t.peers)return u.resolve(t.url||null);var n=t.addresses[e];return n?u.resolve(n):new u(function(n,r){function i(r){var i=t.connections[r];return i.request({method:"find",params:{id:e}}).then(function(r){r&&!s&&(s=!0,t.addresses[e]=r,n(r))})}var s=!1,a=Object.keys(t.connections).map(i);u.all(a).then(function(){s&&0!=a.length||r(o(e))})})},r.prototype.listen=function(e,t){var n=this;return new u(function(r,i){return n.server?void i(new Error("Server already listening")):(n.server=new c({port:t},function(){n.address=e,n.port=t,n.url="ws://"+e+":"+t,r(n)}),n.server.on("connection",function(e){e=l(e),e.onerror=function(){},e.onclose=function(){var t=n._findUrl(e);delete n.connections[t],n.timers[t]=setTimeout(function(){delete n.timers[t],n._forgetPeers(t)},n.options.reconnectTimeout)},e.onrequest=function(t){return n._onRequest(e,t)}}),void n.server.on("error",function(e){i(e)}))})},r.prototype._onRequest=function(e,t){var n,r=this;switch(t.method){case"greeting":n=t.params&&t.params.url;var i=t.params.networkId||null;return null===i||i===r.networkId?!n||n in this.connections?u.resolve({networkId:r.networkId}):(this.connections[n]=e,this._broadcastJoin(n).then(function(){return u.resolve({networkId:r.networkId})})):u.reject(new Error("Network id mismatch ("+i+" !== "+r.networkId+")"));case"join":return n=t.params&&t.params.url,this.join(n).then(function(){return u.resolve()});case"goodbye":return n=this._findUrl(e),this._forgetPeers(n),this._disconnect(n),u.resolve("goodbye");case"hosts":return t.params&&t.params.urls&&this.join(t.params.urls),u.resolve(Object.keys(this.connections));case"find":var s=t.params&&t.params.id;return u.resolve(this.peers[s]?this.url:null);case"send":var a=t.params&&t.params.from,c=t.params&&t.params.to,l=t.params&&t.params.message,h=this.peers[c];return h?(h.emit("message",a,l),u.resolve(null)):u.reject(o(c).toString());case"publish":var f=t.params&&t.params.channel,l=t.params&&t.params.message;return this._publish(f,l),u.resolve({result:null,error:null});case"ping":return u.resolve({result:t.params,error:null});default:return u.reject('Unknown method "'+t.method+'"')}},r.prototype._findUrl=function(e){for(var t in this.connections)if(this.connections.hasOwnProperty(t)&&this.connections[t]===e)return t;return null},r.prototype._forgetPeers=function(e){for(var t in this.addresses)this.addresses.hasOwnProperty(t)&&this.addresses[t]===e&&delete this.addresses[t]},r.prototype.join=function(e){var t=this;return!e||e in t.connections?u.resolve(t):t._connect(e).then(function(){return t._broadcastJoin(e)}).then(function(){return t})},r.prototype._connect=function(e){var t=this;return new u(function(n,r){var i=new a(e);l(i),t.connections[e]=i,i.onrequest=function(e){return t._onRequest(i,e)},i.onclose=function(){t.connections[e]&&(delete t.connections[e],t._reconnect(e))},i.onopen=function(){i.request({method:"greeting",params:{url:t.url,networkId:t.networkId}}).then(function(e){t.networkId=e.networkId,n(i)}).catch(function(n){delete t.connections[e],i.close(),r(n)})},i.onerror=function(n){delete t.connections[e],r(n),i.close()}})},r.prototype._reconnect=function(e){function t(i,o){n.timers[e]=setTimeout(function(){delete n.timers[e];var s=(new Date).valueOf();s-r<n.options.reconnectTimeout?n._connect(e).catch(function(){t(i/n.options.reconnectDecay,o+1)}):n._forgetPeers(e)},i)}var n=this,r=(new Date).valueOf();t(n.options.reconnectDelay,0)},r.prototype._broadcastJoin=function(e){function t(t){var r=n.connections[t];return r.request({method:"join",params:{url:e}}).catch(function(){}).then(function(){return t})}var n=this,r=Object.keys(n.connections).filter(function(t){return t!==e});return u.all(r.map(t))},r.prototype.close=function(){function e(){return t.addresses={},t.server&&(t.server.close(),t.server=null,t.address=null,t.port=null,t.url=null),t}var t=this;if(this.server){var n=Object.keys(this.connections);return u.all(n.map(function(e){return t._disconnect(e)})).then(e)}u.resolve(this)},r.prototype._disconnect=function(e){var t=this.connections[e];return t?(delete this.connections[e],this.timers[e]&&(clearTimeout(this.timers[e]),delete this.timers[e]),t.request({method:"goodbye"}).catch(function(){}).then(function(){t.close()})):void u.resolve()},r.prototype.publish=function(e,t){this._publish(e,t);for(var n in this.connections)if(this.connections.hasOwnProperty(n)){var r=this.connections[n];r.notify({method:"publish",params:{channel:e,message:t}})}},r.prototype._publish=function(e,t){var n=this.channels[e];n&&n.forEach(function(e){e(t)})},r.prototype.subscribe=function(e,t){var n=this.channels[e];n||(n=[],this.channels[e]=n),n.push(t)},r.prototype.unsubscribe=function(e,t){var n=this.channels[e];if(n){var r=n.indexOf(t);-1!==r&&(n.splice(r,1),0===n.length&&delete this.channels[e])}},e.exports=r},function(e,t,n){e.exports=n(93)},function(e,t,n){var r=n(72),i=n(54),o=n(81),s=n(82),a=e.exports=function(e,t){var n=this;n.writable=!0,n.xhr=e,n.body=[],n.uri=(t.protocol||"http:")+"//"+t.host+(t.port?":"+t.port:"")+(t.path||"/"),"undefined"==typeof t.withCredentials&&(t.withCredentials=!0);try{e.withCredentials=t.withCredentials}catch(r){}if(t.responseType)try{e.responseType=t.responseType}catch(r){}if(e.open(t.method||"GET",n.uri,!0),e.onerror=function(){n.emit("error",new Error("Network error"))},n._headers={},t.headers)for(var s=c(t.headers),a=0;a<s.length;a++){var u=s[a];if(n.isSafeRequestHeader(u)){var l=t.headers[u];n.setHeader(u,l)}}t.auth&&this.setHeader("Authorization","Basic "+o.btoa(t.auth));var h=new i;h.on("close",function(){n.emit("close")}),h.on("ready",function(){n.emit("response",h)}),h.on("error",function(e){n.emit("error",e)}),e.onreadystatechange=function(){e.__aborted||h.handle(e)}};s(a,r),a.prototype.setHeader=function(e,t){this._headers[e.toLowerCase()]=t},a.prototype.getHeader=function(e){return this._headers[e.toLowerCase()]},a.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},a.prototype.write=function(e){this.body.push(e)},a.prototype.destroy=function(){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},a.prototype.end=function(e){void 0!==e&&this.body.push(e);for(var t=c(this._headers),n=0;n<t.length;n++){var r=t[n],i=this._headers[r];if(u(i))for(var o=0;o<i.length;o++)this.xhr.setRequestHeader(r,i[o]);else this.xhr.setRequestHeader(r,i)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else if(u(this.body[0])){for(var s=[],n=0;n<this.body.length;n++)s.push.apply(s,this.body[n]);this.xhr.send(s)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){for(var a=0,n=0;n<this.body.length;n++)a+=this.body[n].length;for(var s=new this.body[0].constructor(a),l=0,n=0;n<this.body.length;n++)for(var f=this.body[n],o=0;o<f.length;o++)s[l++]=f[o];this.xhr.send(s)}else if(h(this.body[0]))this.xhr.send(this.body[0]);else{for(var s="",n=0;n<this.body.length;n++)s+=this.body[n].toString();this.xhr.send(s)}},a.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],a.prototype.isSafeRequestHeader=function(e){return e?-1===l(a.unsafeHeaders,e.toLowerCase()):!1};var c=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},u=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},l=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},h=function(e){return"undefined"!=typeof Blob&&e instanceof Blob?!0:"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?!0:"undefined"!=typeof FormData&&e instanceof FormData?!0:void 0}},function(e,t){t.systemNow="function"==typeof Date.now?function(){return Date.now()}:function(){return(new Date).valueOf()},t.shuffle=function(e){for(var t,n,r=e.length;r;t=Math.floor(Math.random()*r),n=e[--r],e[r]=e[t],e[t]=n);return e}},function(e,t,n){(function(t,r){"use strict";var i=n(!function(){var e=new Error('Cannot find module "net"');throw e.code="MODULE_NOT_FOUND",e}()),o=n(!function(){var e=new Error('Cannot find module "tls"');throw e.code="MODULE_NOT_FOUND",e}()),s=n(!function(){var e=new Error('Cannot find module "fs"');throw e.code="MODULE_NOT_FOUND",e}()),a=n(30),c=n(92),u=n(57),l=n(45).EventEmitter,h=n(77),f=n(58),p=n(59),d=p.methods,v=(p.methodTable,p.classes),m=n(60),g=n(61),y=n(62),_=n(!function(){var e=new Error('Cannot find module "../package"');throw e.code="MODULE_NOT_FOUND",e}()).version,b=131072,w={amqp:5672,amqps:5671},k={host:"localhost",port:w.amqp,login:"guest",password:"guest",authMechanism:"AMQPLAIN",vhost:"/",connectionTimeout:1e4,ssl:{enabled:!1}},x={port:w.amqps,ssl:{rejectUnauthorized:!0}},E={defaultExchangeName:"",reconnect:!0,reconnectBackoffStrategy:"linear",reconnectExponentialLimit:12e4,reconnectBackoffTime:1e3},T={version:_,platform:"node-"+t.version,product:"node-amqp"},S=e.exports=function(e,t,n){l.call(this),this.setOptions(e),this.setImplOptions(t),"function"==typeof n&&(this._readyCallback=n),this.connectionAttemptScheduled=!1,this._defaultExchange=null,this.channelCounter=0,this._sendBuffer=new r(b)};h.inherits(S,l),S.prototype.setOptions=function(e){var t=e&&e.url?this._parseURLOptions(e.url):{},n=e&&e.ssl&&e.ssl.enabled?x:{};this.options=c.extend({},k,n,t,e||{}),this.options.clientProperties=c.extend({},T,e&&e.clientProperties||{})},S.prototype.setImplOptions=function(e){this.implOptions=c.extend({},E,e||{})},S.prototype.connect=function(){this.socket||this.addAllListeners(),this._createSocket(),this._startHandshake()},S.prototype.reconnect=function(){for(var e in this.channels)this.channels[e].state="closed";u&&u("Connection lost, reconnecting..."),this.socket&&this.socket.end(),this.connect()},S.prototype.disconnect=function(){u&&u("Sending disconnect request to server"),this._sendMethod(0,d.connectionClose,{replyText:"client disconnect",replyCode:200,classId:0,methodId:0})},S.prototype.addAllListeners=function(){var e=this,t=this.options.ssl.enabled?"secureConnect":"connect";e.addListener(t,function(){e.channels=e.channels||{0:e},e.queues=e.queues||{},e.exchanges=e.exchanges||{},e.parser=new y("0-9-1","client"),e.parser.onMethod=function(t,n,r){e._onMethod(t,n,r)},e.parser.onContent=function(t,n){u&&u(t+" > content "+n.length),e.channels[t]&&e.channels[t]._onContent?e.channels[t]._onContent(t,n):u&&u("unhandled content: "+n)},e.parser.onContentHeader=function(t,n,r,i,o){u&&u(t+" > content header "+JSON.stringify([n.name,r,i,o])),e.channels[t]&&e.channels[t]._onContentHeader?e.channels[t]._onContentHeader(t,n,r,i,o):u&&u("unhandled content header")},e.parser.onHeartBeat=function(){e.emit("heartbeat"),u&&u("heartbeat")},e.parser.onError=function(t){e.emit("error",t),e.emit("close")},e.readyEmitted=!1}),e.addListener("data",function(t){if(null!=e.parser)try{e.parser.execute(t)}catch(n){return void e.emit("error",n)}e._inboundHeartbeatTimerReset()});var n=null;e.addListener("error",function r(){if(null!==e._inboundHeartbeatTimer&&(clearTimeout(e._inboundHeartbeatTimer),e._inboundHeartbeatTimer=null),null!==e._outboundHeartbeatTimer&&(clearTimeout(e._outboundHeartbeatTimer),e._outboundHeartbeatTimer=null),!e.connectionAttemptScheduled){e.connectionAttemptScheduled=!0,e.socket.end(),e.parser=null;for(var t in e.channels)0!==t&&(e.channels[t].state="closed");for(var i in e.queues)for(var o in e.queues[i].consumerTagOptions)e.queues[i].consumerTagOptions[o].state="closed";e.implOptions.reconnect?(null===n?n=e.implOptions.reconnectBackoffTime:"exponential"===e.implOptions.reconnectBackoffStrategy?(n*=2,n>e.implOptions.reconnectExponentialLimit&&(n=e.implOptions.reconnectExponentialLimit)):"linear"===e.implOptions.reconnectBackoffStrategy,setTimeout(function(){e.connectionAttemptScheduled=!1,e.reconnect()},n)):e.removeListener("error",r)}}),e.addListener("ready",function(){n=null,e.implOptions.reconnect&&c.each(e.channels,function(e,t){"0"!==t&&e.reconnect()}),this.readyEmitted=!0,e._outboundHeartbeatTimerReset()}),e.addListener("end",function(){this.readyEmitted||this.emit("error",new Error("Connection ended: possibly due to an authentication failure."))})},S.prototype.heartbeat=function(){this.socket.writable&&this.write(new r([8,0,0,0,0,0,0,206]))},S.prototype.exchange=function(e,t,n){void 0===e&&(e=this.implOptions.defaultExchangeName),t||(t={}),""!==e&&void 0===t.type&&(t.type="topic");try{var r=this.generateChannelId()}catch(i){return void this.emit("error",i)}var o=new m(this,r,e,t,n);return this.channels[r]=o,this.exchanges[e]=o,o},S.prototype.exchangeClosed=function(e){this.exchanges[e]&&delete this.exchanges[e]},S.prototype.queue=function(e){var t,n;"object"==typeof arguments[1]?(t=arguments[1],n=arguments[2]):n=arguments[1];try{var r=this.generateChannelId()}catch(i){return void this.emit("error",i)}var o=new g(this,r,e,t,n);return this.channels[r]=o,o},S.prototype.queueClosed=function(e){this.queues[e]&&delete this.queues[e]},S.prototype.publish=function(e,t,n,r){return this._defaultExchange||(this._defaultExchange=this.exchange()),this._defaultExchange.publish(e,t,n,r)},S.prototype._bodyToBuffer=function(e){if("string"==typeof e)return[null,new r(e,"utf8")];if(e instanceof r)return[null,e];var t=JSON.stringify(e);u&&u("sending json: "+t);var n={contentType:"application/json"};return[n,new r(t,"utf8")]},S.prototype._inboundHeartbeatTimerReset=function(){if(null!==this._inboundHeartbeatTimer&&(clearTimeout(this._inboundHeartbeatTimer),this._inboundHeartbeatTimer=null),this.options.heartbeat){var e=this,t=2*this.options.heartbeat;this._inboundHeartbeatTimer=setTimeout(function(){e.socket.readable&&e.emit("error",new Error("no heartbeat or data in last "+t+" seconds"))},1e3*t)}},S.prototype._outboundHeartbeatTimerReset=function(){if(null!==this._outboundHeartbeatTimer&&(clearTimeout(this._outboundHeartbeatTimer),this._outboundHeartbeatTimer=null),this.socket.writable&&this.options.heartbeat){var e=this;this._outboundHeartbeatTimer=setTimeout(function(){e.heartbeat(),e._outboundHeartbeatTimerReset()},1e3*this.options.heartbeat)}},S.prototype._onMethod=function(e,t,n){if(u&&u(e+" > "+t.name+" "+JSON.stringify(n)),e>0){if(!this.channels[e])return void(u&&u("Received message on untracked channel."));if(!this.channels[e]._onChannelMethod)throw new Error("Channel "+e+" has no _onChannelMethod method.");return void this.channels[e]._onChannelMethod(e,t,n)}switch(t){case d.connectionStart:if(0!==n.versionMajor&&9!=n.versionMinor)return this.socket.end(),void this.emit("error",new Error("Bad server version"));this.serverProperties=n.serverProperties,this._sendMethod(0,d.connectionStartOk,{clientProperties:this.options.clientProperties,mechanism:this.options.authMechanism,response:{LOGIN:this.options.login,PASSWORD:this.options.password},locale:"en_US"});break;case d.connectionTune:n.frameMax&&(u&&u("tweaking maxFrameBuffer to "+n.frameMax),b=n.frameMax),this._sendMethod(0,d.connectionTuneOk,{channelMax:0,frameMax:b,heartbeat:this.options.heartbeat||0}),this._sendMethod(0,d.connectionOpen,{virtualHost:this.options.vhost,reserved1:"",reserved2:!0});break;case d.connectionOpenOk:this._readyCallback&&(this._readyCallback(this),this._readyCallback=null),this.emit("ready");break;case d.connectionClose:var r=new Error(n.replyText);r.code=n.replyCode,this.listeners("close").length||console.log("Unhandled connection error: "+n.replyText),this.socket.destroy(r);break;case d.connectionCloseOk:u&&u("Received close-ok from server, closing socket"),this.socket.end();break;default:throw new Error("Uncaught method '"+t.name+"' with args "+JSON.stringify(n))}},S.prototype._parseURLOptions=function(e){var t={};t.ssl={};var n=a.parse(e),r=n.protocol.substring(0,n.protocol.lastIndexOf(":"));if("amqp"!=r&&"amqps"!=r)throw new Error('Connection URI must use amqp or amqps scheme. For example, "amqp://bus.megacorp.internal:5766".');if(t.ssl.enabled="amqps"===r,t.host=n.hostname,t.port=n.port||w[r],n.auth){var i=n.auth.split(":");i[0]&&(t.login=i[0]),i[1]&&(t.password=i[1])}return n.pathname&&(t.vhost=unescape(n.pathname.substr(1))),t},S.prototype._chooseHost=function(){return Array.isArray(this.options.host)?(this.hosti=null==this.hosti?"number"==typeof this.options.hostPreference?this.options.hostPreference<this.options.host.length?this.options.hostPreference:this.options.host.length-1:parseInt(Math.random()*this.options.host.length,10):(this.hosti+1)%this.options.host.length,this.options.host[this.hosti]):this.options.host},S.prototype._createSocket=function(){var e=this._chooseHost(),t=this,n={port:this.options.port,host:e},r=function(){u&&u("connected so resetting connection timeout"),this.setTimeout(0)};this.options.ssl.enabled?(u&&u("making ssl connection"),n=c.extend(n,this._getSSLOptions()),this.socket=o.connect(n,r)):(u&&u("making non-ssl connection"),this.socket=i.connect(n,r));var s=this.options.connectionTimeout;s&&(u&&u("setting connection timeout to "+s),this.socket.setTimeout(s,function(){u&&u("connection timeout"),this.destroy();var e=new Error("connection timeout");e.name="TimeoutError",t.emit("error",e)}));var a=["close","connect","data","drain","error","end","secureConnect","timeout"];c.each(a,function(e){t.socket.on(e,t.emit.bind(t,e))});var l=["end","destroy","write","pause","resume","setEncoding","ref","unref","address"];c.each(l,function(e){t[e]=function(){t.socket[e].apply(t.socket,arguments)}})},S.prototype._getSSLOptions=function(){return this.sslConnectionOptions?this.sslConnectionOptions:(this.sslConnectionOptions={},this.options.ssl.keyFile&&(this.sslConnectionOptions.key=s.readFileSync(this.options.ssl.keyFile)),this.options.ssl.certFile&&(this.sslConnectionOptions.cert=s.readFileSync(this.options.ssl.certFile)),this.options.ssl.caFile&&(this.sslConnectionOptions.ca=s.readFileSync(this.options.ssl.caFile)),this.sslConnectionOptions.rejectUnauthorized=this.options.ssl.rejectUnauthorized,this.sslConnectionOptions)},S.prototype._startHandshake=function(){u&&u("Initiating handshake..."),this.write("AMQP"+String.fromCharCode(0,0,9,1))},S.prototype._sendBody=function(e,t,n){var i=this._bodyToBuffer(t),o=i[0],s=i[1];n=c.extend(o||{},n),this._sendHeader(e,s.length,n);for(var a=0,u=s.length,l=8,h=b-l;u>0;){var p=h>u?u:h,d=p+l,v=new r(d);v.used=0,v[v.used++]=3,f.serializeInt(v,2,e),f.serializeInt(v,4,p),s.copy(v,v.used,a,a+p),v.used+=p,v[v.used++]=206,this.write(v),u-=p,a+=p}},S.prototype._sendHeader=function(e,t,n){var i=new r(b);i.used=0;var o=v[60];i[i.used++]=2,f.serializeInt(i,2,e);var s=i.used;f.serializeInt(i,4,0);var a=i.used;f.serializeInt(i,2,o.index),f.serializeInt(i,2,0),f.serializeInt(i,8,t),n=c.defaults(n||{},{contentType:"application/octet-stream"});for(var u=0,l=0;l<o.fields.length;l++)n[o.fields[l].name]&&(u|=1<<15-l);f.serializeInt(i,2,u),f.serializeFields(i,o.fields,n,!1);var h=i.used;i.used=s,f.serializeInt(i,4,h-a),i.used=h,i[i.used++]=206;var p=new r(i.used);i.copy(p),this.write(p)},S.prototype._sendMethod=function(e,t,n){u&&u(e+" < "+t.name+" "+JSON.stringify(n));var i=this._sendBuffer;i.used=0,i[i.used++]=1,f.serializeInt(i,2,e);var o=i.used;f.serializeInt(i,4,42);var s=i.used;f.serializeInt(i,2,t.classIndex),f.serializeInt(i,2,t.methodIndex),f.serializeFields(i,t.fields,n,!0);var a=i.used;i.used=o,f.serializeInt(i,4,a-s),i.used=a,i[i.used++]=206;var c=new r(i.used);i.copy(c),u&&u("sending frame: "+c.toJSON()),this.write(c),this._outboundHeartbeatTimerReset()},S.prototype.generateChannelId=function(){for(var e=this.channelCounter;;){if(e=e%65535+1,!this.channels[e])break;if(e==this.channelCounter)throw new Error("No valid Channel Id values available")}return this.channelCounter=e,this.channelCounter}}).call(t,n(78),n(49).Buffer)},function(e){function t(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function r(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=t,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._maxListeners=void 0,t.defaultMaxListeners=10,t.prototype.setMaxListeners=function(e){if(!r(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},t.prototype.emit=function(e){var t,r,s,a,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[e],o(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(s=arguments.length,a=new Array(s-1),c=1;s>c;c++)a[c-1]=arguments[c];r.apply(this,a)}else if(i(r)){for(s=arguments.length,a=new Array(s-1),c=1;s>c;c++)a[c-1]=arguments[c];for(u=r.slice(),s=u.length,c=0;s>c;c++)u[c].apply(this,a)}return!0},t.prototype.addListener=function(e,r){var s;if(!n(r))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(r.listener)?r.listener:r),this._events[e]?i(this._events[e])?this._events[e].push(r):this._events[e]=[this._events[e],r]:this._events[e]=r,i(this._events[e])&&!this._events[e].warned){var s;s=o(this._maxListeners)?t.defaultMaxListeners:this._maxListeners,s&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},t.prototype.removeListener=function(e,t){var r,o,s,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],s=r.length,o=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(a=s;a-->0;)if(r[a]===t||r[a].listener&&r[a].listener===t){o=a;break}if(0>o)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},t.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},t.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},t.listenerCount=function(e,t){var r;return r=e._events&&e._events[t]?n(e._events[t])?1:e._events[t].length:0}},function(e,t,n){"use strict";t.decode=t.parse=n(70),t.encode=t.stringify=n(71)},function(e,t,n){var r=n(29),i=e.exports;for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o]);i.request=function(e,t){return e||(e={}),e.scheme="https",r.request.call(this,e,t)}},function(e,t,n){(function(e){function r(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}function i(e,t){for(var n in e)t(e[n],n)}var o=n(73);t.createHash=n(74),t.createHmac=n(75),t.randomBytes=function(t,n){if(!n||!n.call)return new e(o(t));try{n.call(this,void 0,new e(o(t)))}catch(r){n(r)}},t.getHashes=function(){return["sha1","sha256","sha512","md5","rmd160"]};var s=n(76)(t);t.pbkdf2=s.pbkdf2,t.pbkdf2Sync=s.pbkdf2Sync,i(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman"],function(e){t[e]=function(){r("sorry,",e,"is not implemented yet")}})}).call(t,n(49).Buffer)},function(e,t,n){(function(e){function e(t,n,r){if(!(this instanceof e))return new e(t,n,r);var i,o=typeof t;if("number"===o)i=t>0?t>>>0:0;else if("string"===o)"base64"===n&&(t=k(t)),i=e.byteLength(t,n);else{if("object"!==o||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&I(t.data)&&(t=t.data),i=+t.length>0?Math.floor(+t.length):0}if(this.length>F)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+F.toString(16)+" bytes");var s;e.TYPED_ARRAY_SUPPORT?s=e._augment(new Uint8Array(i)):(s=this,s.length=i,s._isBuffer=!0);var a;if(e.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)s._set(t);else if(E(t))if(e.isBuffer(t))for(a=0;i>a;a++)s[a]=t.readUInt8(a);else for(a=0;i>a;a++)s[a]=(t[a]%256+256)%256;else if("string"===o)s.write(t,0,n);else if("number"===o&&!e.TYPED_ARRAY_SUPPORT&&!r)for(a=0;i>a;a++)s[a]=0;return s}function r(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=t.length;if(o%2!==0)throw new Error("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;r>s;s++){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");e[n+s]=a}return s}function i(e,t,n,r){var i=O(S(t),e,n,r);return i}function o(e,t,n,r){var i=O(C(t),e,n,r);return i}function s(e,t,n,r){return o(e,t,n,r)}function a(e,t,n,r){var i=O(j(t),e,n,r);return i}function c(e,t,n,r){var i=O(A(t),e,n,r);return i}function u(e,t,n){return M.fromByteArray(0===t&&n===e.length?e:e.slice(t,n))}function l(e,t,n){var r="",i="";n=Math.min(e.length,n);for(var o=t;n>o;o++)e[o]<=127?(r+=P(i)+String.fromCharCode(e[o]),i=""):i+="%"+e[o].toString(16);return r+P(i)}function h(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;n>i;i++)r+=String.fromCharCode(e[i]);return r}function f(e,t,n){return h(e,t,n)}function p(e,t,n){var r=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=t;n>o;o++)i+=T(e[o]);return i}function d(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function v(e,t,n){if(e%1!==0||0>e)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function m(t,n,r,i,o,s){if(!e.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(n>o||s>n)throw new TypeError("value is out of bounds");if(r+i>t.length)throw new TypeError("index out of range")}function g(e,t,n,r){0>t&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);o>i;i++)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function y(e,t,n,r){0>t&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);o>i;i++)e[n+i]=t>>>8*(r?i:3-i)&255}function _(e,t,n,r,i,o){if(t>i||o>t)throw new TypeError("value is out of bounds");if(n+r>e.length)throw new TypeError("index out of range")}function b(e,t,n,r,i){return i||_(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),R.write(e,t,n,r,23,4),n+4}function w(e,t,n,r,i){return i||_(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),R.write(e,t,n,r,52,8),n+8}function k(e){for(e=x(e).replace(B,"");e.length%4!==0;)e+="=";return e}function x(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function E(t){return I(t)||e.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function T(e){return 16>e?"0"+e.toString(16):e.toString(16)}function S(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(127>=r)t.push(r);else{var i=n;r>=55296&&57343>=r&&n++;for(var o=encodeURIComponent(e.slice(i,n+1)).substr(1).split("%"),s=0;s<o.length;s++)t.push(parseInt(o[s],16))}}return t}function C(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function A(e){for(var t,n,r,i=[],o=0;o<e.length;o++)t=e.charCodeAt(o),n=t>>8,r=t%256,i.push(r),i.push(n);return i}function j(e){return M.toByteArray(e)}function O(e,t,n,r){for(var i=0;r>i&&!(i+n>=t.length||i>=e.length);i++)t[i+n]=e[i];return i}function P(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
var M=n(101),R=n(95),I=n(96);t.Buffer=e,t.SlowBuffer=e,t.INSPECT_MAX_BYTES=50,e.poolSize=8192;var F=1073741823;e.TYPED_ARRAY_SUPPORT=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(n){return!1}}(),e.isBuffer=function(e){return!(null==e||!e._isBuffer)},e.compare=function(t,n){if(!e.isBuffer(t)||!e.isBuffer(n))throw new TypeError("Arguments must be Buffers");for(var r=t.length,i=n.length,o=0,s=Math.min(r,i);s>o&&t[o]===n[o];o++);return o!==s&&(r=t[o],i=n[o]),i>r?-1:r>i?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,n){if(!I(t))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===t.length)return new e(0);if(1===t.length)return t[0];var r;if(void 0===n)for(n=0,r=0;r<t.length;r++)n+=t[r].length;var i=new e(n),o=0;for(r=0;r<t.length;r++){var s=t[r];s.copy(i,o),o+=s.length}return i},e.byteLength=function(e,t){var n;switch(e+="",t||"utf8"){case"ascii":case"binary":case"raw":n=e.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*e.length;break;case"hex":n=e.length>>>1;break;case"utf8":case"utf-8":n=S(e).length;break;case"base64":n=j(e).length;break;default:n=e.length}return n},e.prototype.length=void 0,e.prototype.parent=void 0,e.prototype.toString=function(e,t,n){var r=!1;if(t>>>=0,n=void 0===n||1/0===n?this.length:n>>>0,e||(e="utf8"),0>t&&(t=0),n>this.length&&(n=this.length),t>=n)return"";for(;;)switch(e){case"hex":return p(this,t,n);case"utf8":case"utf-8":return l(this,t,n);case"ascii":return h(this,t,n);case"binary":return f(this,t,n);case"base64":return u(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return 0===e.compare(this,t)},e.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return e.compare(this,t)},e.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},e.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},e.prototype.write=function(e,t,n,u){if(isFinite(t))isFinite(n)||(u=n,n=void 0);else{var l=u;u=t,t=n,n=l}t=Number(t)||0;var h=this.length-t;n?(n=Number(n),n>h&&(n=h)):n=h,u=String(u||"utf8").toLowerCase();var f;switch(u){case"hex":f=r(this,e,t,n);break;case"utf8":case"utf-8":f=i(this,e,t,n);break;case"ascii":f=o(this,e,t,n);break;case"binary":f=s(this,e,t,n);break;case"base64":f=a(this,e,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":f=c(this,e,t,n);break;default:throw new TypeError("Unknown encoding: "+u)}return f},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},e.prototype.slice=function(t,n){var r=this.length;if(t=~~t,n=void 0===n?r:~~n,0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),0>n?(n+=r,0>n&&(n=0)):n>r&&(n=r),t>n&&(n=t),e.TYPED_ARRAY_SUPPORT)return e._augment(this.subarray(t,n));for(var i=n-t,o=new e(i,void 0,!0),s=0;i>s;s++)o[s]=this[s+t];return o},e.prototype.readUInt8=function(e,t){return t||v(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return t||v(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return t||v(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return t||v(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return t||v(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readInt8=function(e,t){return t||v(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},e.prototype.readInt16LE=function(e,t){t||v(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt16BE=function(e,t){t||v(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt32LE=function(e,t){return t||v(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return t||v(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return t||v(e,4,this.length),R.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return t||v(e,4,this.length),R.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return t||v(e,8,this.length),R.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return t||v(e,8,this.length),R.read(this,e,!1,52,8)},e.prototype.writeUInt8=function(t,n,r){return t=+t,n>>>=0,r||m(this,t,n,1,255,0),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=t,n+1},e.prototype.writeUInt16LE=function(t,n,r){return t=+t,n>>>=0,r||m(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t,this[n+1]=t>>>8):g(this,t,n,!0),n+2},e.prototype.writeUInt16BE=function(t,n,r){return t=+t,n>>>=0,r||m(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=t):g(this,t,n,!1),n+2},e.prototype.writeUInt32LE=function(t,n,r){return t=+t,n>>>=0,r||m(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=t):y(this,t,n,!0),n+4},e.prototype.writeUInt32BE=function(t,n,r){return t=+t,n>>>=0,r||m(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=t):y(this,t,n,!1),n+4},e.prototype.writeInt8=function(t,n,r){return t=+t,n>>>=0,r||m(this,t,n,1,127,-128),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[n]=t,n+1},e.prototype.writeInt16LE=function(t,n,r){return t=+t,n>>>=0,r||m(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=t,this[n+1]=t>>>8):g(this,t,n,!0),n+2},e.prototype.writeInt16BE=function(t,n,r){return t=+t,n>>>=0,r||m(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=t):g(this,t,n,!1),n+2},e.prototype.writeInt32LE=function(t,n,r){return t=+t,n>>>=0,r||m(this,t,n,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[n]=t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):y(this,t,n,!0),n+4},e.prototype.writeInt32BE=function(t,n,r){return t=+t,n>>>=0,r||m(this,t,n,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=t):y(this,t,n,!1),n+4},e.prototype.writeFloatLE=function(e,t,n){return b(this,e,t,!0,n)},e.prototype.writeFloatBE=function(e,t,n){return b(this,e,t,!1,n)},e.prototype.writeDoubleLE=function(e,t,n){return w(this,e,t,!0,n)},e.prototype.writeDoubleBE=function(e,t,n){return w(this,e,t,!1,n)},e.prototype.copy=function(t,n,r,i){var o=this;if(r||(r=0),i||0===i||(i=this.length),n||(n=0),i!==r&&0!==t.length&&0!==o.length){if(r>i)throw new TypeError("sourceEnd < sourceStart");if(0>n||n>=t.length)throw new TypeError("targetStart out of bounds");if(0>r||r>=o.length)throw new TypeError("sourceStart out of bounds");if(0>i||i>o.length)throw new TypeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-n<i-r&&(i=t.length-n+r);var s=i-r;if(100>s||!e.TYPED_ARRAY_SUPPORT)for(var a=0;s>a;a++)t[a+n]=this[a+r];else t._set(this.subarray(r,r+s),n)}},e.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),t>n)throw new TypeError("end < start");if(n!==t&&0!==this.length){if(0>t||t>=this.length)throw new TypeError("start out of bounds");if(0>n||n>this.length)throw new TypeError("end out of bounds");var r;if("number"==typeof e)for(r=t;n>r;r++)this[r]=e;else{var i=S(e.toString()),o=i.length;for(r=t;n>r;r++)this[r]=i[r%o]}return this}},e.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(e.TYPED_ARRAY_SUPPORT)return new e(this).buffer;for(var t=new Uint8Array(this.length),n=0,r=t.length;r>n;n+=1)t[n]=this[n];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var L=e.prototype;e._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=L.get,e.set=L.set,e.write=L.write,e.toString=L.toString,e.toLocaleString=L.toString,e.toJSON=L.toJSON,e.equals=L.equals,e.compare=L.compare,e.copy=L.copy,e.slice=L.slice,e.readUInt8=L.readUInt8,e.readUInt16LE=L.readUInt16LE,e.readUInt16BE=L.readUInt16BE,e.readUInt32LE=L.readUInt32LE,e.readUInt32BE=L.readUInt32BE,e.readInt8=L.readInt8,e.readInt16LE=L.readInt16LE,e.readInt16BE=L.readInt16BE,e.readInt32LE=L.readInt32LE,e.readInt32BE=L.readInt32BE,e.readFloatLE=L.readFloatLE,e.readFloatBE=L.readFloatBE,e.readDoubleLE=L.readDoubleLE,e.readDoubleBE=L.readDoubleBE,e.writeUInt8=L.writeUInt8,e.writeUInt16LE=L.writeUInt16LE,e.writeUInt16BE=L.writeUInt16BE,e.writeUInt32LE=L.writeUInt32LE,e.writeUInt32BE=L.writeUInt32BE,e.writeInt8=L.writeInt8,e.writeInt16LE=L.writeInt16LE,e.writeInt16BE=L.writeInt16BE,e.writeInt32LE=L.writeInt32LE,e.writeInt32BE=L.writeInt32BE,e.writeFloatLE=L.writeFloatLE,e.writeFloatBE=L.writeFloatBE,e.writeDoubleLE=L.writeDoubleLE,e.writeDoubleBE=L.writeDoubleBE,e.fill=L.fill,e.inspect=L.inspect,e.toArrayBuffer=L.toArrayBuffer,e};var B=/[^+\/0-9A-z]/g}).call(t,n(49).Buffer)},function(e,t,n){"use strict";function r(e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(!e)throw new Error("id required");this.id=e,this.listeners=[],this.conversations={},this.connect()}var i=n(80),o=n(105).Promise,s=n(51),a=n(79),c=(n(69),n(66),n(64)),u=n(65);n(68),r.prototype.connect=function(e){if(this.disconnect(),e||(e=s["default"]()),"function"!=typeof e.connect)throw new Error("message bus must contain a function connect(params: {id: string, callback: function}) : string");if("function"!=typeof e.disconnect)throw new Error("message bus must contain a function disconnect(token: string)");if("function"!=typeof e.send)throw new Error("message bus must contain a function send(params: {id: string, message: *})");var t=null,n=new o(function(e){t=e}),r=e.connect({id:this.id,message:this._receive.bind(this),callback:t});return this.disconnect=function(){e.disconnect(r)},this.send=e.send,n},r.prototype._receive=function(e){if(e&&"id"in e&&"message"in e){var t=this,n=e.id,r=this.conversations[n];r&&r.length?r.forEach(function(t){t.deliver(e)}):(r||(r=[]),this.conversations[n]=r,this.listeners.forEach(function(i){var o=new a({id:n,self:t.id,other:e.from,context:{from:e.from},send:t.send});return r.push(o),o.deliver(e),t._process(i,o).then(function(){var e=r.indexOf(o);-1!==e&&r.splice(e,1),0===r.length&&delete t.conversations[n]})}))}},r.prototype.disconnect=function(){},r.prototype.send=function(){throw new Error("Cannot send: not connected")},r.prototype.listen=function(e,t){var n=new u;this.listeners.push(n);var r=n;return e&&(r=r.iif(e)),t&&(r=r.then(t)),r},r.prototype.listenOnce=function(e,t){var n=new u;this.listeners.push(n);var r=this,i=n;return e&&(i=i.iif(e)),i=i.then(function(e){var t=r.listeners.indexOf(n);return-1!==t&&r.listeners.splice(t,1),e}),t&&(i=i.then(t)),i},r.prototype.tell=function(e,t){var n=this,r=i.v4(),o=new a({id:r,self:this.id,other:e,context:{from:e},send:n.send});this.conversations[r]=[o];var s=new c(t);return setTimeout(function(){n._process(s,o).then(function(){delete n.conversations[r]})},0),s},r.prototype.ask=function(e,t,n){return this.tell(e,t).listen(n)},r.prototype._process=function(e,t){return new o(function(n){function r(e,i){e.execute(t,i).then(function(e){e.block?r(e.block,e.result):n(t)})}r(e)})},e.exports=r},function(e,t,n){"use strict";var r=n(105).Promise;t["pubsub-js"]=function(){var e=n(104);return{connect:function(t){var n=e.subscribe(t.id,function(e,n){t.message(n)});return"function"==typeof t.callback&&t.callback(),n},disconnect:function(t){e.unsubscribe(t)},send:function(t,n){e.publish(t,n)}}},t.pubnub=function(e){var t;if("undefined"!=typeof window){if("undefined"==typeof window.PUBNUB)throw new Error("Please load pubnub first in the browser");t=window.PUBNUB}else t=n(100);var i=t.init(e);return{connect:function(e){return i.subscribe({channel:e.id,message:e.message,connect:e.callback}),e.id},disconnect:function(e){i.unsubscribe(e)},send:function(e,t){return new r(function(n){i.publish({channel:e,message:t,callback:n})})}}},t["default"]=t["pubsub-js"]},function(e,t,n){function r(e){return function(){var t={};if("request"in e)throw new Error("Socket already has a request property");var n=e;return e.onmessage=function(r){var i=r.data;if("{"==i.charAt(0)){var o=JSON.parse(i),s=t[o.id];if(s)clearTimeout(s.timeout),delete t[o.id],o.error?s.reject(new Error(o.error)):s.resolve(o.message);else if("id"in o)try{n.onrequest(o.message).then(function(t){var n={id:o.id,message:t,error:null};e.send(JSON.stringify(n))}).catch(function(t){var n={id:o.id,message:null,error:t.message||t.toString()};e.send(JSON.stringify(n))})}catch(a){var c={id:o.id,message:null,error:a.message||a.toString()};e.send(JSON.stringify(c))}else n.onrequest(o.message)}},n.request=function(n){return new o(function(r,o){var a=i.v1(),c={id:a,message:n};t[a]={resolve:r,reject:o,timeout:setTimeout(function(){delete t[a],o(new Error("Timeout"))},s)},e.send(JSON.stringify(c))})},n.notify=function(t){return new o(function(n){var r={message:t};e.send(JSON.stringify(r),function(){n(null)})})},n.onrequest=function(){return o.reject("No onrequest handler implemented")},n}()}var i=n(80),o=n(41),s=6e4;e.exports=r},function(e){function t(e,t){this.id=e,this._send=t,this.listeners={}}t.prototype.send=function(e,t){return this._send(this.id,e,t)},t.prototype.on=function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)},t.prototype.emit=function(e,t,n){var r=this.listeners[e];if(r)for(var i=0,o=r.length;o>i;i++){var s=r[i];s(t,n)}},e.exports=t},function(e,t,n){function r(e){for(var t=e.getAllResponseHeaders().split(/\r?\n/),n={},r=0;r<t.length;r++){var i=t[r];if(""!==i){var o=i.match(/^([^:]+):\s*(.*)/);if(o){var s=o[1].toLowerCase(),a=o[2];void 0!==n[s]?c(n[s])?n[s].push(a):n[s]=[n[s],a]:n[s]=a}else n[i]=!0}}return n}var i=n(72),o=n(77),s=e.exports=function(){this.offset=0,this.readable=!0};o.inherits(s,i);var a={streaming:!0,status2:!0};s.prototype.getResponse=function(e){var t=String(e.responseType).toLowerCase();return"blob"===t?e.responseBlob||e.response:"arraybuffer"===t?e.response:e.responseText},s.prototype.getHeader=function(e){return this.headers[e.toLowerCase()]},s.prototype.handle=function(e){if(2===e.readyState&&a.status2){try{this.statusCode=e.status,this.headers=r(e)}catch(t){a.status2=!1}a.status2&&this.emit("ready")}else if(a.streaming&&3===e.readyState){try{this.statusCode||(this.statusCode=e.status,this.headers=r(e),this.emit("ready"))}catch(t){}try{this._emitData(e)}catch(t){a.streaming=!1}}else 4===e.readyState&&(this.statusCode||(this.statusCode=e.status,this.emit("ready")),this._emitData(e),e.error?this.emit("error",this.getResponse(e)):this.emit("end"),this.emit("close"))},s.prototype._emitData=function(e){var t=this.getResponse(e);return t.toString().match(/ArrayBuffer/)?(this.emit("data",new Uint8Array(t,this.offset)),void(this.offset=t.byteLength)):void(t.length>this.offset&&(this.emit("data",t.slice(this.offset)),this.offset=t.length))};var c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){var r;(function(e,i){!function(o){function s(e){throw RangeError(R[e])}function a(e,t){for(var n=e.length;n--;)e[n]=t(e[n]);return e}function c(e,t){return a(e.split(M),t).join(".")}function u(e){for(var t,n,r=[],i=0,o=e.length;o>i;)t=e.charCodeAt(i++),t>=55296&&56319>=t&&o>i?(n=e.charCodeAt(i++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--)):r.push(t);return r}function l(e){return a(e,function(e){var t="";return e>65535&&(e-=65536,t+=L(e>>>10&1023|55296),e=56320|1023&e),t+=L(e)}).join("")}function h(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:k}function f(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function p(e,t,n){var r=0;for(e=n?F(e/S):e>>1,e+=F(e/t);e>I*E>>1;r+=k)e=F(e/I);return F(r+(I+1)*e/(e+T))}function d(e){var t,n,r,i,o,a,c,u,f,d,v=[],m=e.length,g=0,y=A,_=C;for(n=e.lastIndexOf(j),0>n&&(n=0),r=0;n>r;++r)e.charCodeAt(r)>=128&&s("not-basic"),v.push(e.charCodeAt(r));for(i=n>0?n+1:0;m>i;){for(o=g,a=1,c=k;i>=m&&s("invalid-input"),u=h(e.charCodeAt(i++)),(u>=k||u>F((w-g)/a))&&s("overflow"),g+=u*a,f=_>=c?x:c>=_+E?E:c-_,!(f>u);c+=k)d=k-f,a>F(w/d)&&s("overflow"),a*=d;t=v.length+1,_=p(g-o,t,0==o),F(g/t)>w-y&&s("overflow"),y+=F(g/t),g%=t,v.splice(g++,0,y)}return l(v)}function v(e){var t,n,r,i,o,a,c,l,h,d,v,m,g,y,_,b=[];for(e=u(e),m=e.length,t=A,n=0,o=C,a=0;m>a;++a)v=e[a],128>v&&b.push(L(v));for(r=i=b.length,i&&b.push(j);m>r;){for(c=w,a=0;m>a;++a)v=e[a],v>=t&&c>v&&(c=v);for(g=r+1,c-t>F((w-n)/g)&&s("overflow"),n+=(c-t)*g,t=c,a=0;m>a;++a)if(v=e[a],t>v&&++n>w&&s("overflow"),v==t){for(l=n,h=k;d=o>=h?x:h>=o+E?E:h-o,!(d>l);h+=k)_=l-d,y=k-d,b.push(L(f(d+_%y,0))),l=F(_/y);b.push(L(f(l,0))),o=p(n,g,r==i),n=0,++r}++n,++t}return b.join("")}function m(e){return c(e,function(e){return O.test(e)?d(e.slice(4).toLowerCase()):e})}function g(e){return c(e,function(e){return P.test(e)?"xn--"+v(e):e})}var y="object"==typeof t&&t,_=("object"==typeof e&&e&&e.exports==y&&e,"object"==typeof i&&i);(_.global===_||_.window===_)&&(o=_);var b,w=2147483647,k=36,x=1,E=26,T=38,S=700,C=72,A=128,j="-",O=/^xn--/,P=/[^ -~]/,M=/\x2E|\u3002|\uFF0E|\uFF61/g,R={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=k-x,F=Math.floor,L=String.fromCharCode;b={version:"1.2.4",ucs2:{decode:u,encode:l},decode:d,encode:v,toASCII:g,toUnicode:m},r=function(){return b}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))}(this)}).call(t,n(98)(e),function(){return this}())},function(e,t,n){e.exports=n(90)},function(e,t,n){(function(t){"use strict";var n=t.env.NODE_DEBUG_AMQP;e.exports=n?function(){console.error.apply(null,arguments)}:null}).call(t,n(78))},function(e,t,n){(function(t){"use strict";var r=n(85).jspack,i=e.exports={serializeFloat:function(e,t,n,i){var o=new r(i);switch(t){case 4:for(var s=o.Pack("f",[n]),a=0;a<s.length;++a)e[e.used++]=s[a];break;case 8:for(var s=o.Pack("d",[n]),a=0;a<s.length;++a)e[e.used++]=s[a];break;default:throw new Error("Unknown floating point size")}},serializeInt:function(e,t,n){if(e.used+t>e.length)throw new Error("write out of bounds");switch(t){case 1:e[e.used++]=n;break;case 2:e[e.used++]=(65280&n)>>8,e[e.used++]=(255&n)>>0;break;case 4:e[e.used++]=(4278190080&n)>>24,e[e.used++]=(16711680&n)>>16,e[e.used++]=(65280&n)>>8,e[e.used++]=(255&n)>>0;break;case 8:e[e.used++]=(0xff00000000000000&n)>>56,e[e.used++]=(0xff000000000000&n)>>48,e[e.used++]=(0xff0000000000&n)>>40,e[e.used++]=(0xff00000000&n)>>32,e[e.used++]=(4278190080&n)>>24,e[e.used++]=(16711680&n)>>16,e[e.used++]=(65280&n)>>8,e[e.used++]=(255&n)>>0;break;default:throw new Error("Bad size")}},serializeShortString:function(e,n){if("string"!=typeof n)throw new Error("param must be a string");var r=t.byteLength(n,"utf8");if(r>255)throw new Error("String too long for 'shortstr' parameter");if(1+r+e.used>=e.length)throw new Error("Not enough space in buffer for 'shortstr'");e[e.used++]=r,e.write(n,e.used,"utf8"),e.used+=r},serializeLongString:function(e,n){if("string"==typeof n){var r=t.byteLength(n,"utf8");i.serializeInt(e,4,r),e.write(n,e.used,"utf8"),e.used+=r}else if("object"==typeof n)i.serializeTable(e,n);else{var r=n.length;i.serializeInt(e,4,r),e.write(n,e.used),e.used+=r}},serializeDate:function(e,t){i.serializeInt(e,8,t.valueOf()/1e3)},serializeBuffer:function(e,t){i.serializeInt(e,4,t.length),t.copy(e,e.used,0),e.used+=t.length},serializeBase64:function(e,t){i.serializeLongString(e,t.toString("base64"))},isBigInt:function(e){return e>4294967295},getCode:function(e){var t="0123456789ABCDEF".split(""),n=Math.floor(e/16),r=e-16*n;return t[r]},isFloat:function(e){return e===+e&&e!==(0|e)},serializeValue:function(e,n){switch(typeof n){case"string":e[e.used++]="S".charCodeAt(0),i.serializeLongString(e,n);break;case"number":i.isFloat(n)?(e[e.used++]="d".charCodeAt(0),i.serializeFloat(e,8,n)):i.isBigInt(n)?(e[e.used++]="l".charCodeAt(0),i.serializeInt(e,8,n)):(e[e.used++]="I".charCodeAt(0),i.serializeInt(e,4,n));break;case"boolean":e[e.used++]="t".charCodeAt(0),e[e.used++]=n;break;default:if(n instanceof Date)e[e.used++]="T".charCodeAt(0),i.serializeDate(e,n);else if(n instanceof t)e[e.used++]="x".charCodeAt(0),i.serializeBuffer(e,n);else if(Array.isArray(n))e[e.used++]="A".charCodeAt(0),i.serializeArray(e,n);else{if("object"!=typeof n)throw new Error("unsupported type in amqp table: "+typeof n);e[e.used++]="F".charCodeAt(0),i.serializeTable(e,n)}}},serializeTable:function(e,t){if("object"!=typeof t)throw new Error("param must be an object");var n=e.used;e.used+=4;var r=e.used;for(var o in t)t.hasOwnProperty(o)&&(i.serializeShortString(e,o),i.serializeValue(e,t[o]));var s=e.used;e.used=n,i.serializeInt(e,4,s-r),e.used=s},serializeArray:function(e,t){var n=e.used;e.used+=4;for(var r=e.used,o=t.length,s=0;o>s;s++)i.serializeValue(e,t[s]);var a=e.used;e.used=n,i.serializeInt(e,4,a-r),e.used=a},serializeFields:function(e,t,n,r){for(var o=0,s=0,a=0;a<t.length;a++){var c=t[a],u=c.domain;if(c.name in n){var l=n[c.name];switch(u){case"bit":if("boolean"!=typeof l)throw new Error("Unmatched field "+JSON.stringify(c));l&&(o|=1<<s),s++,t[a+1]&&"bit"==t[a+1].domain||(e[e.used++]=o,o=0,s=0);break;case"octet":if("number"!=typeof l||l>255)throw new Error("Unmatched field "+JSON.stringify(c));e[e.used++]=l;break;case"short":if("number"!=typeof l||l>65535)throw new Error("Unmatched field "+JSON.stringify(c));i.serializeInt(e,2,l);break;case"long":if("number"!=typeof l||l>4294967295)throw new Error("Unmatched field "+JSON.stringify(c));i.serializeInt(e,4,l);break;case"timestamp":i.serializeInt(e,8,l);break;case"longlong":for(var h=0;8>h;h++)e[e.used++]=l[h];break;case"shortstr":if("string"!=typeof l||l.length>255)throw new Error("Unmatched field "+JSON.stringify(c));i.serializeShortString(e,l);break;case"longstr":i.serializeLongString(e,l);break;case"table":if("object"!=typeof l)throw new Error("Unmatched field "+JSON.stringify(c));i.serializeTable(e,l);break;default:throw new Error("Unknown domain value type "+u)}}else if(r)throw new Error("Missing field '"+c.name+"' of type '"+u+"' while executing AMQP method '"+arguments.callee.caller.arguments[1].name+"'")}}}}).call(t,n(49).Buffer)},function(e,t,n){"use strict";var r=n(84),i={},o={},s={};!function(){for(var e=0;e<r.classes.length;e++){var t=r.classes[e];s[t.index]=t;for(var n=0;n<t.methods.length;n++){var a=t.methods[n],c=t.name+a.name[0].toUpperCase()+a.name.slice(1),u={name:c,fields:a.fields,methodIndex:a.index,classIndex:t.index};i[t.index]||(i[t.index]={}),i[t.index][a.index]=u,o[c]=u}}}(),e.exports={methods:o,classes:s,methodTable:i}},function(e,t,n){"use strict";function r(e){return function(t){if(e.options.confirm)for(var n in e._unAcked){var r=e._unAcked[n];r.emit("ack error",t),delete e._unAcked[n]}}}var i=(n(45),n(77)),o=(n(!function(){var e=new Error('Cannot find module "net"');throw e.code="MODULE_NOT_FOUND",e}()),n(!function(){var e=new Error('Cannot find module "tls"');throw e.code="MODULE_NOT_FOUND",e}()),n(!function(){var e=new Error('Cannot find module "fs"');throw e.code="MODULE_NOT_FOUND",e}()),n(92)),s=n(59).methods,a=n(86),c=e.exports=function(e,t,n,r,i){a.call(this,e,t),this.name=n,this.binds=0,this.exchangeBinds=0,this.sourceExchanges={},this.options=o.defaults(r||{},{autoDelete:!0}),this._openCallback=i,this._sequence=null,this._unAcked={},this._addedExchangeErrorHandler=!1};i.inherits(c,a),c.prototype._onMethod=function(e,t,n){if(this.emit(t.name,n),this._handleTaskReply.apply(this,arguments))return!0;var r;switch(t){case s.channelOpenOk:/^$|(amq\.)/.test(this.name)?(this.state="open",this._openCallback&&(this._openCallback(this),this._openCallback=null),this.emit("open")):this.options.noDeclare?(this.state="open",this._openCallback&&(this._openCallback(this),this._openCallback=null),this.emit("open")):(this.connection._sendMethod(e,s.exchangeDeclare,{reserved1:0,reserved2:!1,reserved3:!1,exchange:this.name,type:this.options.type||"topic",passive:!!this.options.passive,durable:!!this.options.durable,autoDelete:!!this.options.autoDelete,internal:!!this.options.internal,noWait:!1,arguments:this.options.arguments||{}}),this.state="declaring");break;case s.exchangeDeclareOk:this.options.confirm?this.connection._sendMethod(e,s.confirmSelect,{noWait:!1}):(this.state="open",this.emit("open"),this._openCallback&&(this._openCallback(this),this._openCallback=null));break;case s.confirmSelectOk:this._sequence=1,this.state="open",this.emit("open"),this._openCallback&&(this._openCallback(this),this._openCallback=null);break;case s.channelClose:this.state="closed",this.closeOK(),this.connection.exchangeClosed(this.name);var i=new Error(n.replyText);i.code=n.replyCode,this.emit("error",i),this.emit("close");break;case s.channelCloseOk:this.connection.exchangeClosed(this.name),this.emit("close");break;case s.basicAck:this.emit("basic-ack",n);var o,a=n.deliveryTag.readUInt32BE(4);if(0===a&&n.multiple===!0)for(o in this._unAcked)this._unAcked[o].emit("ack"),delete this._unAcked[o];else if(0!==a&&n.multiple===!0)for(o in this._unAcked)a>=o&&(this._unAcked[o].emit("ack"),delete this._unAcked[o]);else this._unAcked[a]&&n.multiple===!1&&(this._unAcked[a].emit("ack"),delete this._unAcked[a]);break;case s.basicReturn:this.emit("basic-return",n);break;case s.exchangeBindOk:this._bindCallback&&(r=this._bindCallback,this._bindCallback=null,r(this));break;case s.exchangeUnbindOk:this._unbindCallback&&(r=this._unbindCallback,this._unbindCallback=null,r(this));break;default:throw new Error("Uncaught method '"+t.name+"' with args "+JSON.stringify(n))}this._tasksFlush()},c.prototype.publish=function(e,t,n,r){var i=this;n=o.extend({},n||{}),n.routingKey=e,n.exchange=i.name,n.mandatory=n.mandatory?!0:!1,n.immediate=n.immediate?!0:!1,n.reserved1=0;var a=this._taskPush(null,function(){i.connection._sendMethod(i.channel,s.basicPublish,n),i.connection._sendBody(i.channel,t,n)});return i.options.confirm&&i._awaitConfirm(a,r),a},c.prototype._awaitConfirm=function(e,t){this._addedExchangeErrorHandler||(this.on("error",r(this)),this._addedExchangeErrorHandler=!0),e.sequence=this._sequence,this._unAcked[this._sequence]=e,this._sequence++,"function"==typeof t&&(e.once("ack error",function(n){e.removeAllListeners(),t(!0,n)}),e.once("ack",function(){e.removeAllListeners(),t(!1)}))},c.prototype.cleanup=function(){0===this.binds&&this.connection.exchangeClosed(this.name)},c.prototype.destroy=function(e){var t=this;return this._taskPush(s.exchangeDeleteOk,function(){t.connection.exchangeClosed(t.name),t.connection._sendMethod(t.channel,s.exchangeDelete,{reserved1:0,exchange:t.name,ifUnused:e?!0:!1,noWait:!1})})},c.prototype.unbind=function(){var e=this,t=arguments[0],n=arguments[1],r=arguments[2];return r&&(this._unbindCallback=r),this._taskPush(s.exchangeUnbindOk,function(){var r=t instanceof c?t.name:t,i=e.name;r in e.connection.exchanges&&(delete e.sourceExchanges[r],e.connection.exchanges[r].exchangeBinds--),e.connection._sendMethod(e.channel,s.exchangeUnbind,{reserved1:0,destination:i,source:r,routingKey:n,noWait:!1,arguments:{}})})},c.prototype.bind=function(){var e=this,t=arguments[0],n=arguments[1],r=arguments[2];r&&(this._bindCallback=r);var i=t instanceof c?t.name:t,o=e.name;i in e.connection.exchanges&&(e.sourceExchanges[i]=e.connection.exchanges[i],e.connection.exchanges[i].exchangeBinds++),e.connection._sendMethod(e.channel,s.exchangeBind,{reserved1:0,destination:o,source:i,routingKey:n,noWait:!1,arguments:{}})},c.prototype.bind_headers=function(){var e=this,t=arguments[0],n=arguments[1],r=arguments[2];r&&(this._bindCallback=r);var i=t instanceof c?t.name:t,o=e.name;i in e.connection.exchanges&&(e.sourceExchanges[i]=e.connection.exchanges[i],e.connection.exchanges[i].exchangeBinds++),e.connection._sendMethod(e.channel,s.exchangeBind,{reserved1:0,destination:o,source:i,routingKey:"",noWait:!1,arguments:n})}},function(e,t,n){(function(t,r){"use strict";var i=n(77),o=(n(!function(){var e=new Error('Cannot find module "fs"');throw e.code="MODULE_NOT_FOUND",e}()),n(92)),s=n(86),a=n(60),c=n(87),u=n(57),l=n(59),h=l.methods,f=l.classes,p=e.exports=function(e,t,n,r,i){s.call(this,e,t);var a=this;this.name=n,this._bindings={},this.consumerTagListeners={},this.consumerTagOptions={},this.on("rawMessage",function(e){e.consumerTag&&a.consumerTagListeners[e.consumerTag]&&a.consumerTagListeners[e.consumerTag](e)}),this.options={autoDelete:!0,closeChannelOnUnsubscribe:!1},o.extend(this.options,r||{}),this._openCallback=i};i.inherits(p,s),p.prototype.subscribeRaw=function(e,n){var r=this;"function"==typeof e&&(n=e,e={});var i="node-amqp-"+t.pid+"-"+Math.random();return this.consumerTagListeners[i]=n,e=e||{},e.state="opening",this.consumerTagOptions[i]=e,void 0!==e.prefetchCount&&r.connection._sendMethod(r.channel,h.basicQos,{reserved1:0,prefetchSize:0,prefetchCount:e.prefetchCount,global:!1}),this._taskPush(h.basicConsumeOk,function(){r.connection._sendMethod(r.channel,h.basicConsume,{reserved1:0,queue:r.name,consumerTag:i,noLocal:!!e.noLocal,noAck:!!e.noAck,exclusive:!!e.exclusive,noWait:!1,arguments:{}}),r.consumerTagOptions[i].state="open"})},p.prototype.unsubscribe=function(e){var t=this;return this._taskPush(h.basicCancelOk,function(){t.connection._sendMethod(t.channel,h.basicCancel,{reserved1:0,consumerTag:e,noWait:!1})}).addCallback(function(){t.options.closeChannelOnUnsubscribe&&t.close(),delete t.consumerTagListeners[e],delete t.consumerTagOptions[e]})},p.prototype.subscribe=function(e,t){var n=this;"function"==typeof e&&(t=e,e={}),e=o.defaults(e||{},{ack:!1,prefetchCount:1,routingKeyInPayload:n.connection.options.routingKeyInPayload,deliveryTagInPayload:n.connection.options.deliveryTagInPayload});var i={noAck:!e.ack,exclusive:e.exclusive};return e.ack&&(i.prefetchCount=e.prefetchCount),this.subscribeRaw(i,function(i){var o=i.contentType;null==o&&i.headers&&i.headers.properties&&(o=i.headers.properties.content_type);var s,a="text/json"==o||"application/json"==o;a?s="":(s=new r(i.size),s.used=0),n._lastMessage=i,i.addListener("data",function(e){a?s+=e.toString():(e.copy(s,s.used),s.used+=e.length)}),i.addListener("end",function(){var o,c,u,l={},h=f[60].fields;if(a)try{o=JSON.parse(s)}catch(p){o=null,l.parseError=p,l.rawData=s}else o={data:s,contentType:i.contentType};for(c=0,u=h.length;u>c;c++)i[h[c].name]&&(l[h[c].name]=i[h[c].name]);l.queue=i.queue?i.queue.name:null,l.deliveryTag=i.deliveryTag,l.redelivered=i.redelivered,l.exchange=i.exchange,l.routingKey=i.routingKey,l.consumerTag=i.consumerTag,e.routingKeyInPayload&&(o._routingKey=i.routingKey),e.deliveryTagInPayload&&(o._deliveryTag=i.deliveryTag);var d={};for(c in this.headers)this.headers.hasOwnProperty(c)&&(d[c]=this.headers[c]instanceof r?this.headers[c].toString():this.headers[c]);t&&t(o,d,l,i),n.emit("message",o,d,l,i)})})},p.prototype.subscribeJSON=p.prototype.subscribe,p.prototype.shift=function(e,t){this._lastMessage&&(e?this._lastMessage.reject(t?!0:!1):this._lastMessage.acknowledge())},p.prototype.bind=function(e,t,n){var r=this;(void 0===t||o.isFunction(t))&&(n=t,t=e,e="amq.topic"),o.isFunction(n)&&(this._bindCallback=n);var i=e instanceof a?e.name:e;i in r.connection.exchanges&&(this.exchange=r.connection.exchanges[i],this.exchange.binds++),this._bindings[i]||(this._bindings[i]={}),this._bindings[i][t]||(this._bindings[i][t]=0),this._bindings[i][t]++,r.connection._sendMethod(r.channel,h.queueBind,{reserved1:0,queue:r.name,exchange:i,routingKey:t,noWait:!1,arguments:{}})
},p.prototype.unbind=function(e,t){var n=this;void 0===t&&(t=e,e="amq.topic");var r=e instanceof a?e.name:e;return this._bindings[r][t]--,this._bindings[r][t]||delete this._bindings[r][t],o.keys(this._bindings[r]).length||delete this._bindings[r],this._taskPush(h.queueUnbindOk,function(){n.connection._sendMethod(n.channel,h.queueUnbind,{reserved1:0,queue:n.name,exchange:r,routingKey:t,noWait:!1,arguments:{}})})},p.prototype.bind_headers=function(){var e,t,n=this;return 2==arguments.length?(e=arguments[0],t=arguments[1]):(e="amq.headers",t=arguments[0]),this._taskPush(h.queueBindOk,function(){var r=e instanceof a?e.name:e;n.connection._sendMethod(n.channel,h.queueBind,{reserved1:0,queue:n.name,exchange:r,routingKey:"",noWait:!1,arguments:t})})},p.prototype.unbind_headers=function(){var e,t,n=this;return 2===arguments.length?(e=arguments[0],t=arguments[1]):(e="amq.headers",t=arguments[0]),this._taskPush(h.queueUnbindOk,function(){var r=e instanceof a?e.name:e;n.connection._sendMethod(n.channel,h.queueUnbind,{reserved1:0,queue:n.name,exchange:r,routingKey:"",noWait:!1,arguments:t})})},p.prototype.destroy=function(e){var t=this;return e=e||{},this._taskPush(h.queueDeleteOk,function(){t.connection.queueClosed(t.name),"exchange"in t&&(t.exchange.binds--,t.exchange.cleanup()),t.connection._sendMethod(t.channel,h.queueDelete,{reserved1:0,queue:t.name,ifUnused:e.ifUnused?!0:!1,ifEmpty:e.ifEmpty?!0:!1,noWait:!1,arguments:{}})})},p.prototype.purge=function(){var e=this;return this._taskPush(h.queuePurgeOk,function(){e.connection._sendMethod(e.channel,h.queuePurge,{reserved1:0,queue:e.name,noWait:!1})})},p.prototype._onMethod=function(e,t,n){var r=this;if(this.emit(t.name,n),!this._handleTaskReply.apply(this,arguments)){switch(t){case h.channelOpenOk:this.options.noDeclare?(this.state="open",this._openCallback&&(this._openCallback(this),this._openCallback=null),this.emit("open")):(0==this.name.indexOf("amq.")&&(this.name=""),this.connection._sendMethod(e,h.queueDeclare,{reserved1:0,queue:this.name,passive:!!this.options.passive,durable:!!this.options.durable,exclusive:!!this.options.exclusive,autoDelete:!!this.options.autoDelete,noWait:!1,arguments:this.options.arguments||{}}),this.state="declare queue");break;case h.queueDeclareOk:this.state="open",this.name=n.queue,this.connection.queues[this.name]=this,o.each(this._bindings,function(e,t){o.each(e,function(e,n){r.bind(t,n)})}),this._openCallback&&(this._openCallback(this,n.messageCount,n.consumerCount),this._openCallback=null),this.emit("open",n.queue,n.messageCount,n.consumerCount);var s=Object.keys(this.consumerTagListeners);for(var a in s)s.hasOwnProperty(a)&&"closed"===this.consumerTagOptions[s[a]].state&&(this.subscribeRaw(this.consumerTagOptions[s[a]],this.consumerTagListeners[s[a]]),delete this.consumerTagListeners[s[a]],delete this.consumerTagOptions[s[a]]);break;case h.basicConsumeOk:u&&u("basicConsumeOk",i.inspect(n,null));break;case h.queueBindOk:if(this._bindCallback){var l=this._bindCallback;this._bindCallback=null,l(this)}break;case h.queueUnbindOk:break;case h.basicQosOk:break;case h.confirmSelectOk:this._sequence=1,this.confirm=!0;break;case h.channelClose:this.state="closed",this.closeOK(),this.connection.queueClosed(this.name);var f=new Error(n.replyText);f.code=n.replyCode,this.emit("error",f),this.emit("close");break;case h.channelCloseOk:this.connection.queueClosed(this.name),this.emit("close");break;case h.basicDeliver:this.currentMessage=new c(this,n);break;case h.queueDeleteOk:break;case h.basicCancel:this.close("Closed due to basicCancel received on consumer ("+n.consumerTag+")");break;default:throw new Error("Uncaught method '"+t.name+"' with args "+JSON.stringify(n)+"; tasks = "+JSON.stringify(this._tasks))}this._tasksFlush()}},p.prototype._onContentHeader=function(e,t,n,r,i){o.extend(this.currentMessage,r),this.currentMessage.read=0,this.currentMessage.size=i,this.emit("rawMessage",this.currentMessage),0===i&&this.currentMessage.emit("end")},p.prototype._onContent=function(e,t){this.currentMessage.read+=t.length,this.currentMessage.emit("data",t),this.currentMessage.read==this.currentMessage.size&&this.currentMessage.emit("end")},p.prototype.flow=function(e){var t=this;return this._taskPush(h.channelFlowOk,function(){t.connection._sendMethod(t.channel,h.channelFlow,{active:e})})}}).call(t,n(78),n(49).Buffer)},function(e,t,n){(function(t){"use strict";function r(e,t){switch(t){case 1:return e[e.read++];case 2:return(e[e.read++]<<8)+e[e.read++];case 4:return(e[e.read++]<<24)+(e[e.read++]<<16)+(e[e.read++]<<8)+e[e.read++];case 8:return(e[e.read++]<<56)+(e[e.read++]<<48)+(e[e.read++]<<40)+(e[e.read++]<<32)+(e[e.read++]<<24)+(e[e.read++]<<16)+(e[e.read++]<<8)+e[e.read++];default:throw new Error("cannot parse ints of that size")}}function i(e){var t=e[e.read++],n=e.toString("utf8",e.read,e.read+t);return e.read+=t,n}function o(e){var t=r(e,4),n=e.slice(e.read,e.read+t);return e.read+=t,n.toString()}function s(e){switch(e[e.read++]){case h.STRING:return o(e);case h.INTEGER:return r(e,4);case h.DECIMAL:var n=r(e,1),i=r(e,4);return i/(10*n);case h._64BIT_FLOAT:for(var c=[],u=0;8>u;++u)c[u]=e[e.read++];return new l(!0).Unpack("d",c);case h._32BIT_FLOAT:for(var c=[],u=0;4>u;++u)c[u]=e[e.read++];return new l(!0).Unpack("f",c);case h.TIME:var f=r(e,8);return(new Date).setTime(1e3*f);case h.HASH:return a(e);case h.SIGNED_64BIT:return r(e,8);case h.BOOLEAN:return r(e,1)>0;case h.BYTE_ARRAY:var p=r(e,4),d=new t(p);return e.copy(d,0,e.read,e.read+p),e.read+=p,d;case h.ARRAY:for(var p=r(e,4),v=e.read+p,m=[];e.read<v;)m.push(s(e));return m;default:throw new Error("Unknown field value type "+e[e.read-1])}}function a(e){for(var t=e.read+r(e,4),n={};e.read<t;)n[i(e)]=s(e);return n}function c(e,n){for(var s,c={},u=0,l=0;l<n.length;l++){var h=n[l];switch(h.domain){case"bit":s=e[e.read]&1<<u?!0:!1,n[l+1]&&"bit"==n[l+1].domain?u++:(u=0,e.read++);break;case"octet":s=e[e.read++];break;case"short":s=r(e,2);break;case"long":s=r(e,4);break;case"timestamp":s=r(e,8);break;case"longlong":s=new t(8);for(var f=0;8>f;f++)s[f]=e[e.read++];break;case"shortstr":s=i(e);break;case"longstr":s=o(e);break;case"table":s=a(e);break;default:throw new Error("Unhandled parameter type "+h.domain)}c[h.name]=s}return c}var u=(n(45),n(77),n(!function(){var e=new Error('Cannot find module "net"');throw e.code="MODULE_NOT_FOUND",e}()),n(!function(){var e=new Error('Cannot find module "tls"');throw e.code="MODULE_NOT_FOUND",e}()),n(!function(){var e=new Error('Cannot find module "fs"');throw e.code="MODULE_NOT_FOUND",e}()),n(57)),l=n(85).jspack,h=n(88).AMQPTypes,f=n(88).Indicators,p=n(88).FrameType,d=n(59),v=d.methodTable,m=d.classes,g=131072,y=e.exports=function(e,n){function i(e){var n=a,s=n.length-n.used;if(e.copy(n,n.used,0,e.length),n.used+=e.length,n.used>=n.length){n.read=0,l=n[n.read++],h=r(n,2);var u=r(n,4);return n.used=0,u>g&&d.throwError("Oversized frame "+u),c=new t(u),c.used=0,o(e.slice(s))}return i}function o(e){var t=c,n=t.length-t.used,r=t.length>e.length?e.length:t.length;return e.copy(t,t.used,0,r),t.used+=e.length,e.length>n?s(e.slice(n)):e.length==n?s:o}function s(e){if(!(e.length>0))return s;if(e[0]===f.FRAME_END){switch(l){case p.METHOD:d._parseMethodFrame(h,c);break;case p.HEADER:d._parseHeaderFrame(h,c);break;case p.BODY:d.onContent&&d.onContent(h,c);break;case p.HEARTBEAT:u&&u("heartbeat"),d.onHeartBeat&&d.onHeartBeat();break;default:d.throwError("Unhandled frame type "+l)}return i(e.slice(1))}d.throwError("Missing frame end marker")}this.isClient="client"==n,this.state=this.isClient?"frameHeader":"protocolHeader","0-9-1"!=e&&this.throwError("Unsupported protocol version");var a=new t(7);a.used=0;var c,l,h,d=this;d.parse=i};y.prototype.throwError=function(e){if(!this.onError)throw new Error(e);this.onError(e)},y.prototype.execute=function(e){u&&u("execute: "+e.toString("hex")),this.parse=this.parse(e)},y.prototype._parseMethodFrame=function(e,t){t.read=0;var n=r(t,2),i=r(t,2);v[n]&&v[n][i]||this.throwError("Received unknown [classId, methodId] pair ["+n+", "+i+"]");var o=v[n][i];o||this.throwError("bad method?");var s=c(t,o.fields);this.onMethod&&(u&&u("Executing method",e,o,s),this.onMethod(e,o,s))},y.prototype._parseHeaderFrame=function(e,t){t.read=0;var n=r(t,2),i=r(t,2),o=r(t,8),s=m[n];s.fields.length>15&&this.throwError("TODO: support more than 15 properties");for(var a=r(t,2),u=[],l=0;l<s.fields.length;l++){var h=s.fields[l];a&1<<15-l&&u.push(h)}var f=c(t,u);this.onContentHeader&&this.onContentHeader(e,s,i,f,o)}}).call(t,n(49).Buffer)},,function(e,t,n){"use strict";function r(e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.message=e}var i=n(105).Promise,o=n(69),s=n(89).isPromise;n(66),n(65),r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.execute=function(e,t){var n,r=this;if("function"==typeof this.message){var o=this.message(t,e.context);n=s(o)?o:i.resolve(o)}else n=i.resolve(this.message);return n.then(function(t){var n=e.send(t),o=s(n)?n:i.resolve(n);return o.then(function(){return{result:t,block:r.next}})})},o.prototype.tell=function(e){var t=new r(e);return this.then(t)},o.prototype.ask=function(e,t){return this.tell(e).listen(t)},e.exports=r},function(e,t,n){"use strict";function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator")}{var i=(n(105).Promise,n(69));n(66)}r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.execute=function(e){var t=this;return e.receive().then(function(e){return{result:e,block:t.next}})},i.prototype.listen=function(e){var t=new r,n=this.then(t);return e&&(n=n.then(e)),n},e.exports=r},function(e,t,n){"use strict";function r(e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if("function"!=typeof e)throw new TypeError("Parameter callback must be a Function");this.callback=e}var i=n(105).Promise,o=n(69),s=n(89).isPromise;r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.execute=function(e,t){var n=this,r=this.callback(t,e.context),o=s(r)?r:i.resolve(r);return o.then(function(e){return{result:e,block:n.next}})},o.prototype.then=function(e){if("function"==typeof e&&(e=new r(e)),!(e instanceof o))throw new TypeError("Parameter next must be a Block or function");return e.previous=this,this.next=e,e},e.exports=r},function(e,t,n){"use strict";function r(e,t){var n,i;if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if("function"==typeof e?(n=e,i=t):(n=null,i=e),n){if("function"!=typeof n)throw new TypeError("Parameter decision must be a function")}else n=function(e){return e};if(i&&i instanceof Function)throw new TypeError("Parameter choices must be an object");if(this.decision=n,this.choices={},i){var o=this;Object.keys(i).forEach(function(e){o.addChoice(e,i[e])})}}var i=n(105).Promise,o=n(69),s=n(89).isPromise;n(66),r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.execute=function(e,t){var n=this,r=this.decision(t,e.context),o=s(r)?r:i.resolve(r);return o.then(function(e){var r=n.choices[e];if(r||(r=n.choices["default"]),!r)throw new Error('Block with id "'+e+'" not found');return{result:t,block:r}})},r.prototype.addChoice=function(e,t){if("string"!=typeof e)throw new TypeError("String expected as choice id");if(!(t instanceof o))throw new TypeError("Block expected as choice");if(e in this.choices)throw new Error('Choice with id "'+e+'" already exists');for(var n=t;n&&n.previous;)n=n.previous;return this.choices[e]=n,this},o.prototype.decide=function(e,t){var n=new r(e,t);return this.then(n)},e.exports=r},function(e,t,n){"use strict";function r(e,t,n){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(this.condition=e instanceof Function?e:e instanceof RegExp?function(t){return e.test(t)}:function(t){return t==e},t&&!(t instanceof o))throw new TypeError("Parameter trueBlock must be a Block");if(n&&!(n instanceof o))throw new TypeError("Parameter falseBlock must be a Block");this.trueBlock=t||null,this.falseBlock=n||null}var i=n(105).Promise,o=n(69),s=n(89).isPromise;n(66),r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.execute=function(e,t){var n=this,r=this.condition(t,e.context),o=s(r)?r:i.resolve(r);return o.then(function(e){var r=e?n.trueBlock||n.next:n.falseBlock;return{result:t,block:r}})},o.prototype.iif=function(e,t,n){var i=new r(e,t,n);return this.then(i)},e.exports=r},function(e){"use strict";function t(){this.next=null,this.previous=null}t.prototype.execute=function(){throw new Error("Cannot run an abstract Block")},e.exports=t},function(e){"use strict";function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,r,i,o){r=r||"&",i=i||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(r);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var l=0;u>l;++l){var h,f,p,d,v=e[l].replace(a,"%20"),m=v.indexOf(i);m>=0?(h=v.substr(0,m),f=v.substr(m+1)):(h=v,f=""),p=decodeURIComponent(h),d=decodeURIComponent(f),t(s,p)?n(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e){"use strict";function t(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,o,s,a){return o=o||"&",s=s||"=",null===e&&(e=void 0),"object"==typeof e?t(i(e),function(i){var a=encodeURIComponent(n(i))+s;return r(e[i])?t(e[i],function(e){return a+encodeURIComponent(n(e))}).join(o):a+encodeURIComponent(n(e[i]))}).join(o):a?encodeURIComponent(n(a))+s+encodeURIComponent(n(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){function r(){i.call(this)}e.exports=r;var i=n(45).EventEmitter,o=n(109);o(r,i),r.Readable=n(110),r.Writable=n(111),r.Duplex=n(112),r.Transform=n(113),r.PassThrough=n(114),r.Stream=r,r.prototype.pipe=function(e,t){function n(t){e.writable&&!1===e.write(t)&&u.pause&&u.pause()}function r(){u.readable&&u.resume&&u.resume()}function o(){l||(l=!0,e.end())}function s(){l||(l=!0,"function"==typeof e.destroy&&e.destroy())}function a(e){if(c(),0===i.listenerCount(this,"error"))throw e}function c(){u.removeListener("data",n),e.removeListener("drain",r),u.removeListener("end",o),u.removeListener("close",s),u.removeListener("error",a),e.removeListener("error",a),u.removeListener("end",c),u.removeListener("close",c),e.removeListener("close",c)}var u=this;u.on("data",n),e.on("drain",r),e._isStdio||t&&t.end===!1||(u.on("end",o),u.on("close",s));var l=!1;return u.on("error",a),e.on("error",a),u.on("end",c),u.on("close",c),e.on("close",c),e.emit("pipe",u),e}},function(e,t,n){(function(t,r){!function(){var i=("undefined"==typeof window?t:window)||{};_crypto=i.crypto||i.msCrypto||n(94),e.exports=function(e){if(_crypto.getRandomValues){var t=new r(e);return _crypto.getRandomValues(t),t}if(_crypto.randomBytes)return _crypto.randomBytes(e);throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}}()}).call(t,function(){return this}(),n(49).Buffer)},function(e,t,n){(function(t){function r(e){return function(){var n=[],r={update:function(e,r){return t.isBuffer(e)||(e=new t(e,r)),n.push(e),this},digest:function(r){var i=t.concat(n),o=e(i);return n=null,r?o.toString(r):o}};return r}}var i=n(107),o=r(n(97)),s=r(n(117));e.exports=function(e){return"md5"===e?new o:"rmd160"===e?new s:i(e)}}).call(t,n(49).Buffer)},function(e,t,n){(function(t){function r(e,n){if(!(this instanceof r))return new r(e,n);this._opad=c,this._alg=e;var s="sha512"===e?128:64;n=this._key=t.isBuffer(n)?n:new t(n),n.length>s?n=i(e).update(n).digest():n.length<s&&(n=t.concat([n,o],s));for(var a=this._ipad=new t(s),c=this._opad=new t(s),u=0;s>u;u++)a[u]=54^n[u],c[u]=92^n[u];this._hash=i(e).update(a)}var i=n(74),o=new t(128);o.fill(0),e.exports=r,r.prototype.update=function(e,t){return this._hash.update(e,t),this},r.prototype.digest=function(e){var t=this._hash.digest();return i(this._alg).update(this._opad).update(t).digest(e)}}).call(t,n(49).Buffer)},function(e,t,n){var r=n(115);e.exports=function(e,t){t=t||{};var n=r(e);return t.pbkdf2=n.pbkdf2,t.pbkdf2Sync=n.pbkdf2Sync,t}},function(e,t,n){(function(e,r){function i(e,n){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(n)?r.showHidden=n:n&&t._extend(r,n),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),c(r,e,r.depth)}function o(e,t){var n=i.styles[t];return n?"["+i.colors[n][0]+"m"+e+"["+i.colors[n][1]+"m":e}function s(e){return e}function a(e){var t={};return e.forEach(function(e){t[e]=!0}),t}function c(e,n,r){if(e.customInspect&&n&&S(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return _(i)||(i=c(e,i,r)),i}var o=u(e,n);if(o)return o;var s=Object.keys(n),v=a(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),T(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(n);if(0===s.length){if(S(n)){var m=n.name?": "+n.name:"";return e.stylize("[Function"+m+"]","special")}if(k(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return e.stylize(Date.prototype.toString.call(n),"date");if(T(n))return l(n)}var g="",y=!1,b=["{","}"];if(d(n)&&(y=!0,b=["[","]"]),S(n)){var w=n.name?": "+n.name:"";g=" [Function"+w+"]"}if(k(n)&&(g=" "+RegExp.prototype.toString.call(n)),E(n)&&(g=" "+Date.prototype.toUTCString.call(n)),T(n)&&(g=" "+l(n)),0===s.length&&(!y||0==n.length))return b[0]+g+b[1];if(0>r)return k(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");e.seen.push(n);var x;return x=y?h(e,n,r,v,s):s.map(function(t){return f(e,n,r,v,t,y)}),e.seen.pop(),p(x,g,b)}function u(e,t){if(w(t))return e.stylize("undefined","undefined");if(_(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return y(t)?e.stylize(""+t,"number"):v(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,n,r,i){for(var o=[],s=0,a=t.length;a>s;++s)o.push(P(t,String(s))?f(e,t,n,r,String(s),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(f(e,t,n,r,i,!0))}),o}function f(e,t,n,r,i,o){var s,a,u;if(u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},u.get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),P(r,i)||(s="["+i+"]"),a||(e.seen.indexOf(u.value)<0?(a=m(n)?c(e,u.value,null):c(e,u.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n"))):a=e.stylize("[Circular]","special")),w(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function p(e,t,n){var r=0,i=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function d(e){return Array.isArray(e)}function v(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return null==e}function y(e){return"number"==typeof e}function _(e){return"string"==typeof e}function b(e){return"symbol"==typeof e}function w(e){return void 0===e}function k(e){return x(e)&&"[object RegExp]"===A(e)}function x(e){return"object"==typeof e&&null!==e}function E(e){return x(e)&&"[object Date]"===A(e)}function T(e){return x(e)&&("[object Error]"===A(e)||e instanceof Error)}function S(e){return"function"==typeof e}function C(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function A(e){return Object.prototype.toString.call(e)}function j(e){return 10>e?"0"+e.toString(10):e.toString(10)}function O(){var e=new Date,t=[j(e.getHours()),j(e.getMinutes()),j(e.getSeconds())].join(":");return[e.getDate(),F[e.getMonth()],t].join(" ")}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var M=/%[sdj%]/g;t.format=function(e){if(!_(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,o=r.length,s=String(e).replace(M,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),a=r[n];o>n;a=r[++n])s+=m(a)||!x(a)?" "+a:" "+i(a);return s},t.deprecate=function(n,i){function o(){if(!s){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),s=!0}return n.apply(this,arguments)}if(w(e.process))return function(){return t.deprecate(n,i).apply(this,arguments)};if(r.noDeprecation===!0)return n;var s=!1;return o};var R,I={};t.debuglog=function(e){if(w(R)&&(R=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!I[e])if(new RegExp("\\b"+e+"\\b","i").test(R)){var n=r.pid;I[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else I[e]=function(){};return I[e]},t.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=v,t.isNull=m,t.isNullOrUndefined=g,t.isNumber=y,t.isString=_,t.isSymbol=b,t.isUndefined=w,t.isRegExp=k,t.isObject=x,t.isDate=E,t.isError=T,t.isFunction=S,t.isPrimitive=C,t.isBuffer=n(103);var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",O(),t.format.apply(t,arguments))},t.inherits=n(116),t._extend=function(e,t){if(!t||!x(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(t,function(){return this}(),n(78))},function(e){function t(){}var n=e.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.on=t,n.addListener=t,n.once=t,n.off=t,n.removeListener=t,n.removeAllListeners=t,n.emit=t,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},function(e,t,n){function r(e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.id=e&&e.id||i.v4(),this.self=e&&e.self||null,this.other=e&&e.other||null,this.context=e&&e.context||{},this._send=e&&e.send||null,this._inbox=[],this._receivers=[]}var i=n(80),o=n(105).Promise;r.prototype.send=function(e){return this._send(this.other,{id:this.id,from:this.self,to:this.other,message:e})},r.prototype.deliver=function(e){if(this._receivers.length){var t=this._receivers.shift();t(e.message)}else this._inbox.push(e.message)},r.prototype.receive=function(){var e=this;return this._inbox.length?o.resolve(this._inbox.shift()):new o(function(t){e._receivers.push(t)})},e.exports=r},function(e,t,n){var r;(function(i){(function(){function o(e,t,n){var r=t&&n||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>i&&(t[r+i++]=g[e])});16>i;)t[r+i++]=0;return t}function s(e,t){var n=t||0,r=m;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function a(e,t,n){var r=t&&n||0,i=t||[];e=e||{};var o=null!=e.clockseq?e.clockseq:w,a=null!=e.msecs?e.msecs:(new Date).getTime(),c=null!=e.nsecs?e.nsecs:x+1,u=a-k+(c-x)/1e4;if(0>u&&null==e.clockseq&&(o=o+1&16383),(0>u||a>k)&&null==e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");k=a,x=c,w=o,a+=122192928e5;var l=(1e4*(268435455&a)+c)%4294967296;i[r++]=l>>>24&255,i[r++]=l>>>16&255,i[r++]=l>>>8&255,i[r++]=255&l;var h=a/4294967296*1e4&268435455;i[r++]=h>>>8&255,i[r++]=255&h,i[r++]=h>>>24&15|16,i[r++]=h>>>16&255,i[r++]=o>>>8|128,i[r++]=255&o;for(var f=e.node||b,p=0;6>p;p++)i[r+p]=f[p];return t?t:s(i)}function c(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new v(16):null,e=null),e=e||{};var i=e.random||(e.rng||u)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;16>o;o++)t[r+o]=i[o];return t||s(i)}var u,l=this;try{var h=n(48).randomBytes;u=h&&function(){return h(16)}}catch(f){}if(!u&&l.crypto&&crypto.getRandomValues){var p=new Uint8Array(16);u=function(){return crypto.getRandomValues(p),p}}if(!u){var d=new Array(16);u=function(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),d[t]=e>>>((3&t)<<3)&255;return d}}for(var v="function"==typeof i?i:Array,m=[],g={},y=0;256>y;y++)m[y]=(y+256).toString(16).substr(1),g[m[y]]=y;var _=u(),b=[1|_[0],_[1],_[2],_[3],_[4],_[5]],w=16383&(_[6]<<8|_[7]),k=0,x=0,E=c;E.v1=a,E.v4=c,E.parse=o,E.unparse=s,E.BufferClass=v;r=function(){return E}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))}).call(this)}).call(t,n(49).Buffer)},function(e,t){!function(){function e(e){this.message=e}var n=t,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error,e.prototype.name="InvalidCharacterError",n.btoa||(n.btoa=function(t){for(var n,i,o=0,s=r,a="";t.charAt(0|o)||(s="=",o%1);a+=s.charAt(63&n>>8-o%1*8)){if(i=t.charCodeAt(o+=.75),i>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");n=n<<8|i}return a}),n.atob||(n.atob=function(t){if(t=t.replace(/=+$/,""),t.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,i,o=0,s=0,a="";i=t.charAt(s++);~i&&(n=o%4?64*n+i:i,o++%4)?a+=String.fromCharCode(255&n>>(-2*o&6)):0)i=r.indexOf(i);return a})}()},function(e){e.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){(function(t){function n(){for(;i.next;){i=i.next;var e=i.task;i.task=void 0;var t=i.domain;t&&(i.domain=void 0,t.enter());try{e()}catch(r){if(c)throw t&&t.exit(),setTimeout(n,0),t&&t.enter(),r;setTimeout(function(){throw r},0)}t&&t.exit()}s=!1}function r(e){o=o.next={task:e,domain:c&&t.domain,next:null},s||(s=!0,a())}var i={task:void 0,next:null},o=i,s=!1,a=void 0,c=!1;if("undefined"!=typeof t&&t.nextTick)c=!0,a=function(){t.nextTick(n)};else if("function"==typeof setImmediate)a="undefined"!=typeof window?setImmediate.bind(window,n):function(){setImmediate(n)};else if("undefined"!=typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=n,a=function(){u.port2.postMessage(0)}}else a=function(){setTimeout(n,0)};e.exports=r}).call(t,n(78))},function(e,t){t.constants=[[1,"frameMethod"],[2,"frameHeader"],[3,"frameBody"],[8,"frameHeartbeat"],[200,"replySuccess"],[206,"frameEnd"],[311,"contentTooLarge"],[313,"noConsumers"],[320,"connectionForced"],[402,"invalidPath"],[403,"accessRefused"],[404,"notFound"],[405,"resourceLocked"],[406,"preconditionFailed"],[501,"frameError"],[502,"syntaxError"],[503,"commandInvalid"],[504,"channelError"],[505,"unexpectedFrame"],[506,"resourceError"],[530,"notAllowed"],[540,"notImplemented"],[541,"internalError"],[4096,"frameMinSize"]],t.classes=[{name:"connection",index:10,fields:[],methods:[{name:"start",index:10,fields:[{name:"versionMajor",domain:"octet"},{name:"versionMinor",domain:"octet"},{name:"serverProperties",domain:"table"},{name:"mechanisms",domain:"longstr"},{name:"locales",domain:"longstr"}]},{name:"startOk",index:11,fields:[{name:"clientProperties",domain:"table"},{name:"mechanism",domain:"shortstr"},{name:"response",domain:"longstr"},{name:"locale",domain:"shortstr"}]},{name:"secure",index:20,fields:[{name:"challenge",domain:"longstr"}]},{name:"secureOk",index:21,fields:[{name:"response",domain:"longstr"}]},{name:"tune",index:30,fields:[{name:"channelMax",domain:"short"},{name:"frameMax",domain:"long"},{name:"heartbeat",domain:"short"}]},{name:"tuneOk",index:31,fields:[{name:"channelMax",domain:"short"},{name:"frameMax",domain:"long"},{name:"heartbeat",domain:"short"}]},{name:"open",index:40,fields:[{name:"virtualHost",domain:"shortstr"},{name:"reserved1",domain:"shortstr"},{name:"reserved2",domain:"bit"}]},{name:"openOk",index:41,fields:[{name:"reserved1",domain:"shortstr"}]},{name:"close",index:50,fields:[{name:"replyCode",domain:"short"},{name:"replyText",domain:"shortstr"},{name:"classId",domain:"short"},{name:"methodId",domain:"short"}]},{name:"closeOk",index:51,fields:[]}]},{name:"channel",index:20,fields:[],methods:[{name:"open",index:10,fields:[{name:"reserved1",domain:"shortstr"}]},{name:"openOk",index:11,fields:[{name:"reserved1",domain:"longstr"}]},{name:"flow",index:20,fields:[{name:"active",domain:"bit"}]},{name:"flowOk",index:21,fields:[{name:"active",domain:"bit"}]},{name:"close",index:40,fields:[{name:"replyCode",domain:"short"},{name:"replyText",domain:"shortstr"},{name:"classId",domain:"short"},{name:"methodId",domain:"short"}]},{name:"closeOk",index:41,fields:[]}]},{name:"exchange",index:40,fields:[],methods:[{name:"declare",index:10,fields:[{name:"reserved1",domain:"short"},{name:"exchange",domain:"shortstr"},{name:"type",domain:"shortstr"},{name:"passive",domain:"bit"},{name:"durable",domain:"bit"},{name:"autoDelete",domain:"bit"},{name:"reserved2",domain:"bit"},{name:"reserved3",domain:"bit"},{name:"noWait",domain:"bit"},{name:"arguments",domain:"table"}]},{name:"declareOk",index:11,fields:[]},{name:"delete",index:20,fields:[{name:"reserved1",domain:"short"},{name:"exchange",domain:"shortstr"},{name:"ifUnused",domain:"bit"},{name:"noWait",domain:"bit"}]},{name:"deleteOk",index:21,fields:[]},{name:"bind",index:30,fields:[{name:"reserved1",domain:"short"},{name:"destination",domain:"shortstr"},{name:"source",domain:"shortstr"},{name:"routingKey",domain:"shortstr"},{name:"noWait",domain:"bit"},{name:"arguments",domain:"table"}]},{name:"bindOk",index:31,fields:[]},{name:"unbind",index:40,fields:[{name:"reserved1",domain:"short"},{name:"destination",domain:"shortstr"},{name:"source",domain:"shortstr"},{name:"routingKey",domain:"shortstr"},{name:"noWait",domain:"bit"},{name:"arguments",domain:"table"}]},{name:"unbindOk",index:51,fields:[]}]},{name:"queue",index:50,fields:[],methods:[{name:"declare",index:10,fields:[{name:"reserved1",domain:"short"},{name:"queue",domain:"shortstr"},{name:"passive",domain:"bit"},{name:"durable",domain:"bit"},{name:"exclusive",domain:"bit"},{name:"autoDelete",domain:"bit"},{name:"noWait",domain:"bit"},{name:"arguments",domain:"table"}]},{name:"declareOk",index:11,fields:[{name:"queue",domain:"shortstr"},{name:"messageCount",domain:"long"},{name:"consumerCount",domain:"long"}]},{name:"bind",index:20,fields:[{name:"reserved1",domain:"short"},{name:"queue",domain:"shortstr"},{name:"exchange",domain:"shortstr"},{name:"routingKey",domain:"shortstr"},{name:"noWait",domain:"bit"},{name:"arguments",domain:"table"}]},{name:"bindOk",index:21,fields:[]},{name:"unbind",index:50,fields:[{name:"reserved1",domain:"short"},{name:"queue",domain:"shortstr"},{name:"exchange",domain:"shortstr"},{name:"routingKey",domain:"shortstr"},{name:"arguments",domain:"table"}]},{name:"unbindOk",index:51,fields:[]},{name:"purge",index:30,fields:[{name:"reserved1",domain:"short"},{name:"queue",domain:"shortstr"},{name:"noWait",domain:"bit"}]},{name:"purgeOk",index:31,fields:[{name:"messageCount",domain:"long"}]},{name:"delete",index:40,fields:[{name:"reserved1",domain:"short"},{name:"queue",domain:"shortstr"},{name:"ifUnused",domain:"bit"},{name:"ifEmpty",domain:"bit"},{name:"noWait",domain:"bit"}]},{name:"deleteOk",index:41,fields:[{name:"messageCount",domain:"long"}]}]},{name:"basic",index:60,fields:[{name:"contentType",domain:"shortstr"},{name:"contentEncoding",domain:"shortstr"},{name:"headers",domain:"table"},{name:"deliveryMode",domain:"octet"},{name:"priority",domain:"octet"},{name:"correlationId",domain:"shortstr"},{name:"replyTo",domain:"shortstr"},{name:"expiration",domain:"shortstr"},{name:"messageId",domain:"shortstr"},{name:"timestamp",domain:"timestamp"},{name:"type",domain:"shortstr"},{name:"userId",domain:"shortstr"},{name:"appId",domain:"shortstr"},{name:"reserved",domain:"shortstr"}],methods:[{name:"qos",index:10,fields:[{name:"prefetchSize",domain:"long"},{name:"prefetchCount",domain:"short"},{name:"global",domain:"bit"}]},{name:"qosOk",index:11,fields:[]},{name:"consume",index:20,fields:[{name:"reserved1",domain:"short"},{name:"queue",domain:"shortstr"},{name:"consumerTag",domain:"shortstr"},{name:"noLocal",domain:"bit"},{name:"noAck",domain:"bit"},{name:"exclusive",domain:"bit"},{name:"noWait",domain:"bit"},{name:"arguments",domain:"table"}]},{name:"consumeOk",index:21,fields:[{name:"consumerTag",domain:"shortstr"}]},{name:"cancel",index:30,fields:[{name:"consumerTag",domain:"shortstr"},{name:"noWait",domain:"bit"}]},{name:"cancelOk",index:31,fields:[{name:"consumerTag",domain:"shortstr"}]},{name:"publish",index:40,fields:[{name:"reserved1",domain:"short"},{name:"exchange",domain:"shortstr"},{name:"routingKey",domain:"shortstr"},{name:"mandatory",domain:"bit"},{name:"immediate",domain:"bit"}]},{name:"return",index:50,fields:[{name:"replyCode",domain:"short"},{name:"replyText",domain:"shortstr"},{name:"exchange",domain:"shortstr"},{name:"routingKey",domain:"shortstr"}]},{name:"deliver",index:60,fields:[{name:"consumerTag",domain:"shortstr"},{name:"deliveryTag",domain:"longlong"},{name:"redelivered",domain:"bit"},{name:"exchange",domain:"shortstr"},{name:"routingKey",domain:"shortstr"}]},{name:"get",index:70,fields:[{name:"reserved1",domain:"short"},{name:"queue",domain:"shortstr"},{name:"noAck",domain:"bit"}]},{name:"getOk",index:71,fields:[{name:"deliveryTag",domain:"longlong"},{name:"redelivered",domain:"bit"},{name:"exchange",domain:"shortstr"},{name:"routingKey",domain:"shortstr"},{name:"messageCount",domain:"long"}]},{name:"getEmpty",index:72,fields:[{name:"reserved1",domain:"shortstr"}]},{name:"ack",index:80,fields:[{name:"deliveryTag",domain:"longlong"},{name:"multiple",domain:"bit"}]},{name:"reject",index:90,fields:[{name:"deliveryTag",domain:"longlong"},{name:"requeue",domain:"bit"}]},{name:"recoverAsync",index:100,fields:[{name:"requeue",domain:"bit"}]},{name:"recover",index:110,fields:[{name:"requeue",domain:"bit"}]},{name:"recoverOk",index:111,fields:[]}]},{name:"tx",index:90,fields:[],methods:[{name:"select",index:10,fields:[]},{name:"selectOk",index:11,fields:[]},{name:"commit",index:20,fields:[]},{name:"commitOk",index:21,fields:[]},{name:"rollback",index:30,fields:[]},{name:"rollbackOk",index:31,fields:[]}]},{name:"confirm",index:85,fields:[],methods:[{name:"select",index:10,fields:[{name:"noWait",domain:"bit"}]},{name:"selectOk",index:11,fields:[]}]}]
},function(e,t){t.jspack=function(e){this.bigEndian=e},t.jspack.prototype._DeArray=function(e,t,n){return[e.slice(t,t+n)]},t.jspack.prototype._EnArray=function(e,t,n,r){for(var i=0;n>i;++i)e[t+i]=r[i]?r[i]:0},t.jspack.prototype._DeChar=function(e,t){return String.fromCharCode(e[t])},t.jspack.prototype._EnChar=function(e,t,n){e[t]=n.charCodeAt(0)},t.jspack.prototype._DeInt=function(e,t){for(var n,r=bigEndian?format.len-1:0,i=bigEndian?-1:1,o=r+i*format.len,s=r,a=1;s!=o;)n+=e[t+s]*a,s+=i,a*=256;return format.signed&&0!=(n&Math.pow(2,8*format.len-1))&&(n-=Math.pow(2,8*format.len)),n},t.jspack.prototype._EnInt=function(e,t,n){var r=bigEndian?format.len-1:0,i=bigEndian?-1:1,o=r+i*format.len;n=n<format.min?format.min:n>format.max?format.max:n;for(var s=r;s!=o;)e[t+s]=255&n,s+=i,n>>=8},t.jspack.prototype._DeString=function(e,t,n){var r=new Array(1);for(i=0;n>i;i++)r[i]=String.fromCharCode(e[t+i]);return r.join("")},t.jspack.prototype._EnString=function(e,t,n,r){for(var i,o=0;n>o;++o)i=r.charCodeAt(o),i||(i=0),e[t+o]=i},t.jspack.prototype._De754=function(e,t){var n,r,i,o,s,a,c,u,l,h;for(c=format.bit,u=8*format.len-format.bit-1,h=(1<<u)-1,l=h>>1,o=bigEndian?0:format.len-1,s=bigEndian?1:-1,n=e[t+o],o+=s,a=-7,r=n&(1<<-a)-1,n>>=-a,a+=u;a>0;a-=8)r=256*r+e[t+o],o+=s;for(i=r&(1<<-a)-1,r>>=-a,a+=c;a>0;a-=8)i=256*i+e[t+o],o+=s;switch(r){case 0:r=1-l;break;case h:return i?0/0:1/0*(n?-1:1);default:i+=Math.pow(2,c),r-=l}return(n?-1:1)*i*Math.pow(2,r-c)},t.jspack.prototype._En754=function(e,t,n){var r,i,o,s,a,c,u,l,h,f;for(u=format.bit,l=8*format.len-format.bit-1,f=(1<<l)-1,h=f>>1,r=0>n?1:0,n=Math.abs(n),isNaN(n)||1/0==n?(o=isNaN(n)?1:0,i=f):(i=Math.floor(Math.log(n)/Math.LN2),c=Math.pow(2,-i),1>n*c&&(i--,c=2*c),n+=i+h>=1?format.rt/c:format.rt*Math.pow(2,1-h),n*c>=2&&(i++,c/=2),i+h>=f?(o=0,i=f):i+h>=1?(o=(n*c-1)*Math.pow(2,u),i+=h):(o=n*Math.pow(2,h-1)*Math.pow(2,u),i=0)),s=bigEndian?format.len-1:0,a=bigEndian?-1:1;u>=8;)e[t+s]=255&o,s+=a,o/=256,u-=8;for(i=i<<u|o,l+=u;l>0;l-=8)e[t+s]=255&i,s+=a,i/=256;e[t+s-a]|=128*r},t.jspack.prototype._UnpackSeries=function(e,t,n,r){for(var i=format.de,o=[],s=0;e>s;s++)o.push(i(n,r+s*t));return o},t.jspack.prototype._PackSeries=function(e,t,n,r,i,s){var a=format.en;for(o=0;e>o;o++)a(n,r+o*t,i[s+o])},t.jspack.prototype.Unpack=function(e,t,n){bigEndian="<"!=e.charAt(0),(void 0==n||null==n)&&(n=0);for(var r,i=new RegExp(this._sPattern,"g"),o=[];r=i.exec(e);){var s;s=void 0==r[1]||""==r[1]?1:parseInt(r[1]);var a=this._lenLut[r[2]];if(n+s*a>t.length)return void 0;switch(r[2]){case"A":case"s":rv.push(this._formatLut[r[2]].de(t,n,s));break;case"c":case"b":case"B":case"h":case"H":case"i":case"I":case"l":case"L":case"f":case"d":format=this._formatLut[r[2]],o.push(this._UnpackSeries(s,a,t,n))}n+=s*a}return Array.prototype.concat.apply([],o)},t.jspack.prototype.PackTo=function(e,t,n,r){bigEndian="<"!=e.charAt(0);for(var i,o=new RegExp(this._sPattern,"g"),s=0;i=o.exec(e);){var a;a=void 0==i[1]||""==i[1]?1:parseInt(i[1]);var c=this._lenLut[i[2]];if(n+a*c>t.length)return!1;switch(i[2]){case"A":case"s":if(s+1>r.length)return!1;this._formatLut[i[2]].en(t,n,a,r[s]),s+=1;break;case"c":case"b":case"B":case"h":case"H":case"i":case"I":case"l":case"L":case"f":case"d":if(format=this._formatLut[i[2]],s+a>r.length)return!1;this._PackSeries(a,c,t,n,r,s),s+=a;break;case"x":for(var u=0;a>u;u++)t[n+u]=0}n+=a*c}return t},t.jspack.prototype.Pack=function(e,t){return this.PackTo(e,new Array(this.CalcLength(e)),0,t)},t.jspack.prototype.CalcLength=function(e){for(var t=new RegExp(this._sPattern,"g"),n=0;match=t.exec(e);){var r;r=void 0==match[1]||""==match[1]?1:parseInt(match[1]),n+=r*this._lenLut[match[2]]}return n},t.jspack.prototype._sPattern="(\\d+)?([AxcbBhHsfdiIlL])",t.jspack.prototype._lenLut={A:1,x:1,c:1,b:1,B:1,h:2,H:2,s:1,f:4,d:8,i:4,I:4,l:4,L:4},t.jspack.prototype._formatLut={A:{en:t.jspack.prototype._EnArray,de:t.jspack.prototype._DeArray},s:{en:t.jspack.prototype._EnString,de:t.jspack.prototype._DeString},c:{en:t.jspack.prototype._EnChar,de:t.jspack.prototype._DeChar},b:{en:t.jspack.prototype._EnInt,de:t.jspack.prototype._DeInt,len:1,signed:!0,min:-Math.pow(2,7),max:Math.pow(2,7)-1},B:{en:t.jspack.prototype._EnInt,de:t.jspack.prototype._DeInt,len:1,signed:!1,min:0,max:Math.pow(2,8)-1},h:{en:t.jspack.prototype._EnInt,de:t.jspack.prototype._DeInt,len:2,signed:!0,min:-Math.pow(2,15),max:Math.pow(2,15)-1},H:{en:t.jspack.prototype._EnInt,de:t.jspack.prototype._DeInt,len:2,signed:!1,min:0,max:Math.pow(2,16)-1},i:{en:t.jspack.prototype._EnInt,de:t.jspack.prototype._DeInt,len:4,signed:!0,min:-Math.pow(2,31),max:Math.pow(2,31)-1},I:{en:t.jspack.prototype._EnInt,de:t.jspack.prototype._DeInt,len:4,signed:!1,min:0,max:Math.pow(2,32)-1},l:{en:t.jspack.prototype._EnInt,de:t.jspack.prototype._DeInt,len:4,signed:!0,min:-Math.pow(2,31),max:Math.pow(2,31)-1},L:{en:t.jspack.prototype._EnInt,de:t.jspack.prototype._DeInt,len:4,signed:!1,min:0,max:Math.pow(2,32)-1},f:{en:t.jspack.prototype._En754,de:t.jspack.prototype._De754,len:4,bit:23,rt:Math.pow(2,-24)-Math.pow(2,-77)},d:{en:t.jspack.prototype._En754,de:t.jspack.prototype._De754,len:8,bit:52,rt:0}}},function(e,t,n){"use strict";var r=n(45),i=n(77),o=(n(!function(){var e=new Error('Cannot find module "fs"');throw e.code="MODULE_NOT_FOUND",e}()),n(99).Promise),s=n(59),a=s.methods,c=e.exports=function(e,t){r.EventEmitter.call(this),this.setMaxListeners(0),this.channel=t,this.connection=e,this._tasks=[],this.reconnect()};i.inherits(c,r.EventEmitter),c.prototype.closeOK=function(){this.connection._sendMethod(this.channel,a.channelCloseOk,{reserved1:""})},c.prototype.reconnect=function(){this.connection._sendMethod(this.channel,a.channelOpen,{reserved1:""})},c.prototype._taskPush=function(e,t){var n=new o;return this._tasks.push({promise:n,reply:e,sent:!1,cb:t}),this._tasksFlush(),n},c.prototype._tasksFlush=function(){if("open"==this.state)for(var e=0;e<this._tasks.length;e++){var t=this._tasks[e];t.sent||(t.cb(),t.sent=!0,t.reply||(this._tasks.splice(e,1),e-=1))}},c.prototype._handleTaskReply=function(e,t,n){var r,i;for(i=0;i<this._tasks.length;i++)if(this._tasks[i].reply==t)return r=this._tasks[i],this._tasks.splice(i,1),r.promise.emitSuccess(n),this._tasksFlush(),!0;return!1},c.prototype._onChannelMethod=function(e,t,n){switch(t){case a.channelCloseOk:delete this.connection.channels[this.channel],this.state="closed";default:this._onMethod(e,t,n)}},c.prototype.close=function(e){this.state="closing",this.connection._sendMethod(this.channel,a.channelClose,{replyText:e?e:"Goodbye from node",replyCode:200,classId:0,methodId:0})}},function(e,t,n){"use strict";var r=n(45),i=n(77),o=(n(!function(){var e=new Error('Cannot find module "fs"');throw e.code="MODULE_NOT_FOUND",e}()),n(59)),s=e.exports=function(e,t){var n=o.classes[60].fields;r.EventEmitter.call(this),this.queue=e,this.deliveryTag=t.deliveryTag,this.redelivered=t.redelivered,this.exchange=t.exchange,this.routingKey=t.routingKey,this.consumerTag=t.consumerTag;for(var i=0,s=n.length;s>i;i++)t[n[i].name]&&(this[n[i].name]=t[n[i].name])};i.inherits(s,r.EventEmitter),s.prototype.acknowledge=function(e){this.queue.connection._sendMethod(this.queue.channel,o.methods.basicAck,{reserved1:0,deliveryTag:this.deliveryTag,multiple:e?!0:!1})},s.prototype.reject=function(e){this.queue.connection._sendMethod(this.queue.channel,o.methods.basicReject,{deliveryTag:this.deliveryTag,requeue:e?!0:!1})}},function(e){e.exports={AMQPTypes:Object.freeze({STRING:"S".charCodeAt(0),INTEGER:"I".charCodeAt(0),HASH:"F".charCodeAt(0),TIME:"T".charCodeAt(0),DECIMAL:"D".charCodeAt(0),BOOLEAN:"t".charCodeAt(0),SIGNED_8BIT:"b".charCodeAt(0),SIGNED_16BIT:"s".charCodeAt(0),SIGNED_64BIT:"l".charCodeAt(0),_32BIT_FLOAT:"f".charCodeAt(0),_64BIT_FLOAT:"d".charCodeAt(0),VOID:"v".charCodeAt(0),BYTE_ARRAY:"x".charCodeAt(0),ARRAY:"A".charCodeAt(0),TEN:"10".charCodeAt(0),BOOLEAN_TRUE:"",BOOLEAN_FALSE:"\x00"}),Indicators:Object.freeze({FRAME_END:206}),FrameType:Object.freeze({METHOD:1,HEADER:2,BODY:3,HEARTBEAT:8})}},function(e,t){t.isPromise=function(e){return e&&"function"==typeof e.then&&"function"==typeof e["catch"]}},function(e,t,n){(function(t){"use strict";function r(e){e=e||{},e.keepAlive=e.keepAlive!==!1,e.keepAliveMsecs=e.keepAliveMsecs||e.maxKeepAliveTime,u.call(this,e);var t=this;t.maxKeepAliveRequests=parseInt(e.maxKeepAliveRequests,10)||0,t.createSocketCount=0,t.timeoutSocketCount=0,t.requestFinishedCount=0,t.removeAllListeners("free"),t.on("free",function(e,n){t.requestFinishedCount++,e._requestCount++;var r=t.getName(n);if(o("agent.on(free)",r),!t.isDestroyed(e)&&t.requests[r]&&t.requests[r].length)t.requests[r].shift().onSocket(e),0===t.requests[r].length&&delete t.requests[r];else{var i=e._httpMessage;if(i&&i.shouldKeepAlive&&!t.isDestroyed(e)&&t.options.keepAlive){var s=t.freeSockets[r],a=s?s.length:0,c=a;t.sockets[r]&&(c+=t.sockets[r].length),c>=t.maxSockets||a>=t.maxFreeSockets?(t.removeSocket(e,n),e.destroy()):(s=s||[],t.freeSockets[r]=s,e.setKeepAlive(!0,t.keepAliveMsecs),e.unref&&e.unref(),e._httpMessage=null,t.removeSocket(e,n),s.push(e),t.keepAliveMsecs&&e._events&&Array.isArray(e._events.timeout)&&(e.removeAllListeners("timeout"),e.setTimeout(t.keepAliveMsecs,e._maxKeepAliveTimeout)))}else t.removeSocket(e,n),e.destroy()}})}function i(e){r.call(this,e),this.defaultPort=443,this.protocol="https:"}var o,s=n(29),a=n(47),c=n(77);o=t.env.NODE_DEBUG&&/agentkeepalive/.test(t.env.NODE_DEBUG)?function(){console.error.apply(console,arguments)}:function(){};var u=s.Agent;(0===t.version.indexOf("v0.8.")||0===t.version.indexOf("v0.10."))&&(u=n(102).Agent,o("%s use _http_agent",t.version)),c.inherits(r,u),e.exports=r,r.prototype.createSocket=function(e,t){var n=this,r=u.prototype.createSocket.call(this,e,t);return r._requestCount=0,n.keepAliveMsecs&&(r._maxKeepAliveTimeout=function(){o("maxKeepAliveTimeout, socket destroy()"),r.destroy(),n.timeoutSocketCount++},r.setTimeout(n.keepAliveMsecs,r._maxKeepAliveTimeout),r.setNoDelay(!0)),this.createSocketCount++,r},r.prototype.removeSocket=function(e,t){u.prototype.removeSocket.call(this,e,t);var n=this.getName(t);if(o("removeSocket",n,"destroyed:",this.isDestroyed(e)),this.isDestroyed(e)&&this.freeSockets[n]){var r=this.freeSockets[n].indexOf(e);-1!==r&&(this.freeSockets[n].splice(r,1),0===this.freeSockets[n].length&&delete this.freeSockets[n])}},c.inherits(i,r),i.prototype.createConnection=a.globalAgent.createConnection,i.prototype.getName=function(e){var t=r.prototype.getName.call(this,e);return t+=":",e.ca&&(t+=e.ca),t+=":",e.cert&&(t+=e.cert),t+=":",e.ciphers&&(t+=e.ciphers),t+=":",e.key&&(t+=e.key),t+=":",e.pfx&&(t+=e.pfx),t+=":",void 0!==e.rejectUnauthorized&&(t+=e.rejectUnauthorized),t},r.HttpsAgent=i}).call(t,n(78))},function(e){function t(e,t){var n;return n=t?new r(e,t):new r(e)}var n=function(){return this}(),r=n.WebSocket||n.MozWebSocket;e.exports=r?t:null,r&&(t.prototype=r.prototype)},function(e,t,n){var r;(function(e,i){!function(o){function s(e,t,n){for(var r=(n||0)-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function a(e,t){var n=typeof t;if(e=e.cache,"boolean"==n||null==t)return e[t];"number"!=n&&"string"!=n&&(n="object");var r="number"==n?t:C+t;return e=e[n]||(e[n]={}),"object"==n?e[r]&&s(e[r],t)>-1?0:-1:e[r]?0:-1}function c(e){var t=this.cache,n=typeof e;if("boolean"==n||null==e)t[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var r="number"==n?e:C+e,i=t[n]||(t[n]={});"object"==n?(i[r]||(i[r]=[])).push(e)==this.array.length&&(t[n]=!1):i[r]=!0}}function u(e){return e.charCodeAt(0)}function l(e,t){var n=e.index,r=t.index;if(e=e.criteria,t=t.criteria,e!==t){if(e>t||"undefined"==typeof e)return 1;if(t>e||"undefined"==typeof t)return-1}return r>n?-1:1}function h(e){var t=-1,n=e.length,r=d();r["false"]=r["null"]=r["true"]=r.undefined=!1;var i=d();for(i.array=e,i.cache=r,i.push=c;++t<n;)i.push(e[t]);return r.object===!1?(y(i),null):i}function f(e){return"\\"+it[e]}function p(){return x.pop()||[]}function d(){return E.pop()||{args:"",array:null,bottom:"",cache:null,criteria:null,"false":!1,firstArg:"",index:0,init:"",leading:!1,loop:"",maxWait:0,"null":!1,number:null,object:null,push:null,shadowedProps:null,string:null,top:"",trailing:!1,"true":!1,undefined:!1,useHas:!1,useKeys:!1,value:null}}function v(e){return"function"!=typeof e.toString&&"string"==typeof(e+"")}function m(){}function g(e){e.length=0,x.length<j&&x.push(e)}function y(e){var t=e.cache;t&&y(t),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,E.length<j&&E.push(e)}function _(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,i=n-t||0,o=Array(0>i?0:i);++r<i;)o[r]=e[t+r];return o}function b(e){function t(e){return e&&"object"==typeof e&&!Hr(e)&&mr.call(e,"__wrapped__")?e:new n(e)}function n(e){this.__wrapped__=e}function r(e,t,n,r){function i(){var r=arguments,l=s?this:t;if(o||(e=t[a]),n.length&&(r=r.length?(r=Mr.call(r),u?r.concat(n):n.concat(r)):n),this instanceof i){l=c(e.prototype);var h=e.apply(l,r);return kt(h)?h:l}return e.apply(l,r)}var o=wt(e),s=!n,a=t;if(s){var u=r;n=t}else if(!o){if(!r)throw new rr;t=e}return i}function i(){var e=d();e.shadowedProps=K,e.array=e.bottom=e.loop=e.top="",e.init="iterable",e.useHas=!0,e.useKeys=!!Kr;for(var n,r=0;n=arguments[r];r++)for(var i in n)e[i]=n[i];var o=e.args;e.firstArg=/^[^,]+/.exec(o)[0];var s=Qn("errorClass, errorProto, hasOwnProperty, isArguments, isArray, isString, keys, lodash, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+o+") {\n"+Nr(e)+"\n}");return y(e),s($,or,mr,at,Hr,Ct,Kr,t,sr,rt,Lr,tt,ar,wr)}function c(e){return kt(e)?xr(e):{}}function x(e){return Wr[e]}function E(){var e=(e=t.indexOf)===sn?s:e;return e}function j(e){return function(n,r,i,o){return"boolean"!=typeof r&&null!=r&&(o=i,i=o&&o[r]===n?w:r,r=!1),null!=i&&(i=t.createCallback(i,o)),e(n,r,i,o)}}function it(e){var t,n;return!e||wr.call(e)!=Z||(t=e.constructor,wt(t)&&!(t instanceof t))||!Br.argsClass&&at(e)||!Br.nodeClass&&v(e)?!1:Br.ownLast?($r(e,function(e,t,r){return n=mr.call(r,t),!1}),n!==!1):($r(e,function(e,t){n=t}),n===w||mr.call(e,n))}function ot(e){return Vr[e]}function at(e){return wr.call(e)==W}function ut(e,n,r,i,o,s){var a=e;if("boolean"!=typeof n&&null!=n&&(i=r,r=n,n=!1),"function"==typeof r){if(r="undefined"==typeof i?r:t.createCallback(r,i,1),a=r(a),"undefined"!=typeof a)return a;a=e}var c=kt(a);if(c){var u=wr.call(a);if(!nt[u]||!Br.nodeClass&&v(a))return a;var l=Hr(a)}if(!c||!n)return c?l?_(a):Gr({},a):a;var h=Fr[u];switch(u){case G:case Y:return new h(+a);case X:case tt:return new h(a);case et:return h(a.source,F.exec(a))}var f=!o;o||(o=p()),s||(s=p());for(var d=o.length;d--;)if(o[d]==e)return s[d];return a=l?h(a.length):{},l&&(mr.call(e,"index")&&(a.index=e.index),mr.call(e,"input")&&(a.input=e.input)),o.push(e),s.push(a),(l?Jr:Qr)(e,function(e,t){a[t]=ut(e,n,r,w,o,s)}),f&&(g(o),g(s)),a}function lt(e,t,n){return ut(e,!0,t,n)}function ht(e,n,r){var i;return n=t.createCallback(n,r),Qr(e,function(e,t,r){return n(e,t,r)?(i=t,!1):void 0}),i}function ft(e){var t=[];return $r(e,function(e,n){wt(e)&&t.push(n)}),t.sort()}function pt(e,t){return e?mr.call(e,t):!1}function dt(e){for(var t=-1,n=Kr(e),r=n.length,i={};++t<r;){var o=n[t];i[e[o]]=o}return i}function vt(e){return e===!0||e===!1||wr.call(e)==G}function mt(e){return e?"object"==typeof e&&wr.call(e)==Y:!1}function gt(e){return e?1===e.nodeType:!1}function yt(e){var t=!0;if(!e)return t;var n=wr.call(e),r=e.length;return n==V||n==tt||(Br.argsClass?n==W:at(e))||n==Z&&"number"==typeof r&&wt(e.splice)?!r:(Qr(e,function(){return t=!1}),t)}function _t(e,n,r,i,o,s){var a=r===S;if("function"==typeof r&&!a){r=t.createCallback(r,i,2);var c=r(e,n);if("undefined"!=typeof c)return!!c}if(e===n)return 0!==e||1/e==1/n;var u=typeof e,l=typeof n;if(e===e&&(!e||"function"!=u&&"object"!=u)&&(!n||"function"!=l&&"object"!=l))return!1;if(null==e||null==n)return e===n;var h=wr.call(e),f=wr.call(n);if(h==W&&(h=Z),f==W&&(f=Z),h!=f)return!1;switch(h){case G:case Y:return+e==+n;case X:return e!=+e?n!=+n:0==e?1/e==1/n:e==+n;case et:case tt:return e==nr(n)}var d=h==V;if(!d){if(mr.call(e,"__wrapped__ ")||mr.call(n,"__wrapped__"))return _t(e.__wrapped__||e,n.__wrapped__||n,r,i,o,s);if(h!=Z||!Br.nodeClass&&(v(e)||v(n)))return!1;var m=!Br.argsObject&&at(e)?er:e.constructor,y=!Br.argsObject&&at(n)?er:n.constructor;if(m!=y&&!(wt(m)&&m instanceof m&&wt(y)&&y instanceof y))return!1}var _=!o;o||(o=p()),s||(s=p());for(var b=o.length;b--;)if(o[b]==e)return s[b]==n;var w=0;if(c=!0,o.push(e),s.push(n),d){if(b=e.length,w=n.length,c=w==e.length,!c&&!a)return c;for(;w--;){var k=b,x=n[w];if(a)for(;k--&&!(c=_t(e[k],x,r,i,o,s)););else if(!(c=_t(e[w],x,r,i,o,s)))break}return c}return $r(n,function(t,n,a){return mr.call(a,n)?(w++,c=mr.call(e,n)&&_t(e[n],t,r,i,o,s)):void 0}),c&&!a&&$r(e,function(e,t,n){return mr.call(n,t)?c=--w>-1:void 0}),_&&(g(o),g(s)),c}function bt(e){return Tr(e)&&!Sr(parseFloat(e))}function wt(e){return"function"==typeof e}function kt(e){return!(!e||!rt[typeof e])}function xt(e){return Tt(e)&&e!=+e}function Et(e){return null===e}function Tt(e){return"number"==typeof e||wr.call(e)==X}function St(e){return!(!e||!rt[typeof e])&&wr.call(e)==et}function Ct(e){return"string"==typeof e||wr.call(e)==tt}function At(e){return"undefined"==typeof e}function jt(e,n,r){var i=arguments,o=0,s=2;if(!kt(e))return e;if(r===S)var a=i[3],c=i[4],u=i[5];else{var l=!0;c=p(),u=p(),"number"!=typeof r&&(s=i.length),s>3&&"function"==typeof i[s-2]?a=t.createCallback(i[--s-1],i[s--],2):s>2&&"function"==typeof i[s-1]&&(a=i[--s])}for(;++o<s;)(Hr(i[o])?Dt:Qr)(i[o],function(t,n){var r,i,o=t,s=e[n];if(t&&((i=Hr(t))||Xr(t))){for(var l=c.length;l--;)if(r=c[l]==t){s=u[l];break}if(!r){var h;a&&(o=a(s,t),(h="undefined"!=typeof o)&&(s=o)),h||(s=i?Hr(s)?s:[]:Xr(s)?s:{}),c.push(t),u.push(s),h||(s=jt(s,t,S,a,c,u))}}else a&&(o=a(s,t),"undefined"==typeof o&&(o=t)),"undefined"!=typeof o&&(s=o);e[n]=s});return l&&(g(c),g(u)),e}function Ot(e,n,r){var i=E(),o="function"==typeof n,s={};if(o)n=t.createCallback(n,r);else var a=fr.apply(ir,Mr.call(arguments,1));return $r(e,function(e,t,r){(o?!n(e,t,r):i(a,t)<0)&&(s[t]=e)}),s}function Pt(e){for(var t=-1,n=Kr(e),r=n.length,i=Vn(r);++t<r;){var o=n[t];i[t]=[o,e[o]]}return i}function Mt(e,n,r){var i={};if("function"!=typeof n)for(var o=-1,s=fr.apply(ir,Mr.call(arguments,1)),a=kt(e)?s.length:0;++o<a;){var c=s[o];c in e&&(i[c]=e[c])}else n=t.createCallback(n,r),$r(e,function(e,t,r){n(e,t,r)&&(i[t]=e)});return i}function Rt(e,n,r,i){var o=Hr(e);if(n=t.createCallback(n,i,4),null==r)if(o)r=[];else{var s=e&&e.constructor,a=s&&s.prototype;r=c(a)}return(o?Jr:Qr)(e,function(e,t,i){return n(r,e,t,i)}),r}function It(e){for(var t=-1,n=Kr(e),r=n.length,i=Vn(r);++t<r;)i[t]=e[n[t]];return i}function Ft(e){var t=-1,n=fr.apply(ir,Mr.call(arguments,1)),r=n.length,i=Vn(r);for(Br.unindexedChars&&Ct(e)&&(e=e.split(""));++t<r;)i[t]=e[n[t]];return i}function Lt(e,t,n){var r=-1,i=E(),o=e?e.length:0,s=!1;return n=(0>n?Ar(0,o+n):n)||0,o&&"number"==typeof o?s=(Ct(e)?e.indexOf(t,n):i(e,t,n))>-1:Jr(e,function(e){return++r>=n?!(s=e===t):void 0}),s}function Bt(e,n,r){var i={};return n=t.createCallback(n,r),Dt(e,function(e,t,r){t=nr(n(e,t,r)),mr.call(i,t)?i[t]++:i[t]=1}),i}function Nt(e,n,r){var i=!0;if(n=t.createCallback(n,r),Hr(e))for(var o=-1,s=e.length;++o<s&&(i=!!n(e[o],o,e)););else Jr(e,function(e,t,r){return i=!!n(e,t,r)});return i}function Ut(e,n,r){var i=[];if(n=t.createCallback(n,r),Hr(e))for(var o=-1,s=e.length;++o<s;){var a=e[o];n(a,o,e)&&i.push(a)}else Jr(e,function(e,t,r){n(e,t,r)&&i.push(e)});return i}function qt(e,n,r){if(n=t.createCallback(n,r),!Hr(e)){var i;return Jr(e,function(e,t,r){return n(e,t,r)?(i=e,!1):void 0}),i}for(var o=-1,s=e.length;++o<s;){var a=e[o];if(n(a,o,e))return a}}function Dt(e,t,n){if(t&&"undefined"==typeof n&&Hr(e))for(var r=-1,i=e.length;++r<i&&t(e[r],r,e)!==!1;);else Jr(e,t,n);return e}function Ht(e,n,r){var i={};return n=t.createCallback(n,r),Dt(e,function(e,t,r){t=nr(n(e,t,r)),(mr.call(i,t)?i[t]:i[t]=[]).push(e)}),i}function zt(e,t){var n=Mr.call(arguments,2),r=-1,i="function"==typeof t,o=e?e.length:0,s=Vn("number"==typeof o?o:0);return Dt(e,function(e){s[++r]=(i?t:e[t]).apply(e,n)}),s}function Kt(e,n,r){var i=-1,o=e?e.length:0,s=Vn("number"==typeof o?o:0);if(n=t.createCallback(n,r),Hr(e))for(;++i<o;)s[i]=n(e[i],i,e);else Jr(e,function(e,t,r){s[++i]=n(e,t,r)});return s}function Jt(e,n,r){var i=-1/0,o=i;if(!n&&Hr(e))for(var s=-1,a=e.length;++s<a;){var c=e[s];c>o&&(o=c)}else n=!n&&Ct(e)?u:t.createCallback(n,r),Jr(e,function(e,t,r){var s=n(e,t,r);s>i&&(i=s,o=e)});return o}function Wt(e,n,r){var i=1/0,o=i;if(!n&&Hr(e))for(var s=-1,a=e.length;++s<a;){var c=e[s];o>c&&(o=c)}else n=!n&&Ct(e)?u:t.createCallback(n,r),Jr(e,function(e,t,r){var s=n(e,t,r);i>s&&(i=s,o=e)});return o}function Vt(e,n,r,i){var o=arguments.length<3;if(n=t.createCallback(n,i,4),Hr(e)){var s=-1,a=e.length;for(o&&(r=e[++s]);++s<a;)r=n(r,e[s],s,e)}else Jr(e,function(e,t,i){r=o?(o=!1,e):n(r,e,t,i)});return r}function Gt(e,n,r,i){var o=e,s=e?e.length:0,a=arguments.length<3;if("number"!=typeof s){var c=Kr(e);s=c.length}else Br.unindexedChars&&Ct(e)&&(o=e.split(""));return n=t.createCallback(n,i,4),Dt(e,function(e,t,i){t=c?c[--s]:--s,r=a?(a=!1,o[t]):n(r,o[t],t,i)}),r}function Yt(e,n,r){return n=t.createCallback(n,r),Ut(e,function(e,t,r){return!n(e,t,r)})}function $t(e){var t=-1,n=e?e.length:0,r=Vn("number"==typeof n?n:0);return Dt(e,function(e){var n=pr(Pr()*(++t+1));r[t]=r[n],r[n]=e}),r}function Qt(e){var t=e?e.length:0;return"number"==typeof t?t:Kr(e).length}function Xt(e,n,r){var i;if(n=t.createCallback(n,r),Hr(e))for(var o=-1,s=e.length;++o<s&&!(i=n(e[o],o,e)););else Jr(e,function(e,t,r){return!(i=n(e,t,r))});return!!i}function Zt(e,n,r){var i=-1,o=e?e.length:0,s=Vn("number"==typeof o?o:0);for(n=t.createCallback(n,r),Dt(e,function(e,t,r){var o=s[++i]=d();o.criteria=n(e,t,r),o.index=i,o.value=e}),o=s.length,s.sort(l);o--;){var a=s[o];s[o]=a.value,y(a)}return s}function en(e){return e&&"number"==typeof e.length?Br.unindexedChars&&Ct(e)?e.split(""):_(e):It(e)}function tn(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r}function nn(e){var t=-1,n=E(),r=e?e.length:0,i=fr.apply(ir,Mr.call(arguments,1)),o=[],c=r>=A&&n===s;if(c){var u=h(i);u?(n=a,i=u):c=!1}for(;++t<r;){var l=e[t];n(i,l)<0&&o.push(l)}return c&&y(i),o}function rn(e,n,r){var i=-1,o=e?e.length:0;for(n=t.createCallback(n,r);++i<o;)if(n(e[i],i,e))return i;return-1}function on(e,n,r){if(e){var i=0,o=e.length;if("number"!=typeof n&&null!=n){var s=-1;for(n=t.createCallback(n,r);++s<o&&n(e[s],s,e);)i++}else if(i=n,null==i||r)return e[0];return _(e,0,jr(Ar(0,i),o))}}function sn(e,t,n){if("number"==typeof n){var r=e?e.length:0;n=0>n?Ar(0,r+n):n||0}else if(n){var i=pn(e,t);return e[i]===t?i:-1}return e?s(e,t,n):-1}function an(e,n,r){if(!e)return[];var i=0,o=e.length;if("number"!=typeof n&&null!=n){var s=o;for(n=t.createCallback(n,r);s--&&n(e[s],s,e);)i++}else i=null==n||r?1:n||i;return _(e,0,jr(Ar(0,o-i),o))}function cn(e){for(var t=arguments,n=t.length,r=-1,i=p(),o=-1,c=E(),u=e?e.length:0,l=[],f=p();++r<n;){var d=t[r];i[r]=c===s&&(d?d.length:0)>=A&&h(r?t[r]:f)}e:for(;++o<u;){var v=i[0];if(d=e[o],(v?a(v,d):c(f,d))<0){for(r=n,(v||f).push(d);--r;)if(v=i[r],(v?a(v,d):c(t[r],d))<0)continue e;l.push(d)}}for(;n--;)v=i[n],v&&y(v);return g(i),g(f),l}function un(e,n,r){if(e){var i=0,o=e.length;if("number"!=typeof n&&null!=n){var s=o;for(n=t.createCallback(n,r);s--&&n(e[s],s,e);)i++}else if(i=n,null==i||r)return e[o-1];return _(e,Ar(0,o-i))}}function ln(e,t,n){var r=e?e.length:0;for("number"==typeof n&&(r=(0>n?Ar(0,r+n):jr(n,r-1))+1);r--;)if(e[r]===t)return r;return-1}function hn(e,t,n){e=+e||0,n=+n||1,null==t&&(t=e,e=0);for(var r=-1,i=Ar(0,lr((t-e)/n)),o=Vn(i);++r<i;)o[r]=e,e+=n;return o}function fn(e,n,r){if("number"!=typeof n&&null!=n){var i=0,o=-1,s=e?e.length:0;for(n=t.createCallback(n,r);++o<s&&n(e[o],o,e);)i++}else i=null==n||r?1:Ar(0,n);return _(e,i)}function pn(e,n,r,i){var o=0,s=e?e.length:o;for(r=r?t.createCallback(r,i,1):Fn,n=r(n);s>o;){var a=o+s>>>1;r(e[a])<n?o=a+1:s=a}return o}function dn(e){return Hr(e)||(arguments[0]=e?Mr.call(e):ir),ni(fr.apply(ir,arguments))}function vn(e){for(var t=-1,n=e?Jt(Zr(e,"length")):0,r=Vn(0>n?0:n);++t<n;)r[t]=Zr(e,t);return r}function mn(e){return nn(e,Mr.call(arguments,1))}function gn(e){return e?vn(arguments):[]}function yn(e,t){for(var n=-1,r=e?e.length:0,i={};++n<r;){var o=e[n];t?i[o]=t[n]:i[o[0]]=o[1]}return i}function _n(e,t){return 1>e?t():function(){return--e<1?t.apply(this,arguments):void 0}}function bn(e,t){return Br.fastBind||kr&&arguments.length>2?kr.call.apply(kr,arguments):r(e,t,Mr.call(arguments,2))}function wn(e){for(var t=arguments.length>1?fr.apply(ir,Mr.call(arguments,1)):ft(e),n=-1,r=t.length;++n<r;){var i=t[n];e[i]=bn(e[i],e)}return e}function kn(e,t){return r(e,t,Mr.call(arguments,2),S)}function xn(){var e=arguments;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}}function En(e,t,n){if(null==e)return Fn;var r=typeof e;if("function"!=r){if("object"!=r)return function(t){return t[e]};var i=Kr(e);return function(t){for(var n=i.length,r=!1;n--&&(r=_t(t[i[n]],e[i[n]],S)););return r}}return"undefined"==typeof t||B&&!B.test(dr.call(e))?e:1===n?function(n){return e.call(t,n)}:2===n?function(n,r){return e.call(t,n,r)}:4===n?function(n,r,i,o){return e.call(t,n,r,i,o)}:function(n,r,i){return e.call(t,n,r,i)}}function Tn(e,t,n){function r(){hr(f),hr(p),u=0,f=p=null}function i(){var t=d&&(!v||u>1);r(),t&&(h!==!1&&(l=new Yn),a=e.apply(c,s))}function o(){r(),(d||h!==t)&&(l=new Yn,a=e.apply(c,s))}var s,a,c,u=0,l=0,h=!1,f=null,p=null,d=!0;if(t=Ar(0,t||0),n===!0){var v=!0;d=!1}else kt(n)&&(v=n.leading,h="maxWait"in n&&Ar(t,n.maxWait||0),d="trailing"in n?n.trailing:d);return function(){if(s=arguments,c=this,u++,hr(p),h===!1)v&&2>u&&(a=e.apply(c,s));else{var n=new Yn;f||v||(l=n);var r=h-(n-l);0>=r?(hr(f),f=null,l=n,a=e.apply(c,s)):f||(f=br(o,r))}return t!==h&&(p=br(i,t)),a}}function Sn(e){var t=Mr.call(arguments,1);return br(function(){e.apply(w,t)},1)}function Cn(e,t){var n=Mr.call(arguments,2);return br(function(){e.apply(w,n)},t)}function An(e,t){function n(){var r=n.cache,i=C+(t?t.apply(this,arguments):arguments[0]);return mr.call(r,i)?r[i]:r[i]=e.apply(this,arguments)}return n.cache={},n}function jn(e){var t,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function On(e){return r(e,Mr.call(arguments,1))}function Pn(e){return r(e,Mr.call(arguments,1),null,S)}function Mn(e,t,n){var r=!0,i=!0;n===!1?r=!1:kt(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),n=d(),n.leading=r,n.maxWait=t,n.trailing=i;var o=Tn(e,t,n);return y(n),o}function Rn(e,t){return function(){var n=[e];return gr.apply(n,arguments),t.apply(this,n)}}function In(e){return null==e?"":nr(e).replace(D,x)}function Fn(e){return e}function Ln(e){Dt(ft(e),function(r){var i=t[r]=e[r];t.prototype[r]=function(){var e=this.__wrapped__,r=[e];gr.apply(r,arguments);var o=i.apply(t,r);return e&&"object"==typeof e&&e===o?this:new n(o)}})}function Bn(){return e._=cr,this}function Nn(e,t){null==e&&null==t&&(t=1),e=+e||0,null==t?(t=e,e=0):t=+t||0;var n=Pr();return e%1||t%1?e+jr(n*(t-e+parseFloat("1e-"+((n+"").length-1))),t):e+pr(n*(t-e+1))}function Un(e,t){var n=e?e[t]:w;return wt(n)?e[t]():n}function qn(e,n,r){var i=t.templateSettings;e||(e=""),r=Yr({},r,i);var o,s=Yr({},r.imports,i.imports),a=Kr(s),c=It(s),u=0,l=r.interpolate||q,h="__p += '",p=tr((r.escape||q).source+"|"+l.source+"|"+(l===L?I:q).source+"|"+(r.evaluate||q).source+"|$","g");e.replace(p,function(t,n,r,i,s,a){return r||(r=i),h+=e.slice(u,a).replace(H,f),n&&(h+="' +\n__e("+n+") +\n'"),s&&(o=!0,h+="';\n"+s+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=a+t.length,t}),h+="';\n";var d=r.variable,v=d;v||(d="obj",h="with ("+d+") {\n"+h+"\n}\n"),h=(o?h.replace(O,""):h).replace(P,"$1").replace(M,"$1;"),h="function("+d+") {\n"+(v?"":d+" || ("+d+" = {});\n")+"var __t, __p = '', __e = _.escape"+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m="\n/*\n//@ sourceURL="+(r.sourceURL||"/lodash/template/source["+J++ +"]")+"\n*/";try{var g=Qn(a,"return "+h+m).apply(w,c)}catch(y){throw y.source=h,y}return n?g(n):(g.source=h,g)}function Dn(e,n,r){e=(e=+e)>-1?e:0;var i=-1,o=Vn(e);for(n=t.createCallback(n,r,1);++i<e;)o[i]=n(i);return o}function Hn(e){return null==e?"":nr(e).replace(R,ot)}function zn(e){var t=++T;return nr(null==e?"":e)+t}function Kn(e,t){return t(e),e}function Jn(){return nr(this.__wrapped__)}function Wn(){return this.__wrapped__}e=e?ct.defaults(o.Object(),e,ct.pick(o,z)):o;var Vn=e.Array,Gn=e.Boolean,Yn=e.Date,$n=e.Error,Qn=e.Function,Xn=e.Math,Zn=e.Number,er=e.Object,tr=e.RegExp,nr=e.String,rr=e.TypeError,ir=[],or=$n.prototype,sr=er.prototype,ar=nr.prototype,cr=e._,ur=tr("^"+nr(sr.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),lr=Xn.ceil,hr=e.clearTimeout,fr=ir.concat,pr=Xn.floor,dr=Qn.prototype.toString,vr=ur.test(vr=er.getPrototypeOf)&&vr,mr=sr.hasOwnProperty,gr=ir.push,yr=sr.propertyIsEnumerable,_r=e.setImmediate,br=e.setTimeout,wr=sr.toString,kr=ur.test(kr=wr.bind)&&kr,xr=ur.test(xr=er.create)&&xr,Er=ur.test(Er=Vn.isArray)&&Er,Tr=e.isFinite,Sr=e.isNaN,Cr=ur.test(Cr=er.keys)&&Cr,Ar=Xn.max,jr=Xn.min,Or=e.parseInt,Pr=Xn.random,Mr=ir.slice,Rr=ur.test(e.attachEvent),Ir=kr&&!/\n|true/.test(kr+Rr),Fr={};Fr[V]=Vn,Fr[G]=Gn,Fr[Y]=Yn,Fr[Q]=Qn,Fr[Z]=er,Fr[X]=Zn,Fr[et]=tr,Fr[tt]=nr;var Lr={};Lr[V]=Lr[Y]=Lr[X]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},Lr[G]=Lr[tt]={constructor:!0,toString:!0,valueOf:!0},Lr[$]=Lr[Q]=Lr[et]={constructor:!0,toString:!0},Lr[Z]={constructor:!0},function(){for(var e=K.length;e--;){var t=K[e];for(var n in Lr)mr.call(Lr,n)&&!mr.call(Lr[n],t)&&(Lr[n][t]=!1)}}(),n.prototype=t.prototype;var Br=t.support={};!function(){var e=function(){this.x=1},t={0:1,length:1},n=[];e.prototype={valueOf:1,y:1};for(var r in new e)n.push(r);for(r in arguments);Br.argsObject=arguments.constructor==er&&!(arguments instanceof Vn),Br.argsClass=at(arguments),Br.enumErrorProps=yr.call(or,"message")||yr.call(or,"name"),Br.enumPrototypes=yr.call(e,"prototype"),Br.fastBind=kr&&!Ir,Br.ownLast="x"!=n[0],Br.nonEnumArgs=0!=r,Br.nonEnumShadows=!/valueOf/.test(n),Br.spliceObjects=(ir.splice.call(t,0,1),!t[0]),Br.unindexedChars="x"[0]+er("x")[0]!="xx";try{Br.nodeClass=!(wr.call(document)==Z&&!({toString:0}+""))}catch(i){Br.nodeClass=!0}}(1),t.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:L,variable:"",imports:{_:t}};var Nr=function(e){var t="var index, iterable = "+e.firstArg+", result = "+e.init+";\nif (!iterable) return result;\n"+e.top+";";e.array?(t+="\nvar length = iterable.length; index = -1;\nif ("+e.array+") {  ",Br.unindexedChars&&(t+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),t+="\n  while (++index < length) {\n    "+e.loop+";\n  }\n}\nelse {  "):Br.nonEnumArgs&&(t+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+e.loop+";\n    }\n  } else {  "),Br.enumPrototypes&&(t+="\n  var skipProto = typeof iterable == 'function';\n  "),Br.enumErrorProps&&(t+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  ");var n=[];if(Br.enumPrototypes&&n.push('!(skipProto && index == "prototype")'),Br.enumErrorProps&&n.push('!(skipErrorProps && (index == "message" || index == "name"))'),e.useHas&&e.useKeys)t+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",n.length&&(t+="    if ("+n.join(" && ")+") {\n  "),t+=e.loop+";    ",n.length&&(t+="\n    }"),t+="\n  }  ";else if(t+="\n  for (index in iterable) {\n",e.useHas&&n.push("hasOwnProperty.call(iterable, index)"),n.length&&(t+="    if ("+n.join(" && ")+") {\n  "),t+=e.loop+";    ",n.length&&(t+="\n    }"),t+="\n  }    ",Br.nonEnumShadows){for(t+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ",k=0;7>k;k++)t+="\n    index = '"+e.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",e.useHas||(t+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),t+=") {\n      "+e.loop+";\n    }      ";
t+="\n  }    "}return(e.array||Br.nonEnumArgs)&&(t+="\n}"),t+=e.bottom+";\nreturn result"},Ur={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},qr={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : lodash.createCallback(callback, thisArg)",array:"typeof length == 'number'",loop:"if (callback(iterable[index], index, collection) === false) return result"},Dr={top:"if (!objectTypes[typeof iterable]) return result;\n"+qr.top,array:!1};if(!xr)var c=function(e){if(kt(e)){m.prototype=e;var t=new m;m.prototype=null}return t||{}};Br.argsClass||(at=function(e){return e?mr.call(e,"callee"):!1});var Hr=Er||function(e){return e?"object"==typeof e&&wr.call(e)==V:!1},zr=i({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),Kr=Cr?function(e){return kt(e)?Br.enumPrototypes&&"function"==typeof e||Br.nonEnumArgs&&e.length&&at(e)?zr(e):Cr(e):[]}:zr,Jr=i(qr),Wr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Vr=dt(Wr),Gr=i(Ur,{top:Ur.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = lodash.createCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),Yr=i(Ur),$r=i(qr,Dr,{useHas:!1}),Qr=i(qr,Dr);wt(/x/)&&(wt=function(e){return"function"==typeof e&&wr.call(e)==Q});var Xr=vr?function(e){if(!e||wr.call(e)!=Z||!Br.argsClass&&at(e))return!1;var t=e.valueOf,n="function"==typeof t&&(n=vr(t))&&vr(n);return n?e==n||vr(e)==n:it(e)}:it,Zr=Kt,ei=Ut,ti=j(function ii(e,t,n){for(var r=-1,i=e?e.length:0,o=[];++r<i;){var s=e[r];n&&(s=n(s,r,e)),Hr(s)?gr.apply(o,t?s:ii(s)):o.push(s)}return o}),ni=j(function(e,t,n){var r=-1,i=E(),o=e?e.length:0,c=[],u=!t&&o>=A&&i===s,l=n||u?p():c;if(u){var f=h(l);f?(i=a,l=f):(u=!1,l=n?l:(g(l),c))}for(;++r<o;){var d=e[r],v=n?n(d,r,e):d;(t?!r||l[l.length-1]!==v:i(l,v)<0)&&((n||u)&&l.push(v),c.push(d))}return u?(g(l.array),y(l)):n&&g(l),c});Ir&&st&&"function"==typeof _r&&(Sn=bn(_r,e));var ri=8==Or(N+"08")?Or:function(e,t){return Or(Ct(e)?e.replace(U,""):e,t||0)};return t.after=_n,t.assign=Gr,t.at=Ft,t.bind=bn,t.bindAll=wn,t.bindKey=kn,t.compact=tn,t.compose=xn,t.countBy=Bt,t.createCallback=En,t.debounce=Tn,t.defaults=Yr,t.defer=Sn,t.delay=Cn,t.difference=nn,t.filter=Ut,t.flatten=ti,t.forEach=Dt,t.forIn=$r,t.forOwn=Qr,t.functions=ft,t.groupBy=Ht,t.initial=an,t.intersection=cn,t.invert=dt,t.invoke=zt,t.keys=Kr,t.map=Kt,t.max=Jt,t.memoize=An,t.merge=jt,t.min=Wt,t.omit=Ot,t.once=jn,t.pairs=Pt,t.partial=On,t.partialRight=Pn,t.pick=Mt,t.pluck=Zr,t.range=hn,t.reject=Yt,t.rest=fn,t.shuffle=$t,t.sortBy=Zt,t.tap=Kn,t.throttle=Mn,t.times=Dn,t.toArray=en,t.transform=Rt,t.union=dn,t.uniq=ni,t.unzip=vn,t.values=It,t.where=ei,t.without=mn,t.wrap=Rn,t.zip=gn,t.zipObject=yn,t.collect=Kt,t.drop=fn,t.each=Dt,t.extend=Gr,t.methods=ft,t.object=yn,t.select=Ut,t.tail=fn,t.unique=ni,Ln(t),t.chain=t,t.prototype.chain=function(){return this},t.clone=ut,t.cloneDeep=lt,t.contains=Lt,t.escape=In,t.every=Nt,t.find=qt,t.findIndex=rn,t.findKey=ht,t.has=pt,t.identity=Fn,t.indexOf=sn,t.isArguments=at,t.isArray=Hr,t.isBoolean=vt,t.isDate=mt,t.isElement=gt,t.isEmpty=yt,t.isEqual=_t,t.isFinite=bt,t.isFunction=wt,t.isNaN=xt,t.isNull=Et,t.isNumber=Tt,t.isObject=kt,t.isPlainObject=Xr,t.isRegExp=St,t.isString=Ct,t.isUndefined=At,t.lastIndexOf=ln,t.mixin=Ln,t.noConflict=Bn,t.parseInt=ri,t.random=Nn,t.reduce=Vt,t.reduceRight=Gt,t.result=Un,t.runInContext=b,t.size=Qt,t.some=Xt,t.sortedIndex=pn,t.template=qn,t.unescape=Hn,t.uniqueId=zn,t.all=Nt,t.any=Xt,t.detect=qt,t.findWhere=qt,t.foldl=Vt,t.foldr=Gt,t.include=Lt,t.inject=Vt,Qr(t,function(e,n){t.prototype[n]||(t.prototype[n]=function(){var n=[this.__wrapped__];return gr.apply(n,arguments),e.apply(t,n)})}),t.first=on,t.last=un,t.take=on,t.head=on,Qr(t,function(e,r){t.prototype[r]||(t.prototype[r]=function(t,r){var i=e(this.__wrapped__,t,r);return null==t||r&&"function"!=typeof t?i:new n(i)})}),t.VERSION="1.3.1",t.prototype.toString=Jn,t.prototype.value=Wn,t.prototype.valueOf=Wn,Jr(["join","pop","shift"],function(e){var n=ir[e];t.prototype[e]=function(){return n.apply(this.__wrapped__,arguments)}}),Jr(["push","reverse","sort","unshift"],function(e){var n=ir[e];t.prototype[e]=function(){return n.apply(this.__wrapped__,arguments),this}}),Jr(["concat","slice","splice"],function(e){var r=ir[e];t.prototype[e]=function(){return new n(r.apply(this.__wrapped__,arguments))}}),Br.spliceObjects||Jr(["pop","shift","splice"],function(e){var r=ir[e],i="splice"==e;t.prototype[e]=function(){var e=this.__wrapped__,t=r.apply(e,arguments);return 0===e.length&&delete e[0],i?new n(t):t}}),t}var w,x=[],E=[],T=0,S={},C=+new Date+"",A=75,j=40,O=/\b__p \+= '';/g,P=/\b(__p \+=) '' \+/g,M=/(__e\(.*?\)|\b__t\)) \+\n'';/g,R=/&(?:amp|lt|gt|quot|#39);/g,I=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,F=/\w*$/,L=/<%=([\s\S]+?)%>/g,B=(B=/\bthis\b/)&&B.test(b)&&B,N=" 	\f\n\r\u2028\u2029",U=RegExp("^["+N+"]*0+(?=.$)"),q=/($^)/,D=/[&<>"']/g,H=/['\n\r\t\u2028\u2029\\]/g,z=["Array","Boolean","Date","Error","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],K=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],J=0,W="[object Arguments]",V="[object Array]",G="[object Boolean]",Y="[object Date]",$="[object Error]",Q="[object Function]",X="[object Number]",Z="[object Object]",et="[object RegExp]",tt="[object String]",nt={};nt[Q]=!1,nt[W]=nt[V]=nt[G]=nt[Y]=nt[X]=nt[Z]=nt[et]=nt[tt]=!0;var rt={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},it={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},ot=rt[typeof t]&&t,st=rt[typeof e]&&e&&e.exports==ot&&e,at=rt[typeof i]&&i;!at||at.global!==at&&at.window!==at||(o=at);var ct=b();o._=ct,r=function(){return ct}.call(t,n,t,e),!(r!==w&&(e.exports=r))}(this)}).call(t,n(98)(e),function(){return this}())},function(e,t,n){"use strict";var r=n(106)();e.exports=r},function(){},function(e,t){t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,l=-7,h=n?i-1:0,f=n?-1:1,p=e[t+h];for(h+=f,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+h],h+=f,l-=8);if(0===o)o=1-u;else{if(o===c)return s?0/0:1/0*(p?-1:1);s+=Math.pow(2,r),o-=u}return(p?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,v=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),t+=s+h>=1?f/c:f*Math.pow(2,1-h),t*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*c-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[n+p]=255&s,p+=d,s/=256,u-=8);e[n+p-d]|=128*v}},function(e){var t=Array.isArray,n=Object.prototype.toString;e.exports=t||function(e){return!!e&&"[object Array]"==n.call(e)}},function(e,t,n){function r(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var n=1732584193,r=-271733879,i=-1732584194,l=271733878,h=0;h<e.length;h+=16){var f=n,p=r,d=i,v=l;n=o(n,r,i,l,e[h+0],7,-680876936),l=o(l,n,r,i,e[h+1],12,-389564586),i=o(i,l,n,r,e[h+2],17,606105819),r=o(r,i,l,n,e[h+3],22,-1044525330),n=o(n,r,i,l,e[h+4],7,-176418897),l=o(l,n,r,i,e[h+5],12,1200080426),i=o(i,l,n,r,e[h+6],17,-1473231341),r=o(r,i,l,n,e[h+7],22,-45705983),n=o(n,r,i,l,e[h+8],7,1770035416),l=o(l,n,r,i,e[h+9],12,-1958414417),i=o(i,l,n,r,e[h+10],17,-42063),r=o(r,i,l,n,e[h+11],22,-1990404162),n=o(n,r,i,l,e[h+12],7,1804603682),l=o(l,n,r,i,e[h+13],12,-40341101),i=o(i,l,n,r,e[h+14],17,-1502002290),r=o(r,i,l,n,e[h+15],22,1236535329),n=s(n,r,i,l,e[h+1],5,-165796510),l=s(l,n,r,i,e[h+6],9,-1069501632),i=s(i,l,n,r,e[h+11],14,643717713),r=s(r,i,l,n,e[h+0],20,-373897302),n=s(n,r,i,l,e[h+5],5,-701558691),l=s(l,n,r,i,e[h+10],9,38016083),i=s(i,l,n,r,e[h+15],14,-660478335),r=s(r,i,l,n,e[h+4],20,-405537848),n=s(n,r,i,l,e[h+9],5,568446438),l=s(l,n,r,i,e[h+14],9,-1019803690),i=s(i,l,n,r,e[h+3],14,-187363961),r=s(r,i,l,n,e[h+8],20,1163531501),n=s(n,r,i,l,e[h+13],5,-1444681467),l=s(l,n,r,i,e[h+2],9,-51403784),i=s(i,l,n,r,e[h+7],14,1735328473),r=s(r,i,l,n,e[h+12],20,-1926607734),n=a(n,r,i,l,e[h+5],4,-378558),l=a(l,n,r,i,e[h+8],11,-2022574463),i=a(i,l,n,r,e[h+11],16,1839030562),r=a(r,i,l,n,e[h+14],23,-35309556),n=a(n,r,i,l,e[h+1],4,-1530992060),l=a(l,n,r,i,e[h+4],11,1272893353),i=a(i,l,n,r,e[h+7],16,-155497632),r=a(r,i,l,n,e[h+10],23,-1094730640),n=a(n,r,i,l,e[h+13],4,681279174),l=a(l,n,r,i,e[h+0],11,-358537222),i=a(i,l,n,r,e[h+3],16,-722521979),r=a(r,i,l,n,e[h+6],23,76029189),n=a(n,r,i,l,e[h+9],4,-640364487),l=a(l,n,r,i,e[h+12],11,-421815835),i=a(i,l,n,r,e[h+15],16,530742520),r=a(r,i,l,n,e[h+2],23,-995338651),n=c(n,r,i,l,e[h+0],6,-198630844),l=c(l,n,r,i,e[h+7],10,1126891415),i=c(i,l,n,r,e[h+14],15,-1416354905),r=c(r,i,l,n,e[h+5],21,-57434055),n=c(n,r,i,l,e[h+12],6,1700485571),l=c(l,n,r,i,e[h+3],10,-1894986606),i=c(i,l,n,r,e[h+10],15,-1051523),r=c(r,i,l,n,e[h+1],21,-2054922799),n=c(n,r,i,l,e[h+8],6,1873313359),l=c(l,n,r,i,e[h+15],10,-30611744),i=c(i,l,n,r,e[h+6],15,-1560198380),r=c(r,i,l,n,e[h+13],21,1309151649),n=c(n,r,i,l,e[h+4],6,-145523070),l=c(l,n,r,i,e[h+11],10,-1120210379),i=c(i,l,n,r,e[h+2],15,718787259),r=c(r,i,l,n,e[h+9],21,-343485551),n=u(n,f),r=u(r,p),i=u(i,d),l=u(l,v)}return Array(n,r,i,l)}function i(e,t,n,r,i,o){return u(l(u(u(t,e),u(r,o)),i),n)}function o(e,t,n,r,o,s,a){return i(t&n|~t&r,e,t,o,s,a)}function s(e,t,n,r,o,s,a){return i(t&r|n&~r,e,t,o,s,a)}function a(e,t,n,r,o,s,a){return i(t^n^r,e,t,o,s,a)}function c(e,t,n,r,o,s,a){return i(n^(t|~r),e,t,o,s,a)}function u(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function l(e,t){return e<<t|e>>>32-t}var h=n(108);e.exports=function(e){return h.hash(e,r,16)}},function(e){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){(function(e){var r=n(45),i=n(77).inherits;t.Promise=function(){r.EventEmitter.call(this),this._blocking=!1,this.hasFired=!1,this.hasAcked=!1,this._values=void 0},i(t.Promise,r.EventEmitter),t.Promise.prototype.timeout=function(e){if(!e)return this._timeoutDuration;if(this._timeoutDuration=e,!this.hasFired){this._clearTimeout();var t=this;return this._timer=setTimeout(function(){t._timer=null,t.hasFired||t.emitError(new Error("timeout"))},e),this}},t.Promise.prototype._clearTimeout=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},t.Promise.prototype.emitSuccess=function(){this.hasFired||(this.hasFired="success",this._clearTimeout(),this._values=Array.prototype.slice.call(arguments),this.emit.apply(this,["success"].concat(this._values)))},t.Promise.prototype.emitError=function(){if(!this.hasFired&&(this.hasFired="error",this._clearTimeout(),this._values=Array.prototype.slice.call(arguments),this.emit.apply(this,["error"].concat(this._values)),0==this.listeners("error").length)){var t=this;e.nextTick(function(){if(0==t.listeners("error").length)throw t._values[0]instanceof Error?t._values[0]:new Error("Unhandled emitError: "+JSON.stringify(t._values))})}},t.Promise.prototype.addCallback=function(e){return"success"===this.hasFired&&e.apply(this,this._values),this.addListener("success",e)},t.Promise.prototype.addErrback=function(e){return"error"===this.hasFired&&e.apply(this,this._values),this.addListener("error",e)}}).call(t,n(78))},function(e,t,r){(function(t){function i(){return"x"+ ++S+ +new Date}function o(){return+new Date}function s(e,t){var n=e.join(F),r=[];return t?(p(t,function(e,t){var n="object"==typeof t?JSON.stringify(t):t;"undefined"!=typeof t&&null!=t&&v(n).length>0&&r.push(e+"="+v(n))}),n+="?"+r.join(L)):n}function a(e,t){var n,r=0,i=function(){r+t>o()?(clearTimeout(n),n=setTimeout(i,t)):(r=o(),e())};return i}function c(e,t){var n=[];return p(e||[],function(e){t(e)&&n.push(e)}),n}function u(e,t){return e.replace(q,function(e,n){return t[n]||e})}function l(e,t){return setTimeout(e,t)}function h(e){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)});return e&&e(t),t}function f(e){return!!e&&(Array.isArray&&Array.isArray(e)||"number"==typeof e.length)}function p(e,t){if(e&&t)if(f(e))for(var n=0,r=e.length;r>n;)t.call(e[n],e[n],n++);else for(var n in e)e.hasOwnProperty&&e.hasOwnProperty(n)&&t.call(e[n],n,e[n])}function d(e,t){var n=[];return p(e||[],function(e,r){n.push(t(e,r))}),n}function v(e){return encodeURIComponent(e)}function m(e,t){var n=[];return p(e,function(e,r){t?e.search("-pnpres")<0&&r.subscribed&&n.push(e):r.subscribed&&n.push(e)}),n.sort()}function g(){l(function(){C||(C=1,p(A,function(e){e()}))},I)}function y(e){return msg=e||{apns:{}},msg.getPubnubMessage=function(){var e={};if(Object.keys(msg.apns).length){e.pn_apns={aps:{alert:msg.apns.alert,badge:msg.apns.badge}};for(var t in msg.apns)e.pn_apns[t]=msg.apns[t];var n=["badge","alert"];for(var t in n)delete e.pn_apns[n[t]]}msg.gcm&&(e.pn_gcm={data:msg.gcm});for(var t in msg)e[t]=msg[t];var r=["apns","gcm","publish","channel","callback","error"];for(var t in r)delete e[r[t]];return e},msg.publish=function(){var e=msg.getPubnubMessage();msg.pubnub&&msg.channel&&msg.pubnub.publish({message:e,channel:msg.channel,callback:msg.callback,error:msg.error})},msg}function _(e){function t(e){return e||(e={}),p(wt,function(t,n){t in e||(e[t]=n)}),e}function r(e){var t=[];return p(e,function(e){t.push(e)}),t}function s(e){return r(e).sort()}function f(e){var t="",n=s(e);for(var r in n){var i=n[r];t+=i+"="+v(e[i]),r!=n.length-1&&(t+="&")}return t}function y(e,t,n){var r=!1;if("number"==typeof e)r=e>B||0==e?!1:!0;else{if("boolean"==typeof e)return e?N:0;r=!0}return r?(n&&n("Presence Heartbeat value invalid. Valid range ( x > "+B+" or x = 0). Current Value : "+(t||B)),t||B):e}function _(e,t){return At.encrypt(e,t||St)||e}function b(e,t){return At.decrypt(e,t||St)||At.decrypt(e,St)||e}function w(){return clearTimeout(dt),!mt||mt>=500||1>mt||!m(ft,!0).length?void(gt=!1):(gt=!0,void jt.presence_heartbeat({callback:function(){dt=l(w,mt*I)},error:function(e){kt&&kt("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(e)),dt=l(w,mt*I)}}))}function x(){!gt&&w()}function E(e){if(yt){if(!it.length)return}else{if(e&&(it.sending=0),it.sending||!it.length)return;it.sending=1}bt(it.shift())}function T(e){var t=0;return p(m(ft),function(n){var r=ft[n];r&&(t++,(e||function(){})(r))}),t}function S(e,t,n){if("object"==typeof e){if(e.error&&e.message&&e.payload)return void n({message:e.message,payload:e.payload});if(e.payload)return void t(e.payload)}t(e)}function P(e,t){t("object"==typeof e&&e.error&&e.message&&e.payload?{message:e.message,payload:e.payload}:e)}function F(){xt()||q(1,{error:"Offline. Please check your network settings. "}),l(F,I)}function L(){jt.time(function(e){z(function(){},e),e||q(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),l(L,W)})}function q(e,t){ct&&ct(e,t),ct=null}function H(e){var t=o()-ot;return t-e/1e4}function z(e,t){function n(t){if(t){var n=t/1e4,i=(o()-r)/2;ot=o()-(n+i),e&&e(ot)}}var r=o();t&&n(t)||jt.time(n)}var K=+e.windowing||O,J=(+e.timeout||M)*I,W=(+e.keepalive||R)*I,V=e.noleave||0,G=e.publish_key||"demo",Y=e.subscribe_key||"demo",$=e.auth_key||"",Q=e.secret_key||"",X=e.hmac_SHA256,Z=e.ssl?"s":"",et="http"+Z+"://"+(e.origin||"pubsub.pubnub.com"),tt=D(et),nt=D(et),rt=function(){},it=[],ot=0,st=0,at=0,ct=0,ut=e.restore||0,lt=0,ht=!1,ft={},pt={},dt=null,vt=y(e.heartbeat||e.pnexpires||0,e.error),mt=e.heartbeat_interval||vt-3,gt=!1,yt=e.no_wait_for_pending,_t=e["compatible_3.5"]||!1,bt=e.xdr,wt=e.params||{},kt=e.error||function(){},xt=e._is_online||function(){return 1},Et=e.jsonp_cb||function(){return 0},Tt=e.db||{get:function(){},set:function(){}},St=e.cipher_key,Ct=e.uuid||Tt&&Tt.get(Y+"uuid")||"",At=e.crypto_obj||{encrypt:function(e){return e},decrypt:function(e){return e}},jt={LEAVE:function(e,n,r,i){var o={uuid:Ct,auth:$},s=D(et),r=r||function(){},a=i||function(){},c=Et();if(e.indexOf(j)>0)return!0;if(_t){if(!Z)return!1;if("0"==c)return!1}return V?!1:("0"!=c&&(o.callback=c),bt({blocking:n||Z,timeout:2e3,callback:c,data:t(o),success:function(e){S(e,r,a)},fail:function(e){P(e,a)},url:[s,"v2","presence","sub_key",Y,"channel",v(e),"leave"]}),!0)},set_resumed:function(e){ht=e},get_cipher_key:function(){return St},set_cipher_key:function(e){St=e},raw_encrypt:function(e,t){return _(e,t)},raw_decrypt:function(e,t){return b(e,t)},get_heartbeat:function(){return vt},set_heartbeat:function(e){vt=y(e,mt,kt),mt=vt-3>=1?vt-3:1,rt(),w()},get_heartbeat_interval:function(){return mt},set_heartbeat_interval:function(e){mt=e,w()},get_version:function(){return U},getGcmMessageObject:function(e){return{data:e}},getApnsMessageObject:function(e){var t={aps:{badge:1,alert:""}};for(k in e)k[t]=e[k];return t},newPnMessage:function(){var e={};gcm&&(e.pn_gcm=gcm),apns&&(e.pn_apns=apns);for(k in n)e[k]=n[k];return e},_add_param:function(e,t){wt[e]=t},history:function(e,n){var n=e.callback||n,r=e.count||e.limit||100,i=e.reverse||"false",o=e.error||function(){},s=e.auth_key||$,a=e.cipher_key,c=e.channel,u=e.start,l=e.end,h=e.include_token,f={},p=Et();return c?n?Y?(f.stringtoken="true",f.count=r,f.reverse=i,f.auth=s,p&&(f.callback=p),u&&(f.start=u),l&&(f.end=l),h&&(f.include_token="true"),void bt({callback:p,data:t(f),success:function(e){if("object"==typeof e&&e.error)return void o({message:e.message,payload:e.payload});for(var t=e[0],r=[],i=0;i<t.length;i++){var s=b(t[i],a);try{r.push(JSON.parse(s))}catch(c){r.push(s)}}n([r,e[1],e[2]])},fail:function(e){P(e,o)},url:[tt,"v2","history","sub-key",Y,"channel",v(c)]})):kt("Missing Subscribe Key"):kt("Missing Callback"):kt("Missing Channel")},replay:function(e,n){var r,n=n||e.callback||function(){},i=e.auth_key||$,o=e.source,s=e.destination,a=e.stop,c=e.start,u=e.end,l=e.reverse,h=e.limit,f=Et(),p={};return o?s?G?Y?("0"!=f&&(p.callback=f),a&&(p.stop="all"),l&&(p.reverse="true"),c&&(p.start=c),u&&(p.end=u),h&&(p.count=h),p.auth=i,r=[tt,"v1","replay",G,Y,o,s],void bt({callback:f,success:function(e){S(e,n,err)},fail:function(){n([0,"Disconnected"])},url:r,data:t(p)})):kt("Missing Subscribe Key"):kt("Missing Publish Key"):kt("Missing Destination Channel"):kt("Missing Source Channel")},auth:function(e){$=e,rt()},time:function(e){var n=Et();bt({callback:n,data:t({uuid:Ct,auth:$}),timeout:5*I,url:[tt,"time",n],success:function(t){e(t[0])},fail:function(){e(0)}})},publish:function(e,n){var r=e.message;if(!r)return kt("Missing Message");var i,n=n||e.callback||r.callback||function(){},o=e.channel||r.channel,s=e.auth_key||$,a=e.cipher_key,c=e.error||r.error||function(){},u=e.post||!1,l="store_in_history"in e?e.store_in_history:!0,h=Et(),f="push";return e.prepend&&(f="unshift"),o?G?Y?(r.getPubnubMessage&&(r=r.getPubnubMessage()),r=JSON.stringify(_(r,a)),i=[tt,"publish",G,Y,0,v(o),h,v(r)],wt={uuid:Ct,auth:s},l||(wt.store="0"),it[f]({callback:h,timeout:5*I,url:i,data:t(wt),fail:function(e){P(e,c),E(1)},success:function(e){S(e,n,c),E(1)},mode:u?"POST":"GET"}),void E()):kt("Missing Subscribe Key"):kt("Missing Publish Key"):kt("Missing Channel")},unsubscribe:function(e,t){var n=e.channel,t=t||e.callback||function(){},r=e.error||function(){};lt=0,n=d((n.join?n.join(","):""+n).split(","),function(e){return ft[e]?e+","+e+j:void 0}).join(","),p(n.split(","),function(e){var n=!0;e&&(C&&(n=jt.LEAVE(e,0,t,r)),n||t({action:"leave"}),ft[e]=0,e in pt&&delete pt[e])}),rt()},subscribe:function(e,n){function r(e){e?l(rt,I):(tt=D(et,1),nt=D(et,1),l(function(){jt.time(r)},I)),T(function(t){return e&&t.disconnected?(t.disconnected=0,t.reconnect(t.name)):void(e||t.disconnected||(t.disconnected=1,t.disconnect(t.name)))})}function i(){var e=Et(),n=m(ft).join(",");if(n){q();var o=t({uuid:Ct,auth:a}),s=JSON.stringify(pt);s.length>2&&(o.state=JSON.stringify(pt)),vt&&(o.heartbeat=vt),x(),ct=bt({timeout:E,callback:e,fail:function(e){P(e,f),jt.time(r)},data:t(o),url:[nt,"subscribe",Y,v(n),e,lt],success:function(e){if(!e||"object"==typeof e&&"error"in e&&e.error)return f(e.error),l(rt,I);if(g(e[1]),lt=!lt&&ut&&Tt.get(Y)||e[1],T(function(e){e.connected||(e.connected=1,e.connect(e.name))}),ht&&!ut)return lt=0,ht=!1,Tt.set(Y,0),void l(i,S);w&&(lt=1e4,w=0),Tt.set(Y,e[1]);var t=function(){var t=e.length>2?e[2]:d(m(ft),function(t){return d(Array(e[0].length).join(",").split(","),function(){return t})}).join(","),n=t.split(",");return function(){var e=n.shift()||at;return[(ft[e]||{}).callback||st,e.split(j)[0]]}}(),n=H(+e[1]);p(e[0],function(r){var i=t(),o=b(r,ft[i[1]]?ft[i[1]].cipher_key:null);i[0](o,e,i[1],n)}),l(i,S)}})}}var s=e.channel,n=n||e.callback,n=n||e.message,a=e.auth_key||$,c=e.connect||function(){},u=e.reconnect||function(){},h=e.disconnect||function(){},f=e.error||function(){},g=e.idle||function(){},y=e.presence||0,_=e.noheresync||0,w=e.backfill||0,k=e.timetoken||0,E=e.timeout||J,S=e.windowing||K,O=e.state,M=e.heartbeat||e.pnexpires,R=e.restore||ut;return ut=R,lt=k,s?n?Y?((M||0===M)&&jt.set_heartbeat(M),p((s.join?s.join(","):""+s).split(","),function(t){var r=ft[t]||{};ft[at=t]={name:t,connected:r.connected,disconnected:r.disconnected,subscribed:1,callback:st=n,cipher_key:e.cipher_key,connect:c,disconnect:h,reconnect:u},O&&(pt[t]=t in O?O[t]:O),y&&(jt.subscribe({channel:t+j,callback:y,restore:R}),r.subscribed||_||jt.here_now({channel:t,callback:function(e){p("uuids"in e?e.uuids:[],function(n){y({action:"join",uuid:n,timestamp:Math.floor(o()/1e3),occupancy:e.occupancy||1},e,t)})}}))}),rt=function(){q(),l(i,S)},C?void rt():A.push(rt)):kt("Missing Subscribe Key"):kt("Missing Callback"):kt("Missing Channel")},here_now:function(e,n){var n=e.callback||n,r=e.error||function(){},i=e.auth_key||$,o=e.channel,s=Et(),a="uuids"in e?e.uuids:!0,c=e.state,u={uuid:Ct,auth:i};if(a||(u.disable_uuids=1),c&&(u.state=1),!n)return kt("Missing Callback");if(!Y)return kt("Missing Subscribe Key");var l=[tt,"v2","presence","sub_key",Y];o&&l.push("channel")&&l.push(v(o)),"0"!=s&&(u.callback=s),bt({callback:s,data:t(u),success:function(e){S(e,n,r)},fail:function(e){P(e,r)},url:l})},where_now:function(e,n){var n=e.callback||n,r=e.error||function(){},i=e.auth_key||$,o=Et(),s=e.uuid||Ct,a={auth:i};return n?Y?("0"!=o&&(a.callback=o),void bt({callback:o,data:t(a),success:function(e){S(e,n,r)},fail:function(e){P(e,r)},url:[tt,"v2","presence","sub_key",Y,"uuid",v(s)]})):kt("Missing Subscribe Key"):kt("Missing Callback")},state:function(e,n){var r,n=e.callback||n||function(){},i=e.error||function(){},o=e.auth_key||$,s=Et(),a=e.state,c=e.uuid||Ct,u=e.channel,l=t({auth:o});return Y?c?u?("0"!=s&&(l.callback=s),ft[u]&&ft[u].subscribed&&a&&(pt[u]=a),l.state=JSON.stringify(a),r=a?[tt,"v2","presence","sub-key",Y,"channel",v(u),"uuid",c,"data"]:[tt,"v2","presence","sub-key",Y,"channel",v(u),"uuid",v(c)],void bt({callback:s,data:t(l),success:function(e){S(e,n,i)},fail:function(e){P(e,i)},url:r})):kt("Missing Channel"):kt("Missing UUID"):kt("Missing Subscribe Key")},grant:function(e,n){var n=e.callback||n,r=e.error||function(){},i=e.channel,o=Et(),s=e.ttl,a=e.read?"1":"0",c=e.write?"1":"0",u=e.auth_key;if(!n)return kt("Missing Callback");if(!Y)return kt("Missing Subscribe Key");if(!G)return kt("Missing Publish Key");if(!Q)return kt("Missing Secret Key");var l=Math.floor((new Date).getTime()/1e3),h=Y+"\n"+G+"\ngrant\n",p={w:c,r:a,timestamp:l};"undefined"!=i&&null!=i&&i.length>0&&(p.channel=i),"0"!=o&&(p.callback=o),(s||0===s)&&(p.ttl=s),u&&(p.auth=u),p=t(p),u||delete p.auth,h+=f(p);var d=X(h,Q);d=d.replace(/\+/g,"-"),d=d.replace(/\//g,"_"),p.signature=d,bt({callback:o,data:p,success:function(e){S(e,n,r)},fail:function(e){P(e,r)},url:[tt,"v1","auth","grant","sub-key",Y]})},audit:function(e,n){var n=e.callback||n,r=e.error||function(){},i=e.channel,o=e.auth_key,s=Et();if(!n)return kt("Missing Callback");if(!Y)return kt("Missing Subscribe Key");if(!G)return kt("Missing Publish Key");if(!Q)return kt("Missing Secret Key");var a=Math.floor((new Date).getTime()/1e3),c=Y+"\n"+G+"\naudit\n",u={timestamp:a};"0"!=s&&(u.callback=s),"undefined"!=i&&null!=i&&i.length>0&&(u.channel=i),o&&(u.auth=o),u=t(u),o||delete u.auth,c+=f(u);var l=X(c,Q);l=l.replace(/\+/g,"-"),l=l.replace(/\//g,"_"),u.signature=l,bt({callback:s,data:u,success:function(e){S(e,n,r)},fail:function(e){P(e,r)},url:[tt,"v1","auth","audit","sub-key",Y]})},revoke:function(e,t){e.read=!1,e.write=!1,jt.grant(e,t)},set_uuid:function(e){Ct=e,rt()},get_uuid:function(){return Ct},presence_heartbeat:function(e){var n=e.callback||function(){},r=e.error||function(){},i=Et(),o={uuid:Ct,auth:$},s=JSON.stringify(pt);s.length>2&&(o.state=JSON.stringify(pt)),vt>0&&320>vt&&(o.heartbeat=vt),"0"!=i&&(o.callback=i),bt({callback:i,data:t(o),timeout:5*I,url:[tt,"v2","presence","sub-key",Y,"channel",v(m(ft,!0).join(",")),"heartbeat"],success:function(e){S(e,n,r)},fail:function(e){P(e,r)}})},xdr:bt,ready:g,db:Tt,uuid:h,map:d,each:p,"each-channel":T,grep:c,offline:function(){q(1,{message:"Offline. Please check your network settings."})},supplant:u,now:o,unique:i,updater:a};return Ct||(Ct=jt.uuid()),Tt.set(Y+"uuid",Ct),l(F,I),l(L,W),dt=l(x,(mt-3)*I),z(),jt}function b(e,n){return W.createHmac("sha256",new t(n,"utf8")).update(e).digest("base64")}function w(e){console.error(e)}function x(e){var t,n,i=e.success||function(){},o=e.fail||function(){},a=e.origin||"pubsub.pubnub.com",c=e.ssl,u=0,h=0,f=e.mode||"GET",p=e.data||{},d=e.timeout||P,v="",m=function(){if(!h){h=1,clearTimeout(y);try{n=JSON.parse(v)}catch(e){return g(1)}i(n)}},g=function(e,n){u||(u=1,clearTimeout(y),t&&(t.on("error",function(){}),t.on("data",function(){}),t.on("end",function(){}),t.abort&&t.abort(),t=null),e&&o(n))},y=l(function(){g(1)},d);p.pnsdk=J;var _={},b="";"POST"==f&&(b=decodeURIComponent(e.url.pop()));var w=s(e.url,p);c||(c="https"==w.split("://")[0]?!0:!1),w="/"+w.split("/").slice(3).join("/");var a=e.url[0].split("//")[1];_.hostname=V?V.hostname:e.url[0].split("//")[1],_.port=V?V.port:c?443:80,_.path=V?"http://"+a+w:w,_.headers=V?{Host:a}:null,_.method=f,_.keepAlive=!!K,_.agent=K,_.body=b,r(29).globalAgent.maxSockets=1/0;try{t=(c?z:H).request(_,function(e){e.setEncoding("utf8"),e.on("error",function(){console.log("error"),g(1,v||{error:"Network Connection Error"})}),e.on("abort",function(){console.log("abort"),g(1,v||{error:"Network Connection Error"})}),e.on("data",function(e){e&&(v+=e)}),e.on("end",function(){var t=e.statusCode;switch(t){case 401:case 402:case 403:try{e=JSON.parse(v),g(1,e)}catch(n){return g(1,v)}return}m()})}),t.timeout=d,t.on("error",function(){g(1,{error:"Network Connection Error"})}),"POST"==f&&t.write(b),t.end()}catch(k){return g(0),x(e)}return g}function E(){function e(e){return W.createHash("sha256").update(e).digest("hex").slice(0,32)}var t="0123456789012345";return{encrypt:function(n,r){if(!r)return n;var i=JSON.stringify(n),o=W.createCipheriv("aes-256-cbc",e(r),t),s=o.update(i,"utf8","base64")+o.final("base64");return s||n},decrypt:function(n,r){if(!r)return n;var i=W.createDecipheriv("aes-256-cbc",e(r),t);try{var o=i.update(n,"base64","utf8")+i.final("utf8")}catch(s){return null}return JSON.parse(o)}}}function T(){return"EventEmitter"in H.Agent.super_}var S=1,C=!1,A=[],j="-pnpres",O=10,P=1e4,M=310,R=60,I=1e3,F="/",L="&",B=5,N=30,U="3.6.8",q=/{([\w\-]+)}/g,D=function(){var e=20,t=Math.floor(Math.random()*e);return function(n,r){return n.indexOf("pubsub.")>0&&n.replace("pubsub","ps"+(r?h().split("-")[0]:++t<e?t:t=1))||n}}(),S=1,H=r(29),z=r(47),K=new(T()?H.Agent:r(152))({keepAlive:!0,keepAliveMsecs:3e5,maxSockets:5}),P=1e4,I=1e3,J="PubNub-JS-Nodejs/3.6.8",W=r(48),V=null,G=function(){var e={};return{get:function(t){return e[t]},set:function(t,n){e[t]=n}}}(),Y=function(e){V=e.proxy,e.xdr=x,e.db=G,e.error=e.error||w,e.hmac_SHA256=b,e.crypto_obj=E(),e.params={pnsdk:J},e.keepAlive===!1&&(K=void 0),SELF=function(e){return Y(e)};var t=_(e);for(var n in t)t.hasOwnProperty(n)&&(SELF[n]=t[n]);return SELF.init=SELF,SELF.secure=SELF,SELF.ready(),SELF};Y.init=Y,Y.unique=i,Y.secure=Y,e.exports=Y,e.exports.PNmessage=y}).call(t,r(49).Buffer)},function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===s?62:t===a?63:c>t?-1:c+10>t?t-c+26+26:l+26>t?t-l:u+26>t?t-u+26:void 0}function r(e){function n(e){u[h++]=e}var r,i,s,a,c,u;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=e.length;c="="===e.charAt(l-2)?2:"="===e.charAt(l-1)?1:0,u=new o(3*e.length/4-c),s=c>0?e.length-4:e.length;var h=0;for(r=0,i=0;s>r;r+=4,i+=3)a=t(e.charAt(r))<<18|t(e.charAt(r+1))<<12|t(e.charAt(r+2))<<6|t(e.charAt(r+3)),n((16711680&a)>>16),n((65280&a)>>8),n(255&a);return 2===c?(a=t(e.charAt(r))<<2|t(e.charAt(r+1))>>4,n(255&a)):1===c&&(a=t(e.charAt(r))<<10|t(e.charAt(r+1))<<4|t(e.charAt(r+2))>>2,n(a>>8&255),n(255&a)),u}function i(e){function t(e){return n.charAt(e)}function r(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var i,o,s,a=e.length%3,c="";for(i=0,s=e.length-a;s>i;i+=3)o=(e[i]<<16)+(e[i+1]<<8)+e[i+2],c+=r(o);switch(a){case 1:o=e[e.length-1],c+=t(o>>2),c+=t(o<<4&63),c+="==";break;case 2:o=(e[e.length-2]<<8)+e[e.length-1],c+=t(o>>10),c+=t(o>>4&63),c+=t(o<<2&63),c+="="}return c}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),c="0".charCodeAt(0),u="a".charCodeAt(0),l="A".charCodeAt(0);e.toByteArray=r,e.fromByteArray=i}("undefined"==typeof t?this.base64js={}:t)},function(e,t,n){(function(e){function r(e){if(!(this instanceof r))return new r(e);c.call(this);var t=this;t.defaultPort=80,t.protocol="http:",t.options=a._extend({},e),t.options.path=null,t.requests={},t.sockets={},t.freeSockets={},t.keepAliveMsecs=t.options.keepAliveMsecs||1e3,t.keepAlive=t.options.keepAlive||!1,t.maxSockets=t.options.maxSockets||r.defaultMaxSockets,t.maxFreeSockets=t.options.maxFreeSockets||256,t.on("free",function(e,n){var r=t.getName(n);if(i("agent.on(free)",r),!t.isDestroyed(e)&&t.requests[r]&&t.requests[r].length)t.requests[r].shift().onSocket(e),0===t.requests[r].length&&delete t.requests[r];else{var o=e._httpMessage;if(o&&o.shouldKeepAlive&&!t.isDestroyed(e)&&t.options.keepAlive){var s=t.freeSockets[r],a=s?s.length:0,c=a;t.sockets[r]&&(c+=t.sockets[r].length),c>=t.maxSockets||a>=t.maxFreeSockets?(t.removeSocket(e,n),e.destroy()):(s=s||[],t.freeSockets[r]=s,e.setKeepAlive(!0,t.keepAliveMsecs),e.unref&&e.unref(),e._httpMessage=null,t.removeSocket(e,n),s.push(e))}else t.removeSocket(e,n),e.destroy()}})}var i,o=n(!function(){var e=new Error('Cannot find module "net"');throw e.code="MODULE_NOT_FOUND",e}()),s=n(30),a=n(77),c=n(45).EventEmitter,u=n(29).ClientRequest;i=e.env.NODE_DEBUG&&/agentkeepalive/.test(e.env.NODE_DEBUG)?function(){console.error.apply(console,arguments)}:function(){},a.inherits(r,c),t.Agent=r,r.defaultMaxSockets=1/0,r.prototype.createConnection=o.createConnection,r.prototype.getName=function(e){var t="";return t+=e.host?e.host:"localhost",t+=":",e.port&&(t+=e.port),t+=":",e.localAddress&&(t+=e.localAddress),t+=":"},r.prototype.addRequest=function(e,t){"string"==typeof t&&(t={host:t,port:arguments[2],path:arguments[3]});var n=this.getName(t);this.sockets[n]||(this.sockets[n]=[]);var r=this.freeSockets[n]?this.freeSockets[n].length:0,o=r+this.sockets[n].length;
if(r){var s=this.freeSockets[n].shift();i("have free socket"),this.freeSockets[n].length||delete this.freeSockets[n],s.ref&&s.ref(),e.onSocket(s),this.sockets[n].push(s)}else o<this.maxSockets?(i("call onSocket",o,r),e.onSocket(this.createSocket(e,t))):(i("wait for socket"),this.requests[n]||(this.requests[n]=[]),this.requests[n].push(e))},r.prototype.createSocket=function(e,t){function n(){s.emit("free",l,t)}function r(){i("CLIENT socket onClose"),s.removeSocket(l,t)}function o(){i("CLIENT socket onRemove"),s.removeSocket(l,t,"agentRemove"),l.removeListener("close",r),l.removeListener("free",n),l.removeListener("agentRemove",o)}var s=this;if(t=a._extend({},t),t=a._extend(t,s.options),t.servername=t.host,e){var c=e.getHeader("host");c&&(t.servername=c.replace(/:.*$/,""))}var u=s.getName(t);i("createConnection",u,t);var l=s.createConnection(t);return s.sockets[u]||(s.sockets[u]=[]),this.sockets[u].push(l),i("sockets",u,this.sockets[u].length),l.on("free",n),l.on("close",r),l.on("agentRemove",o),l},r.prototype.removeSocket=function(e,t){var n=this.getName(t);i("removeSocket",n,"destroyed:",this.isDestroyed(e));var r=[this.sockets];if(this.isDestroyed(e)&&r.push(this.freeSockets),r.forEach(function(t){if(t[n]){var r=t[n].indexOf(e);-1!==r&&(t[n].splice(r,1),0===t[n].length&&delete t[n])}}),this.requests[n]&&this.requests[n].length){i("removeSocket, have a request, make a socket");var o=this.requests[n][0];this.createSocket(o,t).emit("free")}},r.prototype.destroy=function(){var e=[this.freeSockets,this.sockets];e.forEach(function(e){Object.keys(e).forEach(function(t){e[t].forEach(function(e){e.destroy()})})})},r.prototype.request=function(e,t){if("string"==typeof e&&(e=s.parse(e)),e.hostname&&(e.host=e.hostname),e&&e.path&&/ /.test(e.path))throw new TypeError("Request path contains unescaped characters.");if(e.protocol&&e.protocol!==this.protocol)throw new Error("Protocol:"+e.protocol+" not supported.");return e=a._extend({agent:this,keepAlive:this.keepAlive},e),e.agent===!1&&(e.agent=new this.constructor),i("agent.request",e),new u(e,t)},r.prototype.get=function(e,t){var n=this.request(e,t);return n.end(),n},r.prototype.isDestroyed=function(e){return e.destroyed||e._destroyed},t.globalAgent=new r}).call(t,n(78))},function(e){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t,n){var r,i;(function(e){!function(o,s){"use strict";"object"==typeof t&&e?e.exports=s():(r=s,i="function"==typeof r?r.call(t,n,t,e):r,!(void 0!==i&&(e.exports=i)))}("object"==typeof window&&window||this,function(){"use strict";function e(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}function t(e){return function(){throw e}}function n(e,n,r){try{e(n,r)}catch(i){setTimeout(t(i),0)}}function r(e,t,n){e(t,n)}function i(e,t,i,o){var s,a=u[t],c=o?r:n;if(u.hasOwnProperty(t))for(s in a)a.hasOwnProperty(s)&&c(a[s],e,i)}function o(e,t,n){return function(){var r=String(e),o=r.lastIndexOf(".");for(i(e,e,t,n);-1!==o;)r=r.substr(0,o),o=r.lastIndexOf("."),i(e,r,t)}}function s(t){for(var n=String(t),r=Boolean(u.hasOwnProperty(n)&&e(u[n])),i=n.lastIndexOf(".");!r&&-1!==i;)n=n.substr(0,i),i=n.lastIndexOf("."),r=Boolean(u.hasOwnProperty(n)&&e(u[n]));return r}function a(e,t,n,r){var i=o(e,t,r),a=s(e);return a?(n===!0?i():setTimeout(i,0),!0):!1}var c={},u={},l=-1;return c.publish=function(e,t){return a(e,t,!1,c.immediateExceptions)},c.publishSync=function(e,t){return a(e,t,!0,c.immediateExceptions)},c.subscribe=function(e,t){if("function"!=typeof t)return!1;u.hasOwnProperty(e)||(u[e]={});var n="uid_"+String(++l);return u[e][n]=t,n},c.unsubscribe=function(e){var t,n,r,i="string"==typeof e,o=!1;for(t in u)if(u.hasOwnProperty(t)){if(n=u[t],i&&n[e]){delete n[e],o=e;break}if(!i)for(r in n)n.hasOwnProperty(r)&&n[r]===e&&(delete n[r],o=!0)}return o},c})}).call(t,n(98)(e))},function(e,t,n){"use strict";var r=n(146).Promise,i=n(147).polyfill;t.Promise=r,t.polyfill=i},function(e,t,n){(function(t){"use strict";e.exports=function(){function e(e){return void 0===e?!1:e instanceof i}function r(e,t){return e instanceof d?t>=0:!1}function i(e){if("function"!=typeof e)throw new E("the promise constructor requires a resolver function");if(this.constructor!==i)throw new E("the promise constructor cannot be invoked directly");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,this._boundTo=void 0,e!==h&&this._resolveFromResolver(e)}function o(e,t){return s(e,d,t===!0&&e._isBound()?e._boundTo:void 0).promise()}function s(t,n,r){var o=null;return y(t)?o=t:(o=i._cast(t,void 0),o!==t?o._setBoundTo(r):e(o)||(o=null)),null!==o?new n(o,r):{promise:function(){return M("expecting an array, a promise or a thenable")}}}var a=n(118),c=n(119),u=n(120),l=n(121),h=function(){},f={},p={e:null},d=n(122)(i,h),v=n(123)(),m=n(124)(p),g=n(125),y=c.isArray,_=c.errorObj,b=c.tryCatch1,w=c.tryCatch2,k=c.tryCatchApply,x=l.RangeError,E=l.TypeError,T=l.CancellationError,S=l.TimeoutError,C=l.RejectionError,A=l.originatesFromRejection,j=l.markAsOriginatingFromRejection,O=l.canAttach,P=c.thrower,M=n(126)(i),R=function(){return new E("circular promise resolution chain")};i.prototype.bind=function(e){var t=new i(h);return t._setTrace(this),t._follow(this),t._setBoundTo(e),this._cancellable()&&(t._setCancellable(),t._cancellationParent=this),t},i.prototype.toString=function(){return"[object Promise]"},i.prototype.caught=i.prototype["catch"]=function(e){var t=arguments.length;if(t>1){var n,r=new Array(t-1),i=0;for(n=0;t-1>n;++n){var o=arguments[n];if("function"!=typeof o){var s=new E("A catch filter must be an error constructor or a filter function");return this._attachExtraTrace(s),void u.invoke(this._reject,this,s)}r[i++]=o}r.length=i,e=arguments[n],this._resetTrace();var a=new m(r,e,this);return this._then(void 0,a.doFilter,void 0,a,void 0)}return this._then(void 0,e,void 0,void 0,void 0)},i.prototype.then=function(e,t,n){return this._then(e,t,n,void 0,void 0)},i.prototype.done=function(e,t,n){var r=this._then(e,t,n,void 0,void 0);r._setIsFinal()},i.prototype.spread=function(e,t){return this._then(e,t,void 0,f,void 0)},i.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},i.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this._settledValue,e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this._settledValue,e.isRejected=!0),e},i.prototype.all=function(){return o(this,!0)},i.is=e,i.all=function(e){return o(e,!1)},i.join=function(){for(var e=arguments.length,t=new Array(e),n=0;e>n;++n)t[n]=arguments[n];return s(t,d,void 0).promise()},i.resolve=i.fulfilled=function(e){var t=new i(h);return t._setTrace(void 0),t._tryFollow(e)?t:(t._cleanValues(),t._setFulfilled(),t._settledValue=e,t)},i.reject=i.rejected=function(e){var t=new i(h);if(t._setTrace(void 0),j(e),t._cleanValues(),t._setRejected(),t._settledValue=e,!O(e)){var n=new Error(e+"");t._setCarriedStackTrace(n)}return t._ensurePossibleRejectionHandled(),t},i.prototype.error=function(e){return this.caught(A,e)},i.prototype._resolveFromSyncValue=function(e){if(e===_)this._cleanValues(),this._setRejected(),this._settledValue=e.e,this._ensurePossibleRejectionHandled();else{var t=i._cast(e,void 0);t instanceof i?this._follow(t):(this._cleanValues(),this._setFulfilled(),this._settledValue=e)}},i.method=function(e){if("function"!=typeof e)throw new E("fn must be a function");return function(){var t;switch(arguments.length){case 0:t=b(e,this,void 0);break;case 1:t=b(e,this,arguments[0]);break;case 2:t=w(e,this,arguments[0],arguments[1]);break;default:for(var n=arguments.length,r=new Array(n),o=0;n>o;++o)r[o]=arguments[o];t=k(e,r,this)}var s=new i(h);return s._setTrace(void 0),s._resolveFromSyncValue(t),s}},i.attempt=i["try"]=function(e,t,n){if("function"!=typeof e)return M("fn must be a function");var r=y(t)?k(e,t,n):b(e,n,t),o=new i(h);return o._setTrace(void 0),o._resolveFromSyncValue(r),o},i.defer=i.pending=function(){var e=new i(h);return e._setTrace(void 0),new g(e)},i.bind=function(e){var t=new i(h);return t._setTrace(void 0),t._setFulfilled(),t._setBoundTo(e),t},i.cast=function(e){var t=i._cast(e,void 0);return t instanceof i?t:i.resolve(t)},i.onPossiblyUnhandledRejection=function(e){v.possiblyUnhandledRejection="function"==typeof e?e:void 0};var I;i.onUnhandledRejectionHandled=function(e){I="function"==typeof e?e:void 0};var F=!1||!("undefined"==typeof t||"string"!=typeof t.execPath||"object"!=typeof t.env||!t.env.BLUEBIRD_DEBUG&&"development"!==t.env.NODE_ENV);i.longStackTraces=function(){if(u.haveItemsQueued()&&F===!1)throw new Error("cannot enable long stack traces after promises have been created");F=v.isSupported()},i.hasLongStackTraces=function(){return F&&v.isSupported()},i.prototype._setProxyHandlers=function(e,t){var n=this._length();if(n>=524282&&(n=0,this._setLength(0)),0===n)this._promise0=t,this._receiver0=e;else{var r=n-5;this[r+3]=t,this[r+4]=e,this[r+0]=this[r+1]=this[r+2]=void 0}this._setLength(n+5)},i.prototype._proxyPromiseArray=function(e,t){this._setProxyHandlers(e,t)},i.prototype._proxyPromise=function(e){e._setProxied(),this._setProxyHandlers(e,-1)},i.prototype._then=function(e,t,n,r,o){var s=void 0!==o,a=s?o:new i(h);if(F&&!s){var c=this._peekContext()===this._traceParent;a._traceParent=c?this._traceParent:this,a._setTrace(this)}!s&&this._isBound()&&a._setBoundTo(this._boundTo);var l=this._addCallbacks(e,t,n,a,r);return!s&&this._cancellable()&&(a._setCancellable(),a._cancellationParent=this),this.isResolved()&&u.invoke(this._queueSettleAt,this,l),a},i.prototype._length=function(){return 524287&this._bitField},i.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},i.prototype._isFollowing=function(){return 536870912===(536870912&this._bitField)},i.prototype._setLength=function(e){this._bitField=-524288&this._bitField|524287&e},i.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},i.prototype._setRejected=function(){this._bitField=134217728|this._bitField},i.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},i.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},i.prototype._isFinal=function(){return(33554432&this._bitField)>0},i.prototype._cancellable=function(){return(67108864&this._bitField)>0},i.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},i.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},i.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},i.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},i.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},i.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},i.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},i.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},i.prototype._setCarriedStackTrace=function(e){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=e},i.prototype._unsetCarriedStackTrace=function(){this._bitField=-1048577&this._bitField,this._fulfillmentHandler0=void 0},i.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},i.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},i.prototype._receiverAt=function(e){var t;return t=0===e?this._receiver0:this[e+4-5],this._isBound()&&void 0===t?this._boundTo:t},i.prototype._promiseAt=function(e){return 0===e?this._promise0:this[e+3-5]},i.prototype._fulfillmentHandlerAt=function(e){return 0===e?this._fulfillmentHandler0:this[e+0-5]},i.prototype._rejectionHandlerAt=function(e){return 0===e?this._rejectionHandler0:this[e+1-5]},i.prototype._unsetAt=function(e){0===e?(this._rejectionHandler0=this._progressHandler0=this._promise0=this._receiver0=void 0,this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0)):this[e-5+0]=this[e-5+1]=this[e-5+2]=this[e-5+3]=this[e-5+4]=void 0},i.prototype._resolveFromResolver=function(e){function t(e){r._tryFollow(e)||r._fulfill(e)}function n(e){var t=O(e)?e:new Error(e+"");r._attachExtraTrace(t),j(e),r._reject(e,t===e?void 0:t)}var r=this;this._setTrace(void 0),this._pushContext();var i=w(e,void 0,t,n);if(this._popContext(),void 0!==i&&i===_){var o=i.e,s=O(o)?o:new Error(o+"");r._reject(o,s)}},i.prototype._addCallbacks=function(e,t,n,r,i){var o=this._length();if(o>=524282&&(o=0,this._setLength(0)),0===o)this._promise0=r,void 0!==i&&(this._receiver0=i),"function"!=typeof e||this._isCarryingStackTrace()||(this._fulfillmentHandler0=e),"function"==typeof t&&(this._rejectionHandler0=t),"function"==typeof n&&(this._progressHandler0=n);else{var s=o-5;this[s+3]=r,this[s+4]=i,this[s+0]="function"==typeof e?e:void 0,this[s+1]="function"==typeof t?t:void 0,this[s+2]="function"==typeof n?n:void 0}return this._setLength(o+5),o},i.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=8388608|this._bitField,this._boundTo=e):this._bitField=-8388609&this._bitField},i.prototype._isBound=function(){return 8388608===(8388608&this._bitField)},i.prototype._spreadSlowCase=function(e,t,n,r){var i=s(n,d,r).promise()._then(function(){return e.apply(r,arguments)},void 0,void 0,f,void 0);t._follow(i)},i.prototype._callSpread=function(t,n,r,o){var s=this._isBound()?this._boundTo:void 0;if(y(r))for(var a=0,c=r.length;c>a;++a)if(e(i._cast(r[a],void 0)))return void this._spreadSlowCase(t,n,r,s);return o&&n._pushContext(),k(t,r,s)},i.prototype._callHandler=function(e,t,n,r,i){var o;return t!==f||this.isRejected()?(i&&n._pushContext(),o=b(e,t,r)):o=this._callSpread(e,n,r,i),i&&n._popContext(),o},i.prototype._settlePromiseFromHandler=function(t,n,r,o){if(!e(o))return void t.call(n,r,o);var s=F,a=this._callHandler(t,n,o,r,s);if(!o._isFollowing())if(a===_||a===o||a===p){var c=a===o?R():a.e,u=O(c)?c:new Error(c+"");a!==p&&o._attachExtraTrace(u),o._rejectUnchecked(c,u)}else{var l=i._cast(a,o);if(e(l)){if(l.isRejected()&&!l._isCarryingStackTrace()&&!O(l._settledValue)){var u=new Error(l._settledValue+"");o._attachExtraTrace(u),l._setCarriedStackTrace(u)}o._follow(l),l._cancellable()&&(o._cancellationParent=l,o._setCancellable())}else o._fulfillUnchecked(a)}},i.prototype._follow=function(e){this._setFollowing(),e.isPending()?(e._cancellable()&&(this._cancellationParent=e,this._setCancellable()),e._proxyPromise(this)):e.isFulfilled()?this._fulfillUnchecked(e._settledValue):this._rejectUnchecked(e._settledValue,e._getCarriedStackTrace()),e._isRejectionUnhandled()&&e._unsetRejectionIsUnhandled(),F&&null==e._traceParent&&(e._traceParent=this)},i.prototype._tryFollow=function(t){if(this._isFollowingOrFulfilledOrRejected()||t===this)return!1;var n=i._cast(t,void 0);return e(n)?(this._follow(n),!0):!1},i.prototype._resetTrace=function(){F&&(this._trace=new v(void 0===this._peekContext()))},i.prototype._setTrace=function(e){if(F){var t=this._peekContext();this._traceParent=t;var n=void 0===t;this._trace=void 0!==e&&e._traceParent===t?e._trace:new v(n)}return this},i.prototype._attachExtraTrace=function(e){if(F){var t=this,n=e.stack;n="string"==typeof n?n.split("\n"):[];for(var r=1;null!=t&&null!=t._trace;)n=v.combine(n,t._trace.stack.split("\n")),t=t._traceParent;var i=Error.stackTraceLimit+r,o=n.length;o>i&&(n.length=i),e.stack=n.length<=r?"(No stack trace)":n.join("\n")}},i.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},i.prototype._fulfill=function(e){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(e)},i.prototype._reject=function(e,t){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(e,t)},i.prototype._settlePromiseAt=function(e){var t=this.isFulfilled()?this._fulfillmentHandlerAt(e):this._rejectionHandlerAt(e),n=this._settledValue,o=this._receiverAt(e),s=this._promiseAt(e);if("function"==typeof t)this._settlePromiseFromHandler(t,o,n,s);else{var a=!1,c=this.isFulfilled();void 0!==o&&(o instanceof i&&o._isProxied()?(o._unsetProxied(),c?o._fulfillUnchecked(n):o._rejectUnchecked(n,this._getCarriedStackTrace()),a=!0):r(o,s)&&(c?o._promiseFulfilled(n,s):o._promiseRejected(n,s),a=!0)),a||(c?s._fulfill(n):s._reject(n,this._getCarriedStackTrace()))}e>=256&&this._queueGC()},i.prototype._isProxied=function(){return 4194304===(4194304&this._bitField)},i.prototype._setProxied=function(){this._bitField=4194304|this._bitField},i.prototype._unsetProxied=function(){this._bitField=-4194305&this._bitField},i.prototype._isGcQueued=function(){return-1073741824===(-1073741824&this._bitField)},i.prototype._setGcQueued=function(){this._bitField=-1073741824|this._bitField},i.prototype._unsetGcQueued=function(){this._bitField=1073741823&this._bitField},i.prototype._queueGC=function(){this._isGcQueued()||(this._setGcQueued(),u.invokeLater(this._gc,this,void 0))},i.prototype._gc=function(){var e=this._length();this._unsetAt(0);for(var t=0;e>t;t++)delete this[t];this._setLength(0),this._unsetGcQueued()},i.prototype._queueSettleAt=function(e){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),u.invoke(this._settlePromiseAt,this,e)},i.prototype._fulfillUnchecked=function(e){if(this.isPending()){if(e===this){var t=R();return this._attachExtraTrace(t),this._rejectUnchecked(t,void 0)}this._cleanValues(),this._setFulfilled(),this._settledValue=e;var n=this._length();n>0&&u.invoke(this._settlePromises,this,n)}},i.prototype._rejectUncheckedCheckError=function(e){var t=O(e)?e:new Error(e+"");this._rejectUnchecked(e,t===e?void 0:t)},i.prototype._rejectUnchecked=function(e,t){if(this.isPending()){if(e===this){var n=R();return this._attachExtraTrace(n),this._rejectUnchecked(n)}if(this._cleanValues(),this._setRejected(),this._settledValue=e,this._isFinal())return void u.invokeLater(P,void 0,void 0===t?e:t);var r=this._length();void 0!==t&&this._setCarriedStackTrace(t),r>0?u.invoke(this._rejectPromises,this,null):this._ensurePossibleRejectionHandled()}},i.prototype._rejectPromises=function(){this._settlePromises(),this._unsetCarriedStackTrace()},i.prototype._settlePromises=function(){for(var e=this._length(),t=0;e>t;t+=5)this._settlePromiseAt(t)},i.prototype._ensurePossibleRejectionHandled=function(){this._setRejectionIsUnhandled(),void 0!==v.possiblyUnhandledRejection&&u.invokeLater(this._notifyUnhandledRejection,this,void 0)},i.prototype._notifyUnhandledRejectionIsHandled=function(){"function"==typeof I&&u.invokeLater(I,void 0,this)},i.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue,t=this._getCarriedStackTrace();this._setUnhandledRejectionIsNotified(),void 0!==t&&(this._unsetCarriedStackTrace(),e=t),"function"==typeof v.possiblyUnhandledRejection&&v.possiblyUnhandledRejection(e,this)}};var L=[];i.prototype._peekContext=function(){var e=L.length-1;return e>=0?L[e]:void 0},i.prototype._pushContext=function(){F&&L.push(this)},i.prototype._popContext=function(){F&&L.pop()};var B=a.Promise;return i.noConflict=function(){return a.Promise===i&&(a.Promise=B),i},v.isSupported()||(i.longStackTraces=function(){},F=!1),i._makeSelfResolutionError=R,n(127)(i,p),n(128)(i),n(129)(i,h),n(130)(i),i.RangeError=x,i.CancellationError=T,i.TimeoutError=S,i.TypeError=E,i.RejectionError=C,c.toFastProperties(i),c.toFastProperties(i.prototype),n(131)(i,h),n(132)(i,s,d),n(133)(i,h),n(134)(i),n(135)(i,s,d,M),n(136)(i,M,h),n(137)(i,d,h,M),n(138)(i),n(139)(i,h),n(140)(i,d),n(141)(i,s,d,M,h),n(142)(i,s,d),n(143)(i,s,d,M),n(144)(i,r),n(145)(i,h),i.prototype=i.prototype,i}}).call(t,n(78))},function(e,t,n){var t=e.exports=function(e){var n=t[e];if(!n)throw new Error(e+" is not supported (we accept pull requests)");return new n},r=n(49).Buffer,i=n(148)(r);t.sha1=n(149)(r,i),t.sha256=n(150)(r,i),t.sha512=n(151)(r,i)},function(e,t,n){(function(t){function n(e,n){if(e.length%o!==0){var r=e.length+(o-e.length%o);e=t.concat([e,s],r)}for(var i=[],a=n?e.readInt32BE:e.readInt32LE,c=0;c<e.length;c+=o)i.push(a.call(e,c));return i}function r(e,n,r){for(var i=new t(n),o=r?i.writeInt32BE:i.writeInt32LE,s=0;s<e.length;s++)o.call(i,e[s],4*s,!0);return i}function i(e,i,o,s){t.isBuffer(e)||(e=new t(e));var c=i(n(e,s),e.length*a);return r(c,o,s)}var o=4,s=new t(o);s.fill(0);var a=8;e.exports={hash:i}}).call(t,n(49).Buffer)},function(e){e.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){t=e.exports=n(153),t.Stream=n(72),t.Readable=t,t.Writable=n(154),t.Duplex=n(155),t.Transform=n(156),t.PassThrough=n(157)},function(e,t,n){e.exports=n(154)},function(e,t,n){e.exports=n(155)},function(e,t,n){e.exports=n(156)},function(e,t,n){e.exports=n(157)},function(e,t,n){(function(t){e.exports=function(e){function n(e,t,n,i,o,s){if("function"==typeof o&&(s=o,o=void 0),"function"!=typeof s)throw new Error("No callback provided to pbkdf2");setTimeout(function(){var a;try{a=r(e,t,n,i,o)}catch(c){return s(c)}s(void 0,a)})}function r(n,r,i,o,s){if("number"!=typeof i)throw new TypeError("Iterations not a number");if(0>i)throw new TypeError("Bad iterations");if("number"!=typeof o)throw new TypeError("Key length not a number");if(0>o)throw new TypeError("Bad key length");s=s||"sha1",t.isBuffer(n)||(n=new t(n)),t.isBuffer(r)||(r=new t(r));var a,c,u,l=1,h=new t(o),f=new t(r.length+4);r.copy(f,0,0,r.length);for(var p=1;l>=p;p++){f.writeUInt32BE(p,r.length);var d=e.createHmac(s,n).update(f).digest();if(!a&&(a=d.length,u=new t(a),l=Math.ceil(o/a),c=o-(l-1)*a,o>(Math.pow(2,32)-1)*a))throw new TypeError("keylen exceeds maximum length");d.copy(u,0,0,a);for(var v=1;i>v;v++){d=e.createHmac(s,n).update(d).digest();for(var m=0;a>m;m++)u[m]^=d[m]}var g=(p-1)*a,y=p==l?c:a;u.copy(h,g,0,y)}return h}return{pbkdf2:n,pbkdf2Sync:r}}}).call(t,n(49).Buffer)},function(e){e.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){(function(t){function n(e,t,n){return e^t^n}function r(e,t,n){return e&t|~e&n}function i(e,t,n){return(e|~t)^n}function o(e,t,n){return e&n|t&~n}function s(e,t,n){return e^(t|~n)}function a(e,t){return e<<t|e>>>32-t}function c(e){var n=[1732584193,4023233417,2562383102,271733878,3285377520];"string"==typeof e&&(e=new t(e,"utf8"));var r=v(e),i=8*e.length,o=8*e.length;r[i>>>5]|=128<<24-i%32,r[(i+64>>>9<<4)+14]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);for(var s=0;s<r.length;s+=16)g(n,r,s);for(var s=0;5>s;s++){var a=n[s];n[s]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var c=m(n);return new t(c)}e.exports=c;var u=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],l=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],h=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],f=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],p=[0,1518500249,1859775393,2400959708,2840853838],d=[1352829926,1548603684,1836072691,2053994217,0],v=function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},m=function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},g=function(e,t,c){for(var v=0;16>v;v++){var m=c+v,g=t[m];t[m]=16711935&(g<<8|g>>>24)|4278255360&(g<<24|g>>>8)}var y,_,b,w,k,x,E,T,S,C;x=y=e[0],E=_=e[1],T=b=e[2],S=w=e[3],C=k=e[4];for(var A,v=0;80>v;v+=1)A=y+t[c+u[v]]|0,A+=16>v?n(_,b,w)+p[0]:32>v?r(_,b,w)+p[1]:48>v?i(_,b,w)+p[2]:64>v?o(_,b,w)+p[3]:s(_,b,w)+p[4],A=0|A,A=a(A,h[v]),A=A+k|0,y=k,k=w,w=a(b,10),b=_,_=A,A=x+t[c+l[v]]|0,A+=16>v?s(E,T,S)+d[0]:32>v?o(E,T,S)+d[1]:48>v?i(E,T,S)+d[2]:64>v?r(E,T,S)+d[3]:n(E,T,S)+d[4],A=0|A,A=a(A,f[v]),A=A+C|0,x=C,C=S,S=a(T,10),T=E,E=A;A=e[1]+b+S|0,e[1]=e[2]+w+C|0,e[2]=e[3]+k+x|0,e[3]=e[4]+y+E|0,e[4]=e[0]+_+T|0,e[0]=A}}).call(t,n(49).Buffer)},function(e,t){(function(t){e.exports=function(){if(void 0!==this)return this;try{return t}catch(e){}try{return window}catch(e){}try{return self}catch(e){}}()}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e){"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("Bluebird: "+e)}function i(e,t,n){try{return e.call(t,n)}catch(r){return _.e=r,_}}function o(e,t,n,r){try{return e.call(t,n,r)}catch(i){return _.e=i,_}}function s(e,t,n){try{return e.apply(n,t)}catch(r){return _.e=r,_}}function a(e){return"string"==typeof e?e:""+e}function c(e){return null==e||e===!0||e===!1||"string"==typeof e||"number"==typeof e}function u(e){return!c(e)}function l(e){return c(e)?new Error(a(e)):e}function h(e,t){var n,r=e.length,i=new Array(r+1);for(n=0;r>n;++n)i[n]=e[n];return i[n]=t,i}function f(e,t,n){if(c(e))return e;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return m.defineProperty(e,t,r),e}function p(e){throw e}function d(e){function t(){}return t.prototype=e,t}var v=n(118),m=n(158),g=function(){try{var e={};return m.defineProperty(e,"f",{get:function(){return 3}}),3===e.f}catch(t){return!1}}(),y=function(){return"undefined"!=typeof window&&null!==window&&"undefined"!=typeof window.document&&"undefined"!=typeof navigator&&null!==navigator&&"string"==typeof navigator.appName&&window===v?!1:!0}(),_={e:{}},b=function(e,t){function n(){this.constructor=e,this.constructor$=t;for(var n in t.prototype)r.call(t.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=t.prototype[n])}var r={}.hasOwnProperty;return n.prototype=t.prototype,e.prototype=new n,e.prototype},w=function(){return"string"!==this}.call("string"),k={thrower:p,isArray:m.isArray,haveGetters:g,notEnumerableProp:f,isPrimitive:c,isObject:u,canEvaluate:y,deprecated:r,errorObj:_,tryCatch1:i,tryCatch2:o,tryCatchApply:s,inherits:b,withAppended:h,asString:a,maybeWrapAsError:l,wrapsPrimitiveReceiver:w,toFastProperties:d};e.exports=k},function(e,t,n){"use strict";function r(){this._isTickUsed=!1,this._length=0,this._lateBuffer=new o,this._functionBuffer=new o(75e3);var e=this;this.consumeFunctionBuffer=function(){e._consumeFunctionBuffer()}}var i=n(159),o=n(160),s=n(119).errorObj,a=n(119).tryCatch1,c=n(118).process;r.prototype.haveItemsQueued=function(){return this._length>0},r.prototype.invokeLater=function(e,t,n){void 0===c||null==c.domain||e.domain||(e=c.domain.bind(e)),this._lateBuffer.push(e,t,n),this._queueTick()},r.prototype.invoke=function(e,t,n){void 0===c||null==c.domain||e.domain||(e=c.domain.bind(e));var r=this._functionBuffer;r.push(e,t,n),this._length=r.length(),this._queueTick()},r.prototype._consumeFunctionBuffer=function(){for(var e=this._functionBuffer;e.length()>0;){var t=e.shift(),n=e.shift(),r=e.shift();t.call(n,r)}this._reset(),this._consumeLateBuffer()},r.prototype._consumeLateBuffer=function(){for(var e=this._lateBuffer;e.length()>0;){var t=e.shift(),n=e.shift(),r=e.shift(),i=a(t,n,r);if(i===s){if(this._queueTick(),null==t.domain)throw i.e;t.domain.emit("error",i.e)}}},r.prototype._queueTick=function(){this._isTickUsed||(i(this.consumeFunctionBuffer),this._isTickUsed=!0)},r.prototype._reset=function(){this._isTickUsed=!1,this._length=0},e.exports=new r},function(e,t,n){"use strict";function r(e){try{p(e,"isAsync",!0)}catch(t){}}function i(e){return null==e?!1:e instanceof c||e.isAsync===!0}function o(e){return e instanceof d}function s(e){return o(e)}function a(e,t){function n(r){return this instanceof n?(this.message="string"==typeof r?r:t,this.name=e,void(d.captureStackTrace&&d.captureStackTrace(this,this.constructor))):new n(r)}return f(n,d),n}function c(e){this.name="RejectionError",this.message=e,this.cause=e,this.isAsync=!0,e instanceof d?(this.message=e.message,this.stack=e.stack):d.captureStackTrace&&d.captureStackTrace(this,this.constructor)}var u=n(118),l=n(158).freeze,h=n(119),f=h.inherits,p=h.notEnumerableProp,d=u.Error,v=u.TypeError;"function"!=typeof v&&(v=a("TypeError","type error"));var m=u.RangeError;"function"!=typeof m&&(m=a("RangeError","range error"));var g=a("CancellationError","cancellation error"),y=a("TimeoutError","timeout error");f(c,d);var _="__BluebirdErrorTypes__",b=u[_];b||(b=l({CancellationError:g,TimeoutError:y,RejectionError:c}),p(u,_,b)),e.exports={Error:d,TypeError:v,RangeError:m,CancellationError:b.CancellationError,RejectionError:b.RejectionError,TimeoutError:b.TimeoutError,originatesFromRejection:i,markAsOriginatingFromRejection:r,canAttach:s}},function(e,t,n){"use strict";e.exports=function(e,t){function r(e){switch(e){case-1:return void 0;case-2:return[];case-3:return{}}}function i(n,r){var i=this._promise=new e(t),o=void 0;n instanceof e&&(o=n,n._cancellable()&&(i._setCancellable(),i._cancellationParent=n),n._isBound()&&i._setBoundTo(r)),i._setTrace(o),this._values=n,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var o=n(121).canAttach,s=n(119),a=n(120),c={}.hasOwnProperty,u=s.isArray;return i.PropertiesPromiseArray=function(){},i.prototype.length=function(){return this._length},i.prototype.promise=function(){return this._promise},i.prototype._init=function(t,n){var o=this._values;if(o instanceof e){if(!o.isFulfilled())return o.isPending()?void o._then(this._init,this._reject,void 0,this,n):(o._unsetRejectionIsUnhandled(),void this._reject(o._settledValue));if(o=o._settledValue,!u(o)){var s=new e.TypeError("expecting an array, a promise or a thenable");return void this.__hardReject__(s)}this._values=o}if(0===o.length)return void this._resolve(r(n));var l,h=o.length,f=h;l=this instanceof i.PropertiesPromiseArray?this._values:new Array(h);for(var p=!1,d=0;h>d;++d){var v=o[d];if(void 0!==v||c.call(o,d)){var m=e._cast(v,void 0);m instanceof e?m.isPending()?m._proxyPromiseArray(this,d):(m._unsetRejectionIsUnhandled(),p=!0):p=!0,l[d]=m}else f--}if(0===f)return void this._resolve(-2===n?l:r(n));if(this._values=l,this._length=f,p){var g=f===h?this._scanDirectValues:this._scanDirectValuesHoled;a.invoke(g,this,h)}},i.prototype._settlePromiseAt=function(t){var n=this._values[t];n instanceof e?n.isFulfilled()?this._promiseFulfilled(n._settledValue,t):n.isRejected()&&this._promiseRejected(n._settledValue,t):this._promiseFulfilled(n,t)},i.prototype._scanDirectValuesHoled=function(e){for(var t=0;e>t&&!this._isResolved();++t)c.call(this._values,t)&&this._settlePromiseAt(t)},i.prototype._scanDirectValues=function(e){for(var t=0;e>t&&!this._isResolved();++t)this._settlePromiseAt(t)},i.prototype._isResolved=function(){return null===this._values},i.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},i.prototype.__hardReject__=i.prototype._reject=function(e){this._values=null;var t=o(e)?e:new Error(e+"");this._promise._attachExtraTrace(t),this._promise._reject(e,t)},i.prototype._promiseProgressed=function(e,t){this._isResolved()||this._promise._progress({index:t,value:e})},i.prototype._promiseFulfilled=function(e,t){if(!this._isResolved()){this._values[t]=e;var n=++this._totalResolved;
n>=this._length&&this._resolve(this._values)}},i.prototype._promiseRejected=function(e){this._isResolved()||(this._totalResolved++,this._reject(e))},i}},function(e,t,n){"use strict";e.exports=function(){function e(e){var n;if("function"==typeof e)n="[function "+(e.name||"anonymous")+"]";else{n=e.toString();var r=/\[object [a-zA-Z0-9$_]+\]/;if(r.test(n))try{var i=JSON.stringify(e);n=i}catch(o){}0===n.length&&(n="(empty array)")}return"(<"+t(n)+">, no stack trace)"}function t(e){var t=41;return e.length<t?e:e.substr(0,t-3)+"..."}function r(e,t){this.captureStackTrace(r,t)}var i=n(119).inherits,o=n(158).defineProperty,s=new RegExp("\\b(?:[a-zA-Z0-9.]+\\$_\\w+|tryCatch(?:1|2|Apply)|new \\w*PromiseArray|\\w*PromiseArray\\.\\w*PromiseArray|setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|process._tickCallback|nextTick|Async\\$\\w+)\\b"),a=null,c=null;i(r,Error),r.prototype.captureStackTrace=function(e,t){u(this,e,t)},r.possiblyUnhandledRejection=function(e){if("object"==typeof console){var t;if("object"==typeof e||"function"==typeof e){var n=e.stack;t="Possibly unhandled "+c(n,e)}else t="Possibly unhandled "+String(e);"function"==typeof console.error||"object"==typeof console.error?console.error(t):("function"==typeof console.log||"object"==typeof console.log)&&console.log(t)}},r.combine=function(e,t){for(var n=e.length-1,r=t.length-1;r>=0;--r){var i=t[r];if(e[n]!==i)break;e.pop(),n--}e.push("From previous event:");for(var o=e.concat(t),c=[],r=0,u=o.length;u>r;++r)s.test(o[r])||r>0&&!a.test(o[r])&&"From previous event:"!==o[r]||c.push(o[r]);return c},r.isSupported=function(){return"function"==typeof u};var u=function l(){if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){a=/^\s*at\s*/,c=function(t,n){return"string"==typeof t?t:void 0!==n.name&&void 0!==n.message?n.name+". "+n.message:e(n)};var t=Error.captureStackTrace;return function(e,n){t(e,n)}}var n=new Error;if("string"==typeof n.stack&&"function"==typeof"".startsWith&&n.stack.startsWith("stackDetection@")&&"stackDetection"===l.name){o(Error,"stackTraceLimit",{writable:!0,enumerable:!1,configurable:!1,value:25}),a=/@/;var r=/[@\n]/;return c=function(t,n){return"string"==typeof t?n.name+". "+n.message+"\n"+t:void 0!==n.name&&void 0!==n.message?n.name+". "+n.message:e(n)},function(e){for(var t=(new Error).stack,n=t.split(r),i=n.length,o="",s=0;i>s;s+=2)o+=n[s],o+="@",o+=n[s+1],o+="\n";e.stack=o}}return c=function(t,n){return"string"==typeof t?t:"object"!=typeof n&&"function"!=typeof n||void 0===n.name||void 0===n.message?e(n):n.name+". "+n.message},null}();return r}},function(e,t,n){"use strict";e.exports=function(e){function t(e,t,n){this._instances=e,this._callback=t,this._promise=n}function r(e,t){var n={},r=s(e,n,t);if(r===a)return r;var i=c(n);return i.length?(a.e=new u("Catch filter must inherit from Error or be a simple predicate function"),a):r}var i=n(119),o=n(121),s=i.tryCatch1,a=i.errorObj,c=n(158).keys,u=o.TypeError;return t.prototype.doFilter=function(t){for(var n=this._callback,i=this._promise,c=i._isBound()?i._boundTo:void 0,u=0,l=this._instances.length;l>u;++u){var h=this._instances[u],f=h===Error||null!=h&&h.prototype instanceof Error;if(f&&t instanceof h){var p=s(n,c,t);return p===a?(e.e=p.e,e):p}if("function"==typeof h&&!f){var d=r(h,t);if(d===a){var v=o.canAttach(a.e)?a.e:new Error(a.e+"");this._promise._attachExtraTrace(v),t=a.e;break}if(d){var p=s(n,c,t);return p===a?(e.e=p.e,e):p}}}return e.e=t,e},t}},function(e,t,n){"use strict";function r(e){return e instanceof Error&&d.getPrototypeOf(e)===Error.prototype}function i(e){var t;return t=r(e)?new h(e):e,u.markAsOriginatingFromRejection(t),t}function o(e){function t(t,n){if(null!==e){if(t){var r=i(c(t));e._attachExtraTrace(r),e._reject(r)}else if(arguments.length>2){for(var o=arguments.length,s=new Array(o-1),a=1;o>a;++a)s[a-1]=arguments[a];e._fulfill(s)}else e._fulfill(n);e=null}}return t}var s,a=n(119),c=a.maybeWrapAsError,u=n(121),l=u.TimeoutError,h=u.RejectionError,f=n(120),p=a.haveGetters,d=n(158);if(s=p?function(e){this.promise=e}:function(e){this.promise=e,this.asCallback=o(e),this.callback=this.asCallback},p){var v={get:function(){return o(this.promise)}};d.defineProperty(s.prototype,"asCallback",v),d.defineProperty(s.prototype,"callback",v)}s._nodebackForPromise=o,s.prototype.toString=function(){return"[object PromiseResolver]"},s.prototype.resolve=s.prototype.fulfill=function(e){var t=this.promise;if(void 0===t||void 0===t._tryFollow)throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");t._tryFollow(e)||f.invoke(t._fulfill,t,e)},s.prototype.reject=function(e){var t=this.promise;if(void 0===t||void 0===t._attachExtraTrace)throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");u.markAsOriginatingFromRejection(e);var n=u.canAttach(e)?e:new Error(e+"");t._attachExtraTrace(n),f.invoke(t._reject,t,e),n!==e&&f.invoke(this._setCarriedStackTrace,this,n)},s.prototype.progress=function(e){f.invoke(this.promise._progress,this.promise,e)},s.prototype.cancel=function(){f.invoke(this.promise.cancel,this.promise,void 0)},s.prototype.timeout=function(){this.reject(new l("timeout"))},s.prototype.isResolved=function(){return this.promise.isResolved()},s.prototype.toJSON=function(){return this.promise.toJSON()},s.prototype._setCarriedStackTrace=function(e){this.promise.isRejected()&&this.promise._setCarriedStackTrace(e)},e.exports=s},function(e,t,n){"use strict";e.exports=function(e){function t(t){var n=new r(t),i=e.rejected(n),o=i._peekContext();return null!=o&&o._attachExtraTrace(n),i}var r=n(121).TypeError;return t}},function(e,t,n){"use strict";e.exports=function(e,t){function r(){return this}function i(){throw this}function o(e){return function(){return e}}function s(e){return function(){throw e}}function a(e,t,n){var a;return a=h&&f(t)?n?o(t):s(t):n?r:i,e._then(a,p,void 0,t,void 0)}function c(n){var r=this.promise,i=this.handler,o=r._isBound()?i.call(r._boundTo):i();if(void 0!==o){var s=e._cast(o,void 0);if(s instanceof e)return a(s,n,r.isFulfilled())}return r.isRejected()?(t.e=n,t):n}function u(t){var n=this.promise,r=this.handler,i=n._isBound()?r.call(n._boundTo,t):r(t);if(void 0!==i){var o=e._cast(i,void 0);if(o instanceof e)return a(o,t,!0)}return t}var l=n(119),h=l.wrapsPrimitiveReceiver,f=l.isPrimitive,p=l.thrower;e.prototype._passThroughHandler=function(e,t){if("function"!=typeof e)return this.then();var n={promise:this,handler:e};return this._then(t?c:u,t?c:void 0,void 0,n,void 0)},e.prototype.lastly=e.prototype["finally"]=function(e){return this._passThroughHandler(e,!0)},e.prototype.tap=function(e){return this._passThroughHandler(e,!1)}}},function(e,t,n){"use strict";var r=n(119),i=r.isPrimitive,o=r.wrapsPrimitiveReceiver;e.exports=function(e){var t=function(){return this},n=function(){throw this},r=function(e,t){return 1===t?function(){throw e}:2===t?function(){return e}:void 0};e.prototype["return"]=e.prototype.thenReturn=function(e){return o&&i(e)?this._then(r(e,2),void 0,void 0,void 0,void 0):this._then(t,void 0,void 0,e,void 0)},e.prototype["throw"]=e.prototype.thenThrow=function(e){return o&&i(e)?this._then(r(e,1),void 0,void 0,void 0,void 0):this._then(n,void 0,void 0,e,void 0)}}},function(e,t,n){"use strict";e.exports=function(e,t){function r(e){try{return e.then}catch(t){return u.e=t,u}}function i(n,i){if(l(n)){if(n instanceof e)return n;if(o(n)){var a=new e(t);return a._setTrace(void 0),n._then(a._fulfillUnchecked,a._rejectUncheckedCheckError,a._progressUnchecked,a,null),a._setFollowing(),a}var h=r(n);if(h===u)return void 0!==i&&c(h.e)&&i._attachExtraTrace(h.e),e.reject(h.e);if("function"==typeof h)return s(n,h,i)}return n}function o(e){return h.call(e,"_promise0")}function s(t,n,r){function i(n){if(!u){if(u=!0,t===n){var i=e._makeSelfResolutionError();return void 0!==r&&r._attachExtraTrace(i),void a.promise._reject(i,void 0)}a.resolve(n)}}function o(e){if(!u){u=!0;var t=c(e)?e:new Error(e+"");void 0!==r&&r._attachExtraTrace(t),a.promise._reject(e,t)}}function s(e){if(!u){var t=a.promise;"function"==typeof t._progress&&t._progress(e)}}var a=e.defer(),u=!1;try{n.call(t,i,o,s)}catch(l){if(!u){u=!0;var h=c(l)?l:new Error(l+"");void 0!==r&&r._attachExtraTrace(h),a.promise._reject(l,h)}}return a.promise}var a=n(119),c=n(121).canAttach,u=a.errorObj,l=a.isObject,h={}.hasOwnProperty;e._cast=i}},function(e){"use strict";e.exports=function(e){function t(e){void 0!==e?(this._bitField=e._bitField,this._settledValue=e.isResolved()?e._settledValue:void 0):(this._bitField=0,this._settledValue=void 0)}t.prototype.isFulfilled=e.prototype.isFulfilled=function(){return(268435456&this._bitField)>0},t.prototype.isRejected=e.prototype.isRejected=function(){return(134217728&this._bitField)>0},t.prototype.isPending=e.prototype.isPending=function(){return 0===(402653184&this._bitField)},t.prototype.value=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise");return this._settledValue},t.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise");return this._settledValue},t.prototype.isResolved=e.prototype.isResolved=function(){return(402653184&this._bitField)>0},e.prototype.inspect=function(){return new t(this)},e.PromiseInspection=t}},function(e,t,n){"use strict";var r=n(118),i=function(e,t){for(var n=arguments.length,i=new Array(n-2),o=2;n>o;++o)i[o-2]=arguments[o];r.setTimeout(function(){e.apply(void 0,i)},t)};e.exports=function(e,t){var r=(n(119),n(121)),o=(n(126)(e),e.TimeoutError),s=function(e,t,n){if(e.isPending()){"string"!=typeof t&&(t="operation timed out after "+n+" ms");var i=new o(t);r.markAsOriginatingFromRejection(i),e._attachExtraTrace(i),e._rejectUnchecked(i)}},a=function(e,t){t._fulfill(e)},c=e.delay=function(n,r){void 0===r&&(r=n,n=void 0),r=+r;var o=e._cast(n,void 0),s=new e(t);return o instanceof e?(o._isBound()&&s._setBoundTo(o._boundTo),o._cancellable()&&(s._setCancellable(),s._cancellationParent=o),s._setTrace(o),s._follow(o),s.then(function(t){return e.delay(t,r)})):(s._setTrace(void 0),i(a,r,n,s),s)};e.prototype.delay=function(e){return c(this,e)},e.prototype.timeout=function(n,r){n=+n;var o=new e(t);return o._setTrace(this),this._isBound()&&o._setBoundTo(this._boundTo),this._cancellable()&&(o._setCancellable(),o._cancellationParent=this),o._follow(this),i(s,n,o,r,n),o}}},function(e,t,n){"use strict";e.exports=function(e,t,r){function i(e,n){var r=t(e,o,n===!0&&e._isBound()?e._boundTo:void 0),i=r.promise();return i.isRejected()?i:(r.setHowMany(1),r.setUnwrap(),r.init(),i)}var o=n(161)(r);e.any=function(e){return i(e,!1)},e.prototype.any=function(){return i(this,!0)}}},function(e,t,n){"use strict";e.exports=function(e,t){function r(n,r){var c=e._cast(n,void 0);if(c instanceof e)return s(c);if(!o(n))return i("expecting an array, a promise or a thenable");var u=new e(t);u._setTrace(r),void 0!==r&&(r._isBound()&&u._setBoundTo(r._boundTo),r._cancellable()&&(u._setCancellable(),u._cancellationParent=r));for(var l=u._fulfill,h=u._reject,f=0,p=n.length;p>f;++f){var d=n[f];(void 0!==d||a.call(n,f))&&e.cast(d)._then(l,h,void 0,u,null)}return u}var i=n(126)(e),o=n(119).isArray,s=function(e){return e.then(function(t){return r(t,e)})},a={}.hasOwnProperty;e.race=function(e){return r(e,void 0)},e.prototype.race=function(){return r(this,void 0)}}},function(e){"use strict";e.exports=function(e){function t(e){var t="string"==typeof this?this:""+this;return e[t]}e.prototype.call=function(e){for(var t=arguments.length,n=new Array(t-1),r=1;t>r;++r)n[r-1]=arguments[r];return this._then(function(t){return t[e].apply(t,n)},void 0,void 0,void 0,void 0)},e.prototype.get=function(e){return this._then(t,void 0,void 0,e,void 0)}}},function(e,t,n){"use strict";e.exports=function(e){function t(t){for(var n=this instanceof e?this._settledValue:this,r=n.length,i=new Array(r),o=0,s=0;r>s;++s)t[s]&&(i[o++]=n[s]);return i.length=o,i}var r=(n(119).isArray,{ref:null});e.filter=function(n,i){return e.map(n,i,r)._then(t,void 0,void 0,r.ref,void 0)},e.prototype.filter=function(e){return this.map(e,r)._then(t,void 0,void 0,r.ref,void 0)}}},function(e,t,n){"use strict";e.exports=function(e,t,r){var i=n(162)(e,r),o=n(121),s=o.TypeError,a=n(119).deprecated;e.coroutine=function(e){if("function"!=typeof e)throw new s("generatorFunction must be a function");var t=i;return function(){var n=e.apply(this,arguments),r=new t(void 0,void 0);return r._generator=n,r._next(void 0),r.promise()}},e.coroutine.addYieldHandler=i.addYieldHandler,e.spawn=function(n){if(a("Promise.spawn is deprecated. Use Promise.coroutine instead."),"function"!=typeof n)return t("generatorFunction must be a function");var r=new i(n,this),o=r.promise();return r._run(e.spawn),o}}},function(e,t,n){"use strict";e.exports=function(e,t,r,i){function o(e){return s(e,this[0],this[1],this[2])}function s(t,n,s,c){if("function"!=typeof n)return i("fn must be a function");var u=void 0;s===!0?t._isBound()&&(u=t._boundTo):s!==!1&&(u=s);var l=void 0!==c;if(l&&(c.ref=t),t instanceof e){var f=[n,u,c];return t._then(o,void 0,void 0,f,void 0)}if(!h(t))return i("expecting an array, a promise or a thenable");var p=new e(r);void 0!==u&&p._setBoundTo(u),p._setTrace(void 0);var d=new a(p,n,t,u,l);return d.init(),p}function a(e,t,n,r,i){this.shouldUnwrapItems=i,this.index=0,this.items=n,this.callback=t,this.receiver=r,this.promise=e,this.result=new Array(n.length)}var c=e.all,u=n(119),l=n(121).canAttach,h=u.isArray,f=e._cast,p={};u.inherits(a,t),a.prototype.init=function(){for(var t=this.items,n=t.length,r=this.result,i=!1,o=0;n>o;++o){var s=f(t[o],void 0);s instanceof e?s.isPending()?(r[o]=p,s._proxyPromiseArray(this,o)):s.isFulfilled()?r[o]=s.value():(s._unsetRejectionIsUnhandled(),i||(this.reject(s.reason()),i=!0)):r[o]=s}i||this.iterate()},a.prototype.isResolved=function(){return null===this.promise},a.prototype._promiseProgressed=function(e){this.isResolved()||this.promise._progress(e)},a.prototype._promiseFulfilled=function(e,t){this.isResolved()||(this.result[t]=e,this.shouldUnwrapItems&&(this.items[t]=e),this.index===t&&this.iterate())},a.prototype._promiseRejected=function(e){this.reject(e)},a.prototype.reject=function(e){if(!this.isResolved()){var t=l(e)?e:new Error(e+"");this.promise._attachExtraTrace(t),this.promise._reject(e,t)}},a.prototype.iterate=function(){for(var e=this.index,t=this.items,n=this.result,r=t.length,n=this.result,i=this.receiver,o=this.callback;r>e;++e){var s=n[e];if(s===p)return void(this.index=e);try{n[e]=o.call(i,s,e,r)}catch(a){return this.reject(a)}}this.promise._follow(c(n)),this.items=this.result=this.callback=this.promise=null},e.prototype.map=function(e,t){return s(this,e,!0,t)},e.map=function(e,t,n){return s(e,t,!1,n)}}},function(e,t,n){"use strict";e.exports=function(e){function t(e){throw e}function r(e,n){var r=this,i=void 0===e?c(r,n,null):a(r,n,null,e);i===u&&s.invokeLater(t,void 0,i.e)}function i(e,n){var r=this,i=c(r,n,e);i===u&&s.invokeLater(t,void 0,i.e)}var o=n(119),s=n(120),a=o.tryCatch2,c=o.tryCatch1,u=o.errorObj;e.prototype.nodeify=function(e){return"function"==typeof e&&this._then(r,i,void 0,e,this._isBound()?this._boundTo:null),this}}},function(e,t,n){"use strict";e.exports=function(e,t){function r(e){return e.__isPromisified__===!0}function i(e,t){var n=t+"Async"in e;return n?r(e[t+"Async"]):!1}function o(e){for(var t=0;t<e.length;t+=2){var n=e[t];if(k.test(n))for(var r=n.replace(k,""),i=0;i<e.length;i+=2)if(e[i]===r)throw new w("Cannot promisify an API that has normal methods with Async-suffix")}}function s(e){for(var t=[e],n=Math.max(0,e-1-5),r=e-1;r>=n;--r)r!==e&&t.push(r);for(var r=e+1;5>=r;++r)t.push(r);return t}function a(e){for(var t=new Array(e),n=0;n<t.length;++n)t[n]="_arg"+n;return t.join(", ")}function c(e){return"number"==typeof e.length?Math.max(Math.min(e.length,1024),0):0}function u(e){return E.test(e)?"."+e:"['"+e.replace(/(['\\])/g,"\\$1")+"']"}function l(n,r,i,o){function l(e){for(var t=new Array(e),i=0,o=t.length;o>i;++i)t[i]="arguments["+i+"]";var s=e>0?",":"";return"string"==typeof n&&r===p?"this"+u(n)+"("+t.join(",")+s+" fn);break;":(void 0===r?"callback("+t.join(",")+s+" fn);":"callback.call("+(r===p?"this":"receiver")+", "+t.join(",")+s+" fn);")+"break;"}function h(){for(var e="",t=0;t<d.length;++t)e+="case "+d[t]+":"+l(d[t]);return e+="default: var args = new Array(len + 1);var i = 0;for (var i = 0; i < len; ++i) {    args[i] = arguments[i];}args[i] = fn;"+("string"==typeof n?"this"+u(n)+".apply(":"callback.apply(")+(r===p?"this":"receiver")+", args); break;"}var f=Math.max(0,c(o)-1),d=s(f),v="string"==typeof i?i+"Async":"promisified";return E.test(v)||(v="promisified"),new Function("Promise","callback","receiver","withAppended","maybeWrapAsError","nodebackForPromise","INTERNAL","var ret = function "+v+"("+a(f)+') {"use strict";var len = arguments.length;var promise = new Promise(INTERNAL);promise._setTrace(void 0);var fn = nodebackForPromise(promise);try {switch(len) {'+h()+"}}catch(e){ var wrapped = maybeWrapAsError(e);promise._attachExtraTrace(wrapped);promise._reject(wrapped);}return promise;}; ret.__isPromisified__ = true; return ret;")(e,n,r,g,y,m,t)}function h(n,r){function i(){var i=r;r===p&&(i=this),"string"==typeof n&&(n=i[n]);var o=new e(t);o._setTrace(void 0);var s=m(o);try{n.apply(i,g(arguments,s))}catch(a){var c=y(a);o._attachExtraTrace(c),o._reject(c)}return o}return i.__isPromisified__=!0,i}function f(e,t,n){if(n){for(var r=x(e),i=0,o=r.length;o>i;i+=2){var s=r[i],a=r[i+1],c=s+"Async";e[c]=T(s,p,s,a)}return d.toFastProperties(e),e}return T(e,t,void 0,e)}var p={},d=n(119),v=n(158),m=n(125)._nodebackForPromise,g=d.withAppended,y=d.maybeWrapAsError,_=d.canEvaluate,b=d.deprecated,w=n(121).TypeError,k=new RegExp("Async$"),x=function(){if(v.isES5){var e=Object.create,t=Object.getOwnPropertyDescriptor;return function(n){for(var s=[],a=e(null),c=n;null!==n;){for(var u=v.keys(n),l=0,h=u.length;h>l;++l){var f=u[l];if(!a[f]){a[f]=!0;var p=t(n,f);null==p||"function"!=typeof p.value||r(p.value)||i(c,f)||s.push(f,p.value)}}n=v.getPrototypeOf(n)}return o(s),s}}return function(e){var t=[];for(var n in e){var s=e[n];"function"!=typeof s||r(s)||i(e,n)||t.push(n,s)}return o(t),t}}(),E=/^[a-z$_][a-z$_0-9]*$/i,T=_?l:h;e.promisify=function(e,t){if("object"==typeof e&&null!==e)return b("Promise.promisify for promisifying entire objects is deprecated. Use Promise.promisifyAll instead."),f(e,t,!0);if("function"!=typeof e)throw new w("fn must be a function");return r(e)?e:f(e,arguments.length<2?p:t,!1)},e.promisifyAll=function(e){if("function"!=typeof e&&"object"!=typeof e)throw new w("the target of promisifyAll must be an object or a function");return f(e,void 0,!0)}}},function(e,t,n){"use strict";e.exports=function(e,t){function r(t,n){var r,o=e._cast(t,void 0);return a(o)?(o instanceof e?r=o._then(e.props,void 0,void 0,void 0,void 0):(r=new i(o,n===!0&&o._isBound()?o._boundTo:void 0).promise(),n=!1),n===!0&&o._isBound()&&r._setBoundTo(o._boundTo),r):s("cannot await properties of a non-object")}var i=n(163)(e,t),o=n(119),s=n(126)(e),a=o.isObject;e.prototype.props=function(){return r(this,!0)},e.props=function(e){return r(e,!1)}}},function(e){"use strict";e.exports=function(e,t,n,r,i){function o(t,n,r,o,s){this.promise=new e(i),this.index=n,this.length=o.length,this.items=o,this.callback=t,this.receiver=s,this.accum=r}function s(e,t){var n=this,r=void 0;"function"!=typeof n&&(r=n.receiver,n=n.fn);var i=e.length,s=void 0,a=0;void 0!==t?(s=t,a=0):(a=1,i>0&&(s=e[0]));var c=a;if(c>=i)return s;var u=new o(n,c,s,e,r);return u.iterate(),u.promise}function a(e){var t=this.fn,n=this.initialValue;return s.call(t,e,n)}function c(e,t,n,r){return n._then(function(n){return u(e,t,n,r)},void 0,void 0,void 0,void 0)}function u(i,o,u,l){if("function"!=typeof o)return r("fn must be a function");if(l===!0&&i._isBound()&&(o={fn:o,receiver:i._boundTo}),void 0!==u){if(u instanceof e){if(!u.isFulfilled())return c(i,o,u,l);u=u._settledValue}return t(i,n,l===!0&&i._isBound()?i._boundTo:void 0).promise()._then(a,void 0,void 0,{fn:o,initialValue:u},void 0)}return t(i,n,l===!0&&i._isBound()?i._boundTo:void 0).promise()._then(s,void 0,void 0,o,void 0)}o.prototype.reject=function(e){this.promise._reject(e)},o.prototype.fulfill=function(e,t){this.accum=e,this.index=t+1,this.iterate()},o.prototype.iterate=function(){for(var t=this.index,n=this.length,r=this.items,i=this.accum,o=this.receiver,s=this.callback;n>t;++t)if(i=s.call(o,i,r[t],t,n),i=e._cast(i,void 0),i instanceof e)return void i._then(this.fulfill,this.reject,void 0,this,t);this.promise._fulfill(i)},e.reduce=function(e,t,n){return u(e,t,n,!1)},e.prototype.reduce=function(e,t){return u(this,e,t,!0)}}},function(e,t,n){"use strict";e.exports=function(e,t,r){function i(e,n){return t(e,o,n===!0&&e._isBound()?e._boundTo:void 0).promise()}var o=n(164)(e,r);e.settle=function(e){return i(e,!1)},e.prototype.settle=function(){return i(this,!0)}}},function(e,t,n){"use strict";e.exports=function(e,t,r,i){function o(e,n,r){if((0|n)!==n||0>n)return i("expecting a positive integer");var o=t(e,s,r===!0&&e._isBound()?e._boundTo:void 0),a=o.promise();return a.isRejected()?a:(o.setHowMany(n),o.init(),a)}var s=n(161)(r);e.some=function(e,t){return o(e,t,!1)},e.prototype.some=function(e){return o(this,e,!0)}}},function(e,t,n){"use strict";e.exports=function(e,t){var r=n(119),i=n(120),o=n(121),s=r.tryCatch1,a=r.errorObj;e.prototype.progressed=function(e){return this._then(void 0,void 0,e,void 0,void 0)},e.prototype._progress=function(e){this._isFollowingOrFulfilledOrRejected()||this._progressUnchecked(e)},e.prototype._progressHandlerAt=function(e){return 0===e?this._progressHandler0:this[e+2-5]},e.prototype._doProgressWith=function(t){var n=t.value,r=t.handler,i=t.promise,c=t.receiver;this._pushContext();var u=s(r,c,n);if(this._popContext(),u===a){if(null!=u.e&&"StopProgressPropagation"!==u.e.name){var l=o.canAttach(u.e)?u.e:new Error(u.e+"");i._attachExtraTrace(l),i._progress(u.e)}}else u instanceof e?u._then(i._progress,null,null,i,void 0):i._progress(u)},e.prototype._progressUnchecked=function(n){if(this.isPending())for(var r=this._length(),o=this._progress,s=0;r>s;s+=5){var a=this._progressHandlerAt(s),c=this._promiseAt(s);if(c instanceof e)"function"==typeof a?i.invoke(this._doProgressWith,this,{handler:a,promise:c,receiver:this._receiverAt(s),value:n}):i.invoke(o,c,n);else{var u=this._receiverAt(s);"function"==typeof a?a.call(u,n,c):u instanceof e&&u._isProxied()?u._progressUnchecked(n):t(u,c)&&u._promiseProgressed(n,c)}}}}},function(e,t,n){"use strict";e.exports=function(e,t){var r=n(121),i=n(120),o=r.CancellationError;e.prototype._cancel=function(){if(!this.isCancellable())return this;for(var e,t=this;void 0!==(e=t._cancellationParent)&&e.isCancellable();)t=e;var n=new o;t._attachExtraTrace(n),t._rejectUnchecked(n)},e.prototype.cancel=function(){return this.isCancellable()?(i.invokeLater(this._cancel,this,void 0),this):this},e.prototype.cancellable=function(){return this._cancellable()?this:(this._setCancellable(),this._cancellationParent=void 0,this)},e.prototype.uncancellable=function(){var n=new e(t);return n._setTrace(this),n._follow(this),n._unsetCancellable(),this._isBound()&&n._setBoundTo(this._boundTo),n},e.prototype.fork=function(e,t,n){var r=this._then(e,t,n,void 0,void 0);return r._setCancellable(),r._cancellationParent=void 0,r}}},function(e,t,n){"use strict";function r(e){if(!m(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof r))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],i(e,this)}function i(e,t){function n(e){u(t,e)}function r(e){h(t,e)}try{e(n,r)}catch(i){r(i)}}function o(e,t,n,r){var i,o,s,a,l=m(n);if(l)try{i=n(r),s=!0}catch(f){a=!0,o=f}else i=r,s=!0;c(t,i)||(l&&s?u(t,i):a?h(t,o):e===E?u(t,i):e===T&&h(t,i))}function s(e,t,n,r){var i=e._subscribers,o=i.length;i[o]=t,i[o+E]=n,i[o+T]=r}function a(e,t){for(var n,r,i=e._subscribers,s=e._detail,a=0;a<i.length;a+=3)n=i[a],r=i[a+t],o(t,n,r,s);e._subscribers=null}function c(e,t){var n,r=null;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(v(t)&&(r=t.then,m(r)))return r.call(t,function(r){return n?!0:(n=!0,void(t!==r?u(e,r):l(e,r)))},function(t){return n?!0:(n=!0,void h(e,t))}),!0}catch(i){return n?!0:(h(e,i),!0)}return!1}function u(e,t){e===t?l(e,t):c(e,t)||l(e,t)}function l(e,t){e._state===k&&(e._state=x,e._detail=t,d.async(f,e))}function h(e,t){e._state===k&&(e._state=x,e._detail=t,d.async(p,e))}function f(e){a(e,e._state=E)}function p(e){a(e,e._state=T)}var d=n(165).config,v=(n(165).configure,n(166).objectOrFunction),m=n(166).isFunction,g=(n(166).now,n(167).all),y=n(168).race,_=n(169).resolve,b=n(170).reject,w=n(171).asap;d.async=w;var k=void 0,x=0,E=1,T=2;r.prototype={constructor:r,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(e,t){var n=this,r=new this.constructor(function(){});if(this._state){var i=arguments;d.async(function(){o(n._state,r,i[n._state-1],n._detail)})}else s(this,r,e,t);return r},"catch":function(e){return this.then(null,e)}},r.all=g,r.race=y,r.resolve=_,r.reject=b,t.Promise=r},function(e,t,n){(function(e){"use strict";function r(){var t;t="undefined"!=typeof e?e:"undefined"!=typeof window&&window.document?window:self;var n="Promise"in t&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){var e;return new t.Promise(function(t){e=t}),o(e)}();n||(t.Promise=i)}var i=n(146).Promise,o=n(166).isFunction;t.polyfill=r}).call(t,function(){return this}())},function(e){e.exports=function(e){function t(t,n){this._block=new e(t),this._finalSize=n,this._blockSize=t,this._len=0,this._s=0}return t.prototype.init=function(){this._s=0,this._len=0},t.prototype.update=function(t,n){"string"==typeof t&&(n=n||"utf8",t=new e(t,n));for(var r=this._len+=t.length,i=this._s=this._s||0,o=0,s=this._block;r>i;){for(var a=Math.min(t.length,o+this._blockSize-i%this._blockSize),c=a-o,u=0;c>u;u++)s[i%this._blockSize+u]=t[u+o];i+=c,o+=c,i%this._blockSize===0&&this._update(s)}return this._s=i,this},t.prototype.digest=function(e){var t=8*this._len;this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),t%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(t,this._blockSize-4);var n=this._update(this._block)||this._hash();return e?n.toString(e):n},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t}},function(e,t,n){var r=n(77).inherits;e.exports=function(e,t){function n(){return d.length?d.pop().init():this instanceof n?(this._w=p,t.call(this,64,56),this._h=null,void this.init()):new n}function i(e,t,n,r){return 20>e?t&n|~t&r:40>e?t^n^r:60>e?t&n|t&r|n&r:t^n^r}function o(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514}function s(e,t){return e+t|0}function a(e,t){return e<<t|e>>>32-t}var c=0,u=4,l=8,h=12,f=16,p=new("undefined"==typeof Int32Array?Array:Int32Array)(80),d=[];return r(n,t),n.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,t.prototype.init.call(this),this},n.prototype._POOL=d,n.prototype._update=function(e){var t,n,r,c,u,l,h,f,p,d;t=l=this._a,n=h=this._b,r=f=this._c,c=p=this._d,u=d=this._e;for(var v=this._w,m=0;80>m;m++){var g=v[m]=16>m?e.readInt32BE(4*m):a(v[m-3]^v[m-8]^v[m-14]^v[m-16],1),y=s(s(a(t,5),i(m,n,r,c)),s(s(u,g),o(m)));u=c,c=r,r=a(n,30),n=t,t=y}this._a=s(t,l),this._b=s(n,h),this._c=s(r,f),this._d=s(c,p),this._e=s(u,d)},n.prototype._hash=function(){d.length<100&&d.push(this);var t=new e(20);return t.writeInt32BE(0|this._a,c),t.writeInt32BE(0|this._b,u),t.writeInt32BE(0|this._c,l),t.writeInt32BE(0|this._d,h),t.writeInt32BE(0|this._e,f),t},n}},function(e,t,n){var r=n(77).inherits;e.exports=function(e,t){function n(){this.init(),this._w=p,t.call(this,64,56)}function i(e,t){return e>>>t|e<<32-t}function o(e,t){return e>>>t}function s(e,t,n){return e&t^~e&n}function a(e,t,n){return e&t^e&n^t&n}function c(e){return i(e,2)^i(e,13)^i(e,22)}function u(e){return i(e,6)^i(e,11)^i(e,25)}function l(e){return i(e,7)^i(e,18)^o(e,3)}function h(e){return i(e,17)^i(e,19)^o(e,10)}var f=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=new Array(64);return r(n,t),n.prototype.init=function(){return this._a=1779033703,this._b=-1150833019,this._c=1013904242,this._d=-1521486534,this._e=1359893119,this._f=-1694144372,this._g=528734635,this._h=1541459225,this._len=this._s=0,this},n.prototype._update=function(e){var t,n,r,i,o,p,d,v,m,g,y=this._w;t=0|this._a,n=0|this._b,r=0|this._c,i=0|this._d,o=0|this._e,p=0|this._f,d=0|this._g,v=0|this._h;for(var _=0;64>_;_++){var b=y[_]=16>_?e.readInt32BE(4*_):h(y[_-2])+y[_-7]+l(y[_-15])+y[_-16];m=v+u(o)+s(o,p,d)+f[_]+b,g=c(t)+a(t,n,r),v=d,d=p,p=o,o=i+m,i=r,r=n,n=t,t=m+g}this._a=t+this._a|0,this._b=n+this._b|0,this._c=r+this._c|0,this._d=i+this._d|0,this._e=o+this._e|0,this._f=p+this._f|0,this._g=d+this._g|0,this._h=v+this._h|0},n.prototype._hash=function(){var t=new e(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t},n}},function(e,t,n){var r=n(77).inherits;e.exports=function(e,t){function n(){this.init(),this._w=c,t.call(this,128,112)}function i(e,t,n){return e>>>n|t<<32-n}function o(e,t,n){return e&t^~e&n}function s(e,t,n){return e&t^e&n^t&n}var a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],c=new Array(160);
return r(n,t),n.prototype.init=function(){return this._a=1779033703,this._b=-1150833019,this._c=1013904242,this._d=-1521486534,this._e=1359893119,this._f=-1694144372,this._g=528734635,this._h=1541459225,this._al=-205731576,this._bl=-2067093701,this._cl=-23791573,this._dl=1595750129,this._el=-1377402159,this._fl=725511199,this._gl=-79577749,this._hl=327033209,this._len=this._s=0,this},n.prototype._update=function(e){var t,n,r,c,u,l,h,f,p,d,v,m,g,y,_,b,w=this._w;t=0|this._a,n=0|this._b,r=0|this._c,c=0|this._d,u=0|this._e,l=0|this._f,h=0|this._g,f=0|this._h,p=0|this._al,d=0|this._bl,v=0|this._cl,m=0|this._dl,g=0|this._el,y=0|this._fl,_=0|this._gl,b=0|this._hl;for(var k=0;80>k;k++){var x,E,T=2*k;if(16>k)x=w[T]=e.readInt32BE(4*T),E=w[T+1]=e.readInt32BE(4*T+4);else{var S=w[T-30],C=w[T-30+1],A=i(S,C,1)^i(S,C,8)^S>>>7,j=i(C,S,1)^i(C,S,8)^i(C,S,7);S=w[T-4],C=w[T-4+1];var O=i(S,C,19)^i(C,S,29)^S>>>6,P=i(C,S,19)^i(S,C,29)^i(C,S,6),M=w[T-14],R=w[T-14+1],I=w[T-32],F=w[T-32+1];E=j+R,x=A+M+(j>>>0>E>>>0?1:0),E+=P,x=x+O+(P>>>0>E>>>0?1:0),E+=F,x=x+I+(F>>>0>E>>>0?1:0),w[T]=x,w[T+1]=E}var L=s(t,n,r),B=s(p,d,v),N=i(t,p,28)^i(p,t,2)^i(p,t,7),U=i(p,t,28)^i(t,p,2)^i(t,p,7),q=i(u,g,14)^i(u,g,18)^i(g,u,9),D=i(g,u,14)^i(g,u,18)^i(u,g,9),H=a[T],z=a[T+1],K=o(u,l,h),J=o(g,y,_),W=b+D,V=f+q+(b>>>0>W>>>0?1:0);W+=J,V=V+K+(J>>>0>W>>>0?1:0),W+=z,V=V+H+(z>>>0>W>>>0?1:0),W+=E,V=V+x+(E>>>0>W>>>0?1:0);var G=U+B,Y=N+L+(U>>>0>G>>>0?1:0);f=h,b=_,h=l,_=y,l=u,y=g,g=m+W|0,u=c+V+(m>>>0>g>>>0?1:0)|0,c=r,m=v,r=n,v=d,n=t,d=p,p=W+G|0,t=V+Y+(W>>>0>p>>>0?1:0)|0}this._al=this._al+p|0,this._bl=this._bl+d|0,this._cl=this._cl+v|0,this._dl=this._dl+m|0,this._el=this._el+g|0,this._fl=this._fl+y|0,this._gl=this._gl+_|0,this._hl=this._hl+b|0,this._a=this._a+t+(this._al>>>0<p>>>0?1:0)|0,this._b=this._b+n+(this._bl>>>0<d>>>0?1:0)|0,this._c=this._c+r+(this._cl>>>0<v>>>0?1:0)|0,this._d=this._d+c+(this._dl>>>0<m>>>0?1:0)|0,this._e=this._e+u+(this._el>>>0<g>>>0?1:0)|0,this._f=this._f+l+(this._fl>>>0<y>>>0?1:0)|0,this._g=this._g+h+(this._gl>>>0<_>>>0?1:0)|0,this._h=this._h+f+(this._hl>>>0<b>>>0?1:0)|0},n.prototype._hash=function(){function t(e,t,r){n.writeInt32BE(e,r),n.writeInt32BE(t,r+4)}var n=new e(64);return t(this._a,this._al,0),t(this._b,this._bl,8),t(this._c,this._cl,16),t(this._d,this._dl,24),t(this._e,this._el,32),t(this._f,this._fl,40),t(this._g,this._gl,48),t(this._h,this._hl,56),n},n}},function(e,t,n){e.exports=n(173)},function(e,t,n){(function(t){function r(e,t){var r=n(155);e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,t instanceof r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(A||(A=n(175).StringDecoder),this.decoder=new A(e.encoding),this.encoding=e.encoding)}function i(e){n(155);return this instanceof i?(this._readableState=new r(e,this),this.readable=!0,void S.call(this)):new i(e)}function o(e,t,n,r,i){var o=u(t,n);if(o)e.emit("error",o);else if(C.isNullOrUndefined(n))t.reading=!1,t.ended||l(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&i){var a=new Error("stream.unshift() after end event");e.emit("error",a)}else!t.decoder||i||r||(n=t.decoder.write(n)),i||(t.reading=!1),t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&h(e)),p(e,t);else i||(t.reading=!1);return s(t)}function s(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function a(e){if(e>=O)e=O;else{e--;for(var t=1;32>t;t<<=1)e|=e>>t;e++}return e}function c(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||C.isNull(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:0>=e?0:(e>t.highWaterMark&&(t.highWaterMark=a(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function u(e,t){var n=null;return C.isBuffer(t)||C.isString(t)||C.isNullOrUndefined(t)||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function l(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,h(e)}function h(e){var n=e._readableState;n.needReadable=!1,n.emittedReadable||(j("emitReadable",n.flowing),n.emittedReadable=!0,n.sync?t.nextTick(function(){f(e)}):f(e))}function f(e){j("emit readable"),e.emit("readable"),y(e)}function p(e,n){n.readingMore||(n.readingMore=!0,t.nextTick(function(){d(e,n)}))}function d(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(j("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function v(e){return function(){var t=e._readableState;j("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&T.listenerCount(e,"data")&&(t.flowing=!0,y(e))}}function m(e,n){n.resumeScheduled||(n.resumeScheduled=!0,t.nextTick(function(){g(e,n)}))}function g(e,t){t.resumeScheduled=!1,e.emit("resume"),y(e),t.flowing&&!t.reading&&e.read(0)}function y(e){var t=e._readableState;if(j("flow",t.flowing),t.flowing)do var n=e.read();while(null!==n&&t.flowing)}function _(e,t){var n,r=t.buffer,i=t.length,o=!!t.decoder,s=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(s)n=r.shift();else if(!e||e>=i)n=o?r.join(""):E.concat(r,i),r.length=0;else if(e<r[0].length){var a=r[0];n=a.slice(0,e),r[0]=a.slice(e)}else if(e===r[0].length)n=r.shift();else{n=o?"":new E(e);for(var c=0,u=0,l=r.length;l>u&&e>c;u++){var a=r[0],h=Math.min(e-c,a.length);o?n+=a.slice(0,h):a.copy(n,c,0,h),h<a.length?r[0]=a.slice(h):r.shift(),c+=h}}return n}function b(e){var n=e._readableState;if(n.length>0)throw new Error("endReadable called on non-empty stream");n.endEmitted||(n.ended=!0,t.nextTick(function(){n.endEmitted||0!==n.length||(n.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function w(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n],n)}function k(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1}e.exports=i;var x=n(174),E=n(49).Buffer;i.ReadableState=r;var T=n(45).EventEmitter;T.listenerCount||(T.listenerCount=function(e,t){return e.listeners(t).length});var S=n(72),C=n(176);C.inherits=n(109);var A,j=n(172);j=j&&j.debuglog?j.debuglog("stream"):function(){},C.inherits(i,S),i.prototype.push=function(e,t){var n=this._readableState;return C.isString(e)&&!n.objectMode&&(t=t||n.defaultEncoding,t!==n.encoding&&(e=new E(e,t),t="")),o(this,n,e,t,!1)},i.prototype.unshift=function(e){var t=this._readableState;return o(this,t,e,"",!0)},i.prototype.setEncoding=function(e){return A||(A=n(175).StringDecoder),this._readableState.decoder=new A(e),this._readableState.encoding=e,this};var O=8388608;i.prototype.read=function(e){j("read",e);var t=this._readableState,n=e;if((!C.isNumber(e)||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return j("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?b(this):h(this),null;if(e=c(e,t),0===e&&t.ended)return 0===t.length&&b(this),null;var r=t.needReadable;j("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,j("length less than watermark",r)),(t.ended||t.reading)&&(r=!1,j("reading or ended",r)),r&&(j("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=c(n,t));var i;return i=e>0?_(e,t):null,C.isNull(i)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),n!==e&&t.ended&&0===t.length&&b(this),C.isNull(i)||this.emit("data",i),i},i.prototype._read=function(){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(e,n){function r(e){j("onunpipe"),e===h&&o()}function i(){j("onend"),e.end()}function o(){j("cleanup"),e.removeListener("close",c),e.removeListener("finish",u),e.removeListener("drain",m),e.removeListener("error",a),e.removeListener("unpipe",r),h.removeListener("end",i),h.removeListener("end",o),h.removeListener("data",s),!f.awaitDrain||e._writableState&&!e._writableState.needDrain||m()}function s(t){j("ondata");var n=e.write(t);!1===n&&(j("false write response, pause",h._readableState.awaitDrain),h._readableState.awaitDrain++,h.pause())}function a(t){j("onerror",t),l(),e.removeListener("error",a),0===T.listenerCount(e,"error")&&e.emit("error",t)}function c(){e.removeListener("finish",u),l()}function u(){j("onfinish"),e.removeListener("close",c),l()}function l(){j("unpipe"),h.unpipe(e)}var h=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=e;break;case 1:f.pipes=[f.pipes,e];break;default:f.pipes.push(e)}f.pipesCount+=1,j("pipe count=%d opts=%j",f.pipesCount,n);var p=(!n||n.end!==!1)&&e!==t.stdout&&e!==t.stderr,d=p?i:o;f.endEmitted?t.nextTick(d):h.once("end",d),e.on("unpipe",r);var m=v(h);return e.on("drain",m),h.on("data",s),e._events&&e._events.error?x(e._events.error)?e._events.error.unshift(a):e._events.error=[a,e._events.error]:e.on("error",a),e.once("close",c),e.once("finish",u),e.emit("pipe",h),f.flowing||(j("pipe resume"),h.resume()),e},i.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;r>i;i++)n[i].emit("unpipe",this);return this}var i=k(t.pipes,e);return-1===i?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},i.prototype.on=function(e,n){var r=S.prototype.on.call(this,e,n);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&this.readable){var i=this._readableState;if(!i.readableListening)if(i.readableListening=!0,i.emittedReadable=!1,i.needReadable=!0,i.reading)i.length&&h(this,i);else{var o=this;t.nextTick(function(){j("readable nexttick read 0"),o.read(0)})}}return r},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var e=this._readableState;return e.flowing||(j("resume"),e.flowing=!0,e.reading||(j("resume read 0"),this.read(0)),m(this,e)),this},i.prototype.pause=function(){return j("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(j("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(j("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(j("wrapped data"),t.decoder&&(i=t.decoder.write(i)),i&&(t.objectMode||i.length)){var o=r.push(i);o||(n=!0,e.pause())}});for(var i in e)C.isFunction(e[i])&&C.isUndefined(this[i])&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return w(o,function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){j("wrapped _read",t),n&&(n=!1,e.resume())},r},i._fromList=_}).call(t,n(78))},function(e,t,n){(function(t){function r(e,t,n){this.chunk=e,this.encoding=t,this.callback=n}function i(e,t){var r=n(155);e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.objectMode=!!e.objectMode,t instanceof r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var s=e.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){p(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function o(e){var t=n(155);return this instanceof o||this instanceof t?(this._writableState=new i(e,this),this.writable=!0,void x.call(this)):new o(e)}function s(e,n,r){var i=new Error("write after end");e.emit("error",i),t.nextTick(function(){r(i)})}function a(e,n,r,i){var o=!0;if(!(k.isBuffer(r)||k.isString(r)||k.isNullOrUndefined(r)||n.objectMode)){var s=new TypeError("Invalid non-string/buffer chunk");e.emit("error",s),t.nextTick(function(){i(s)}),o=!1}return o}function c(e,t,n){return!e.objectMode&&e.decodeStrings!==!1&&k.isString(t)&&(t=new w(t,n)),t}function u(e,t,n,i,o){n=c(t,n,i),k.isBuffer(n)&&(i="buffer");var s=t.objectMode?1:n.length;t.length+=s;var a=t.length<t.highWaterMark;return a||(t.needDrain=!0),t.writing||t.corked?t.buffer.push(new r(n,i,o)):l(e,t,!1,s,n,i,o),a}function l(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function h(e,n,r,i,o){r?t.nextTick(function(){n.pendingcb--,o(i)}):(n.pendingcb--,o(i)),e._writableState.errorEmitted=!0,e.emit("error",i)}function f(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function p(e,n){var r=e._writableState,i=r.sync,o=r.writecb;if(f(r),n)h(e,r,i,n,o);else{var s=g(e,r);s||r.corked||r.bufferProcessing||!r.buffer.length||m(e,r),i?t.nextTick(function(){d(e,r,s,o)}):d(e,r,s,o)}}function d(e,t,n,r){n||v(e,t),t.pendingcb--,r(),_(e,t)}function v(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function m(e,t){if(t.bufferProcessing=!0,e._writev&&t.buffer.length>1){for(var n=[],r=0;r<t.buffer.length;r++)n.push(t.buffer[r].callback);t.pendingcb++,l(e,t,!0,t.length,t.buffer,"",function(e){for(var r=0;r<n.length;r++)t.pendingcb--,n[r](e)}),t.buffer=[]}else{for(var r=0;r<t.buffer.length;r++){var i=t.buffer[r],o=i.chunk,s=i.encoding,a=i.callback,c=t.objectMode?1:o.length;if(l(e,t,!1,c,o,s,a),t.writing){r++;break}}r<t.buffer.length?t.buffer=t.buffer.slice(r):t.buffer.length=0}t.bufferProcessing=!1}function g(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function y(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function _(e,t){var n=g(e,t);return n&&(0===t.pendingcb?(y(e,t),t.finished=!0,e.emit("finish")):y(e,t)),n}function b(e,n,r){n.ending=!0,_(e,n),r&&(n.finished?t.nextTick(r):e.once("finish",r)),n.ended=!0}e.exports=o;var w=n(49).Buffer;o.WritableState=i;var k=n(176);k.inherits=n(109);var x=n(72);k.inherits(o,x),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(e,t,n){var r=this._writableState,i=!1;return k.isFunction(t)&&(n=t,t=null),k.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),k.isFunction(n)||(n=function(){}),r.ended?s(this,r,n):a(this,r,e,n)&&(r.pendingcb++,i=u(this,r,e,t,n)),i},o.prototype.cork=function(){var e=this._writableState;e.corked++},o.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.buffer.length||m(this,e))},o.prototype._write=function(e,t,n){n(new Error("not implemented"))},o.prototype._writev=null,o.prototype.end=function(e,t,n){var r=this._writableState;k.isFunction(e)?(n=e,e=null,t=null):k.isFunction(t)&&(n=t,t=null),k.isNullOrUndefined(e)||this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||b(this,r,n)}}).call(t,n(78))},function(e,t,n){(function(t){function r(e){return this instanceof r?(c.call(this,e),u.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(e)}function i(){this.allowHalfOpen||this._writableState.ended||t.nextTick(this.end.bind(this))}function o(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n],n)}e.exports=r;var s=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},a=n(176);a.inherits=n(109);var c=n(153),u=n(154);a.inherits(r,c),o(s(u.prototype),function(e){r.prototype[e]||(r.prototype[e]=u.prototype[e])})}).call(t,n(78))},function(e,t,n){function r(e,t){this.afterTransform=function(e,n){return i(t,e,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function i(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,c.isNullOrUndefined(n)||e.push(n),i&&i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);a.call(this,e),this._transformState=new r(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){c.isFunction(this._flush)?this._flush(function(e){s(t,e)}):s(t)})}function s(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=e._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}e.exports=o;var a=n(155),c=n(176);c.inherits=n(109),c.inherits(o,a),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,a.prototype.push.call(this,e,t)},o.prototype._transform=function(){throw new Error("not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(){var e=this._transformState;c.isNull(e.writechunk)||!e.writecb||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))}},function(e,t,n){function r(e){return this instanceof r?void i.call(this,e):new r(e)}e.exports=r;var i=n(156),o=n(176);o.inherits=n(109),o.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},function(e){var t=function(){"use strict";return void 0===this}();if(t)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,keys:Object.keys,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:t};else{var n={}.hasOwnProperty,r={}.toString,i={}.constructor.prototype,o=function(e){var t=[];for(var r in e)n.call(e,r)&&t.push(r);return t},s=function(e,t,n){return e[t]=n.value,e},a=function(e){return e},c=function(e){try{return Object(e).constructor.prototype}catch(t){return i}},u=function(e){try{return"[object Array]"===r.call(e)}catch(t){return!1}};e.exports={isArray:u,keys:o,defineProperty:s,freeze:a,getPrototypeOf:c,isES5:t}}},function(e,t,n){(function(t){"use strict";var r,i=n(118);if("undefined"!=typeof t&&null!==t&&"function"==typeof t.cwd&&"function"==typeof t.nextTick&&"string"==typeof t.version)r=function(e){t.nextTick(e)};else if("function"!=typeof i.MutationObserver&&"function"!=typeof i.WebkitMutationObserver&&"function"!=typeof i.WebKitMutationObserver||"undefined"==typeof document||"function"!=typeof document.createElement)if("function"==typeof i.postMessage&&"function"!=typeof i.importScripts&&"function"==typeof i.addEventListener&&"function"==typeof i.removeEventListener){var o="bluebird_message_key_"+Math.random();r=function(){function e(e){if(e.source===i&&e.data===o){var n=t;t=void 0,n()}}var t=void 0;return i.addEventListener("message",e,!1),function(e){t=e,i.postMessage(o,"*")}}()}else r="function"==typeof i.MessageChannel?function(){var e=void 0,t=new i.MessageChannel;return t.port1.onmessage=function(){var t=e;e=void 0,t()},function(n){e=n,t.port2.postMessage(null)}}():i.setTimeout?function(e){setTimeout(e,4)}:function(e){e()};else r=function(){var e=i.MutationObserver||i.WebkitMutationObserver||i.WebKitMutationObserver,t=document.createElement("div"),n=void 0,r=new e(function(){var e=n;n=void 0,e()});return r.observe(t,{attributes:!0}),function(e){n=e,t.setAttribute("class","foo")}}();e.exports=r}).call(t,n(78))},function(e){"use strict";function t(e,t,n,r,i){for(var o=0;i>o;++o)n[o+r]=e[o+t]}function n(e){return e>>>=0,e-=1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e+1}function r(e){return"number"!=typeof e?16:n(Math.min(Math.max(16,e),1073741824))}function i(e){this._capacity=r(e),this._length=0,this._front=0,this._makeCapacity()}i.prototype._willBeOverCapacity=function(e){return this._capacity<e},i.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1);var n=this._front+t&this._capacity-1;this[n]=e,this._length=t+1},i.prototype.push=function(e,t,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=e,this[i+1&o]=t,this[i+2&o]=n,this._length=r},i.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},i.prototype.length=function(){return this._length},i.prototype._makeCapacity=function(){for(var e=this._capacity,t=0;e>t;++t)this[t]=void 0},i.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<3)},i.prototype._resizeTo=function(e){var n=this._front,r=this._capacity,i=new Array(r),o=this.length();if(t(this,0,i,0,r),this._capacity=e,this._makeCapacity(),this._front=0,r>=n+o)t(i,n,this,0,o);else{var s=o-(n+o&r-1);t(i,n,this,0,s),t(i,0,this,s,o-s)}},e.exports=i},function(e,t,n){"use strict";e.exports=function(e){function t(e,t){this.constructor$(e,t),this._howMany=0,this._unwrap=!1,this._initialized=!1}var r=n(119),i=n(121).RangeError,o=r.inherits,s=r.isArray;return o(t,e),t.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-2);var e=s(this._values);if(this._holes=e?this._values.length-this.length():0,!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()){var t="(Promise.some) input array contains less than "+this._howMany+" promises";this._reject(new i(t))}}},t.prototype.init=function(){this._initialized=!0,this._init()},t.prototype.setUnwrap=function(){this._unwrap=!0},t.prototype.howMany=function(){return this._howMany},t.prototype.setHowMany=function(e){this._isResolved()||(this._howMany=e)},t.prototype._promiseFulfilled=function(e){this._isResolved()||(this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),this._resolve(1===this.howMany()&&this._unwrap?this._values[0]:this._values)))},t.prototype._promiseRejected=function(e){this._isResolved()||(this._addRejected(e),this.howMany()>this._canPossiblyFulfill()&&this._reject(this._values.length===this.length()?[]:this._values.slice(this.length()+this._holes)))},t.prototype._fulfilled=function(){return this._totalResolved},t.prototype._rejected=function(){return this._values.length-this.length()-this._holes},t.prototype._addRejected=function(e){this._values.push(e)},t.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},t.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},t}},function(e,t,n){"use strict";e.exports=function(e,t){function r(t){for(var n=h,i=u,o=e,s=n.length,a=0;s>a;++a){var c=l(n[a],void 0,t);if(c===i)return o.reject(i.e);var f=o._cast(c,r,void 0);if(f instanceof o)return f}return null}function i(n,r){var i=this._promise=new e(t);i._setTrace(void 0),this._generatorFunction=n,this._receiver=r,this._generator=void 0}var o=n(121),s=o.TypeError,a=n(119),c=a.isArray,u=a.errorObj,l=a.tryCatch1,h=[];return i.prototype.promise=function(){return this._promise},i.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},i.prototype._continue=function f(t){if(t===u){this._generator=void 0;var n=o.canAttach(t.e)?t.e:new Error(t.e+"");return this._promise._attachExtraTrace(n),void this._promise._reject(t.e,n)}var i=t.value;if(t.done===!0)this._generator=void 0,this._promise._tryFollow(i)||this._promise._fulfill(i);else{var a=e._cast(i,f,void 0);if(!(a instanceof e)&&(a=c(a)?e.all(a):r(a),null===a))return void this._throw(new s("A value was yielded that could not be treated as a promise"));a._then(this._next,this._throw,void 0,this,null)}},i.prototype._throw=function(e){o.canAttach(e)&&this._promise._attachExtraTrace(e),this._continue(l(this._generator["throw"],this._generator,e))},i.prototype._next=function(e){this._continue(l(this._generator.next,this._generator,e))},i.addYieldHandler=function(e){if("function"!=typeof e)throw new s("fn must be a function");h.push(e)},i}},function(e,t,n){"use strict";e.exports=function(e,t){function r(e,t){for(var n=s.keys(e),r=new Array(n.length),i=0,o=r.length;o>i;++i)r[i]=e[n[i]];if(this.constructor$(r,t),!this._isResolved())for(var i=0,o=n.length;o>i;++i)r.push(n[i])}var i=n(119),o=i.inherits,s=n(158);return o(r,t),r.prototype._init=function(){this._init$(void 0,-3)},r.prototype._promiseFulfilled=function(e,t){if(!this._isResolved()){this._values[t]=e;var n=++this._totalResolved;if(n>=this._length){for(var r={},i=this.length(),o=0,s=this.length();s>o;++o)r[this._values[o+i]]=this._values[o];this._resolve(r)}}},r.prototype._promiseProgressed=function(e,t){this._isResolved()||this._promise._progress({key:this._values[t+this.length()],value:e})},t.PropertiesPromiseArray=r,r}},function(e,t,n){"use strict";e.exports=function(e,t){function r(e,t){this.constructor$(e,t)}var i=e.PromiseInspection,o=n(119),s=o.inherits;return s(r,t),r.prototype._promiseResolved=function(e,t){this._values[e]=t;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)},r.prototype._promiseFulfilled=function(e,t){if(!this._isResolved()){var n=new i;n._bitField=268435456,n._settledValue=e,this._promiseResolved(t,n)}},r.prototype._promiseRejected=function(e,t){if(!this._isResolved()){var n=new i;n._bitField=134217728,n._settledValue=e,this._promiseResolved(t,n)}},r}},function(e,t){"use strict";function n(e,t){return 2!==arguments.length?r[e]:void(r[e]=t)}var r={instrument:!1};t.config=r,t.configure=n},function(e,t){"use strict";function n(e){return r(e)||"object"==typeof e&&null!==e}function r(e){return"function"==typeof e}function i(e){return"[object Array]"===Object.prototype.toString.call(e)}var o=Date.now||function(){return(new Date).getTime()};t.objectOrFunction=n,t.isFunction=r,t.isArray=i,t.now=o},function(e,t,n){"use strict";function r(e){var t=this;if(!i(e))throw new TypeError("You must pass an array to all.");return new t(function(t,n){function r(e){return function(t){i(e,t)}}function i(e,n){a[e]=n,0===--c&&t(a)}var s,a=[],c=e.length;0===c&&t([]);for(var u=0;u<e.length;u++)s=e[u],s&&o(s.then)?s.then(r(u),n):i(u,s)})}var i=n(166).isArray,o=n(166).isFunction;t.all=r},function(e,t,n){"use strict";function r(e){var t=this;if(!i(e))throw new TypeError("You must pass an array to race.");return new t(function(t,n){for(var r,i=0;i<e.length;i++)r=e[i],r&&"function"==typeof r.then?r.then(t,n):t(r)})}var i=n(166).isArray;t.race=r},function(e,t){"use strict";function n(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=this;return new t(function(t){t(e)})}t.resolve=n},function(e,t){"use strict";function n(e){var t=this;return new t(function(t,n){n(e)})}t.reject=n},function(e,t,n){(function(e,n){"use strict";function r(){return function(){n.nextTick(s)}}function i(){var e=0,t=new l(s),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function o(){return function(){h.setTimeout(s,1)}}function s(){for(var e=0;e<f.length;e++){var t=f[e],n=t[0],r=t[1];n(r)}f=[]}function a(e,t){var n=f.push([e,t]);1===n&&c()}var c,u="undefined"!=typeof window?window:{},l=u.MutationObserver||u.WebKitMutationObserver,h="undefined"!=typeof e?e:void 0===this?window:this,f=[];c="undefined"!=typeof n&&"[object process]"==={}.toString.call(n)?r():l?i():o(),t.asap=a}).call(t,function(){return this}(),n(78))},function(){},function(e,t,n){(function(t){"use strict";function r(e){e=e||{},e.keepAlive=e.keepAlive!==!1,e.keepAliveMsecs=e.keepAliveMsecs||e.maxKeepAliveTime,u.call(this,e);var t=this;t.maxKeepAliveRequests=parseInt(e.maxKeepAliveRequests,10)||0,t.createSocketCount=0,t.timeoutSocketCount=0,t.requestFinishedCount=0,t.removeAllListeners("free"),t.on("free",function(e,n){t.requestFinishedCount++,e._requestCount++;var r=t.getName(n);if(o("agent.on(free)",r),!t.isDestroyed(e)&&t.requests[r]&&t.requests[r].length)t.requests[r].shift().onSocket(e),0===t.requests[r].length&&delete t.requests[r];else{var i=e._httpMessage;if(i&&i.shouldKeepAlive&&!t.isDestroyed(e)&&t.options.keepAlive){var s=t.freeSockets[r],a=s?s.length:0,c=a;t.sockets[r]&&(c+=t.sockets[r].length),c>=t.maxSockets||a>=t.maxFreeSockets?(t.removeSocket(e,n),e.destroy()):(s=s||[],t.freeSockets[r]=s,e.setKeepAlive(!0,t.keepAliveMsecs),e.unref&&e.unref(),e._httpMessage=null,t.removeSocket(e,n),s.push(e),t.keepAliveMsecs&&e._events&&Array.isArray(e._events.timeout)&&(e.removeAllListeners("timeout"),e.setTimeout(t.keepAliveMsecs,e._maxKeepAliveTimeout)))}else t.removeSocket(e,n),e.destroy()}})}function i(e){r.call(this,e),this.defaultPort=443,this.protocol="https:"}var o,s=n(29),a=n(47),c=n(77);o=t.env.NODE_DEBUG&&/agentkeepalive/.test(t.env.NODE_DEBUG)?function(){console.error.apply(console,arguments)}:function(){};var u=s.Agent;(0===t.version.indexOf("v0.8.")||0===t.version.indexOf("v0.10."))&&(u=n(177).Agent,o("%s use _http_agent",t.version)),c.inherits(r,u),e.exports=r,r.prototype.createSocket=function(e,t){var n=this,r=u.prototype.createSocket.call(this,e,t);return r._requestCount=0,n.keepAliveMsecs&&(r._maxKeepAliveTimeout=function(){o("maxKeepAliveTimeout, socket destroy()"),r.destroy(),n.timeoutSocketCount++},r.setTimeout(n.keepAliveMsecs,r._maxKeepAliveTimeout),r.setNoDelay(!0)),this.createSocketCount++,r},r.prototype.removeSocket=function(e,t){u.prototype.removeSocket.call(this,e,t);var n=this.getName(t);if(o("removeSocket",n,"destroyed:",this.isDestroyed(e)),this.isDestroyed(e)&&this.freeSockets[n]){var r=this.freeSockets[n].indexOf(e);-1!==r&&(this.freeSockets[n].splice(r,1),0===this.freeSockets[n].length&&delete this.freeSockets[n])}},c.inherits(i,r),i.prototype.createConnection=a.globalAgent.createConnection,i.prototype.getName=function(e){var t=r.prototype.getName.call(this,e);return t+=":",e.ca&&(t+=e.ca),t+=":",e.cert&&(t+=e.cert),t+=":",e.ciphers&&(t+=e.ciphers),t+=":",e.key&&(t+=e.key),t+=":",e.pfx&&(t+=e.pfx),t+=":",void 0!==e.rejectUnauthorized&&(t+=e.rejectUnauthorized),t},r.HttpsAgent=i}).call(t,n(78))},function(e){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){function r(e){if(e&&!c(e))throw new Error("Unknown encoding: "+e)}function i(e){return e.toString(this.encoding)}function o(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function s(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var a=n(49).Buffer,c=a.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},u=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),r(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=i)}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};u.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";e=e.slice(n,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);
var r=t.charCodeAt(t.length-1);if(!(r>=55296&&56319>=r)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,r=t.charCodeAt(i);if(r>=55296&&56319>=r){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,i)}return t},u.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(2>=t&&n>>4==14){this.charLength=3;break}if(3>=t&&n>>3==30){this.charLength=4;break}}this.charReceived=t},u.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t}},function(e,t,n){(function(e){function n(e){return Array.isArray(e)}function r(e){return"boolean"==typeof e}function i(e){return null===e}function o(e){return null==e}function s(e){return"number"==typeof e}function a(e){return"string"==typeof e}function c(e){return"symbol"==typeof e}function u(e){return void 0===e}function l(e){return h(e)&&"[object RegExp]"===g(e)}function h(e){return"object"==typeof e&&null!==e}function f(e){return h(e)&&"[object Date]"===g(e)}function p(e){return h(e)&&("[object Error]"===g(e)||e instanceof Error)}function d(e){return"function"==typeof e}function v(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function m(t){return e.isBuffer(t)}function g(e){return Object.prototype.toString.call(e)}t.isArray=n,t.isBoolean=r,t.isNull=i,t.isNullOrUndefined=o,t.isNumber=s,t.isString=a,t.isSymbol=c,t.isUndefined=u,t.isRegExp=l,t.isObject=h,t.isDate=f,t.isError=p,t.isFunction=d,t.isPrimitive=v,t.isBuffer=m}).call(t,n(49).Buffer)},function(e,t,n){(function(e){function r(e){if(!(this instanceof r))return new r(e);c.call(this);var t=this;t.defaultPort=80,t.protocol="http:",t.options=a._extend({},e),t.options.path=null,t.requests={},t.sockets={},t.freeSockets={},t.keepAliveMsecs=t.options.keepAliveMsecs||1e3,t.keepAlive=t.options.keepAlive||!1,t.maxSockets=t.options.maxSockets||r.defaultMaxSockets,t.maxFreeSockets=t.options.maxFreeSockets||256,t.on("free",function(e,n){var r=t.getName(n);if(i("agent.on(free)",r),!t.isDestroyed(e)&&t.requests[r]&&t.requests[r].length)t.requests[r].shift().onSocket(e),0===t.requests[r].length&&delete t.requests[r];else{var o=e._httpMessage;if(o&&o.shouldKeepAlive&&!t.isDestroyed(e)&&t.options.keepAlive){var s=t.freeSockets[r],a=s?s.length:0,c=a;t.sockets[r]&&(c+=t.sockets[r].length),c>=t.maxSockets||a>=t.maxFreeSockets?(t.removeSocket(e,n),e.destroy()):(s=s||[],t.freeSockets[r]=s,e.setKeepAlive(!0,t.keepAliveMsecs),e.unref&&e.unref(),e._httpMessage=null,t.removeSocket(e,n),s.push(e))}else t.removeSocket(e,n),e.destroy()}})}var i,o=n(!function(){var e=new Error('Cannot find module "net"');throw e.code="MODULE_NOT_FOUND",e}()),s=n(30),a=n(77),c=n(45).EventEmitter,u=n(29).ClientRequest;i=e.env.NODE_DEBUG&&/agentkeepalive/.test(e.env.NODE_DEBUG)?function(){console.error.apply(console,arguments)}:function(){},a.inherits(r,c),t.Agent=r,r.defaultMaxSockets=1/0,r.prototype.createConnection=o.createConnection,r.prototype.getName=function(e){var t="";return t+=e.host?e.host:"localhost",t+=":",e.port&&(t+=e.port),t+=":",e.localAddress&&(t+=e.localAddress),t+=":"},r.prototype.addRequest=function(e,t){"string"==typeof t&&(t={host:t,port:arguments[2],path:arguments[3]});var n=this.getName(t);this.sockets[n]||(this.sockets[n]=[]);var r=this.freeSockets[n]?this.freeSockets[n].length:0,o=r+this.sockets[n].length;if(r){var s=this.freeSockets[n].shift();i("have free socket"),this.freeSockets[n].length||delete this.freeSockets[n],s.ref&&s.ref(),e.onSocket(s),this.sockets[n].push(s)}else o<this.maxSockets?(i("call onSocket",o,r),e.onSocket(this.createSocket(e,t))):(i("wait for socket"),this.requests[n]||(this.requests[n]=[]),this.requests[n].push(e))},r.prototype.createSocket=function(e,t){function n(){s.emit("free",l,t)}function r(){i("CLIENT socket onClose"),s.removeSocket(l,t)}function o(){i("CLIENT socket onRemove"),s.removeSocket(l,t,"agentRemove"),l.removeListener("close",r),l.removeListener("free",n),l.removeListener("agentRemove",o)}var s=this;if(t=a._extend({},t),t=a._extend(t,s.options),t.servername=t.host,e){var c=e.getHeader("host");c&&(t.servername=c.replace(/:.*$/,""))}var u=s.getName(t);i("createConnection",u,t);var l=s.createConnection(t);return s.sockets[u]||(s.sockets[u]=[]),this.sockets[u].push(l),i("sockets",u,this.sockets[u].length),l.on("free",n),l.on("close",r),l.on("agentRemove",o),l},r.prototype.removeSocket=function(e,t){var n=this.getName(t);i("removeSocket",n,"destroyed:",this.isDestroyed(e));var r=[this.sockets];if(this.isDestroyed(e)&&r.push(this.freeSockets),r.forEach(function(t){if(t[n]){var r=t[n].indexOf(e);-1!==r&&(t[n].splice(r,1),0===t[n].length&&delete t[n])}}),this.requests[n]&&this.requests[n].length){i("removeSocket, have a request, make a socket");var o=this.requests[n][0];this.createSocket(o,t).emit("free")}},r.prototype.destroy=function(){var e=[this.freeSockets,this.sockets];e.forEach(function(e){Object.keys(e).forEach(function(t){e[t].forEach(function(e){e.destroy()})})})},r.prototype.request=function(e,t){if("string"==typeof e&&(e=s.parse(e)),e.hostname&&(e.host=e.hostname),e&&e.path&&/ /.test(e.path))throw new TypeError("Request path contains unescaped characters.");if(e.protocol&&e.protocol!==this.protocol)throw new Error("Protocol:"+e.protocol+" not supported.");return e=a._extend({agent:this,keepAlive:this.keepAlive},e),e.agent===!1&&(e.agent=new this.constructor),i("agent.request",e),new u(e,t)},r.prototype.get=function(e,t){var n=this.request(e,t);return n.end(),n},r.prototype.isDestroyed=function(e){return e.destroyed||e._destroyed},t.globalAgent=new r}).call(t,n(78))}])});
//# sourceMappingURL=eve.map